<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Lawmar PMS - Syst√®me de Gestion H√¥teli√®re</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- DataTables -->
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <!-- FullCalendar -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <!-- FullCalendar -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0d6efd;
            --primary-dark: #0b5ed7;
            --secondary: #6c757d;
            --success: #198754;
            --info: #0dcaf0;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
            --sidebar-width: 260px;
            --sidebar-width-mobile: 0px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Accessibilit√© - Focus visible */
        :focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* Skip link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px;
            z-index: 10000;
            text-decoration: none;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 1rem;
        }

        .login-container {
            max-width: 400px;
            width: 100%;
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            margin: 1rem;
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 1rem;
            object-fit: cover;
            border: 3px solid var(--primary);
        }

        .login-header h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .login-header p {
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .input-group {
            position: relative;
        }

        .input-group i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            z-index: 10;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.8rem;
            border: 2px solid #dee2e6;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(13,110,253,0.25);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            width: 100%;
            justify-content: center;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.875rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            display: none;
        }

        .alert-danger {
            background: #f8d7da;
            color: #842029;
            border: 1px solid #f5c2c7;
        }

        .alert-success {
            background: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }

        .spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .demo-credentials {
            margin-top: 2rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }

        .demo-credentials p {
            margin: 0.5rem 0;
            color: var(--secondary);
        }

        .demo-credentials strong {
            color: var(--primary);
        }

        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
            position: relative;
        }

        /* Menu toggle pour mobile */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1001;
            background: var(--primary);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .menu-toggle i {
            font-size: 1.5rem;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
        }

        .sidebar-header {
            padding: 1.5rem 1rem;
            border-bottom: 1px solid #dee2e6;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .sidebar-logo-img {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            object-fit: cover;
        }

        .sidebar-logo-text h2 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
            line-height: 1.2;
        }

        .sidebar-logo-text p {
            font-size: 0.7rem;
            color: var(--secondary);
            margin: 0;
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .menu-section {
            margin-bottom: 1.5rem;
        }

        .menu-title {
            padding: 0 1rem;
            margin-bottom: 0.5rem;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--secondary);
            font-weight: 600;
        }

        .menu-item {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--secondary);
            transition: var(--transition);
            cursor: pointer;
            margin: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            border: none;
            background: none;
            width: calc(100% - 1rem);
            text-align: left;
            font-size: 0.95rem;
        }

        .menu-item i {
            width: 20px;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .menu-item:hover {
            background: #e7f1ff;
            color: var(--primary);
        }

        .menu-item.active {
            background: var(--primary);
            color: white;
        }

        .menu-item.active i {
            color: white;
        }

        .menu-item .badge {
            margin-left: auto;
            background: var(--warning);
            color: var(--dark);
            font-size: 0.65rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
        }

        /* Main Content */
        .main {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 1.5rem;
            transition: var(--transition);
        }

        /* Top Bar */
        .top-bar {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        .date-display {
            background: #e7f1ff;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-role {
            background: #f8f9fa;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }

        .user-avatar:hover {
            background: var(--danger);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.primary {
            background: #e7f1ff;
            color: var(--primary);
        }

        .stat-icon.success {
            background: #d1e7dd;
            color: var(--success);
        }

        .stat-icon.warning {
            background: #fff3cd;
            color: #856404;
        }

        .stat-icon.danger {
            background: #f8d7da;
            color: var(--danger);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            line-height: 1.2;
        }

        .stat-label {
            color: var(--secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            margin-top: 0.75rem;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .chart-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .chart-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        /* Room Grid */
        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .room-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            border-left: 4px solid;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            width: 100%;
            text-align: left;
        }

        .room-card.available { border-left-color: var(--success); }
        .room-card.occupied { border-left-color: var(--primary); }
        .room-card.reserved { border-left-color: var(--warning); }
        .room-card.maintenance { border-left-color: var(--danger); }

        .room-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .room-number {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .room-type {
            font-size: 0.8rem;
            color: var(--secondary);
        }

        .room-price {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }

        /* Tables */
        .table-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .table-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .table th {
            text-align: left;
            padding: 0.75rem;
            background: #f8f9fa;
            color: var(--secondary);
            font-weight: 600;
            font-size: 0.85rem;
        }

        .table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            color: var(--dark);
        }

        /* Badges */
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }

        .badge-success {
            background: #d1e7dd;
            color: var(--success);
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-danger {
            background: #f8d7da;
            color: var(--danger);
        }

        .badge-info {
            background: #cff4fc;
            color: #055160;
        }

        /* Kitchen Orders */
        .kitchen-orders {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }

        .kitchen-card {
            background: #f8f9fa;
            border-radius: 0.75rem;
            padding: 1rem;
            border-left: 4px solid var(--warning);
        }

        .kitchen-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .table-number {
            font-weight: 700;
            color: var(--primary);
        }

        .timer {
            font-size: 0.75rem;
            color: var(--secondary);
        }

        .kitchen-items {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0;
        }

        .kitchen-items li {
            font-size: 0.8rem;
            padding: 0.25rem 0;
            border-bottom: 1px dashed #dee2e6;
        }

        /* Notifications */
        .notification-center {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 9999;
            max-width: 350px;
            width: calc(100% - 2rem);
        }

        .notification {
            background: white;
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            margin-bottom: 0.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            border-left: 4px solid;
            animation: slideIn 0.3s ease;
            word-break: break-word;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Invoice Preview */
        .invoice-preview {
            background: white;
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
            font-family: 'Inter', sans-serif;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1.5rem;
            border-bottom: 2px dashed #dee2e6;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .invoice-logo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
        }

        .invoice-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .invoice-details {
            margin-bottom: 1.5rem;
        }

        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }

        .invoice-table th {
            background: #e7f1ff;
            color: var(--primary);
            padding: 0.75rem;
            text-align: left;
        }

        .invoice-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
        }

        .invoice-total {
            text-align: right;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-top: 1rem;
        }

        /* Modal */
        .modal-content {
            border-radius: 1rem;
            border: none;
        }

        .modal-header {
            background: var(--primary);
            color: white;
            border-radius: 1rem 1rem 0 0;
            padding: 1.5rem;
        }

        .modal-header .btn-close {
            filter: brightness(0) invert(1);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #dee2e6;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }

            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main {
                margin-left: 0;
                padding: 1rem;
                padding-top: 5rem;
            }

            .top-bar {
                flex-direction: column;
                align-items: flex-start;
                padding: 1rem;
            }

            .user-profile {
                width: 100%;
                justify-content: space-between;
            }

            .page-title {
                font-size: 1.2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .room-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .table-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .table-header .btn {
                width: 100%;
            }

            .modal-dialog {
                margin: 0.5rem;
            }

            .invoice-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .invoice-title {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .room-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .btn-sm {
                padding: 0.3rem 0.6rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Aller au contenu principal</a>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="login-page">
        <div class="login-container" role="main" aria-labelledby="login-title">
            <div class="login-header">
                <img src="images/logo1.png" alt="Lawmar Logo" class="login-logo" onerror="this.src='https://via.placeholder.com/100x100/0d6efd/ffffff?text=LAW'">
                <h1 id="login-title">Lawmar PMS</h1>
                <p>Les R√©sidences du Lawmar - Gandiol üá∏üá≥</p>
            </div>

            <div id="loginAlert" class="alert alert-danger" role="alert" aria-live="polite">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span id="alertMessage"></span>
            </div>

            <form id="loginForm" class="login-form" aria-label="Formulaire de connexion">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user me-2" aria-hidden="true"></i>
                        Nom d'utilisateur
                    </label>
                    <div class="input-group">
                        <i class="fas fa-user" aria-hidden="true"></i>
                        <input type="text" class="form-control" id="username" placeholder="Entrez votre nom d'utilisateur" required autofocus aria-required="true">
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock me-2" aria-hidden="true"></i>
                        Mot de passe
                    </label>
                    <div class="input-group">
                        <i class="fas fa-lock" aria-hidden="true"></i>
                        <input type="password" class="form-control" id="password" placeholder="Entrez votre mot de passe" required aria-required="true">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary" id="loginBtn">
                    <span class="spinner" style="display: none;" aria-hidden="true"></span>
                    <span class="btn-text">Se connecter</span>
                </button>
            </form>

            <div class="demo-credentials" aria-label="Comptes de d√©monstration">
                <p><i class="fas fa-info-circle me-2" style="color: var(--primary);"></i><strong>Comptes de d√©monstration :</strong></p>
                <p>üëë <strong>admin</strong> / <strong>admin123</strong> (Manager)</p>
                <p>üè® <strong>reception</strong> / <strong>reception123</strong> (R√©ception)</p>
                <p>üçΩÔ∏è <strong>restaurant</strong> / <strong>restaurant123</strong> (Restaurant)</p>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard" role="application" aria-label="Tableau de bord">
        <!-- Menu Toggle pour mobile -->
        <button class="menu-toggle" id="menuToggle" onclick="toggleSidebar()" aria-label="Ouvrir le menu">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" aria-label="Menu principal">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo" onclick="loadModule('dashboard'); return false;">
                    <img src="images/logo1.png" alt="Lawmar" class="sidebar-logo-img" onerror="this.src='https://via.placeholder.com/45x45/0d6efd/ffffff?text=LAW'">
                    <div class="sidebar-logo-text">
                        <h2>LAWMAR PMS</h2>
                        <p>Les R√©sidences du Lawmar</p>
                    </div>
                </a>
            </div>

            <nav class="sidebar-menu" aria-label="Navigation">
                <div class="menu-section">
                    <div class="menu-title">PRINCIPAL</div>
                    <button class="menu-item active" onclick="loadModule('dashboard')" data-module="dashboard" aria-current="page">
                        <i class="fas fa-chart-pie" aria-hidden="true"></i>
                        <span>Dashboard</span>
                        <span class="badge" id="dashboard-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('calendar')" data-module="calendar">
                        <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                        <span>Calendrier</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('bookings')" data-module="bookings">
                        <i class="fas fa-hotel" aria-hidden="true"></i>
                        <span>R√©servations</span>
                        <span class="badge" id="bookings-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('orders')" data-module="orders">
                        <i class="fas fa-utensils" aria-hidden="true"></i>
                        <span>Commandes</span>
                        <span class="badge" id="orders-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('rooms')" data-module="rooms">
                        <i class="fas fa-door-open" aria-hidden="true"></i>
                        <span>Chambres</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">GESTION</div>
                    <button class="menu-item" onclick="loadModule('guests')" data-module="guests">
                        <i class="fas fa-users" aria-hidden="true"></i>
                        <span>Clients</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('stock')" data-module="stock">
                        <i class="fas fa-boxes" aria-hidden="true"></i>
                        <span>Stocks</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('staff')" data-module="staff">
                        <i class="fas fa-users-cog" aria-hidden="true"></i>
                        <span>Personnel</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">FINANCES</div>
                    <button class="menu-item" onclick="loadModule('invoices')" data-module="invoices">
                        <i class="fas fa-file-invoice" aria-hidden="true"></i>
                        <span>Factures</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('reports')" data-module="reports">
                        <i class="fas fa-chart-line" aria-hidden="true"></i>
                        <span>Rapports</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('expenses')" data-module="expenses">
                        <i class="fas fa-coins" aria-hidden="true"></i>
                        <span>D√©penses</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main" id="main-content">
            <!-- Top Bar -->
            <header class="top-bar" role="banner">
                <h1 class="page-title" id="page-title">Tableau de bord</h1>

                <div class="date-display" aria-live="polite">
                    <i class="fas fa-calendar-day" aria-hidden="true"></i>
                    <span id="current-date"></span>
                </div>

                <div class="user-profile">
                    <div class="user-role" id="user-role">
                        <i class="fas fa-user-tie" aria-hidden="true"></i>
                        <span id="userRoleDisplay">Manager</span>
                    </div>
                    <button class="user-avatar" onclick="logout()" title="D√©connexion" aria-label="Se d√©connecter">
                        <span id="userInitials">AD</span>
                    </button>
                </div>
            </header>

            <!-- Dynamic Content -->
            <div id="dashboard-content" role="region" aria-label="Contenu du tableau de bord">
                <!-- Le contenu est charg√© dynamiquement -->
            </div>
        </main>
    </div>

    <!-- Notification Center -->
    <div class="notification-center" id="notification-center" role="status" aria-live="polite"></div>

    <!-- Modals (conserv√©s identiques √† la version pr√©c√©dente) -->
    <!-- Reservation Modal -->
    <div class="modal fade" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reservationModalLabel">
                        <i class="fas fa-hotel me-2" aria-hidden="true"></i>
                        Nouvelle r√©servation
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="reservationForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestName" class="form-label">Nom du client</label>
                                <input type="text" class="form-control" id="guestName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="guestPhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="guestPhone" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="guestEmail">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomSelect" class="form-label">Chambre</label>
                                <select class="form-control" id="roomSelect" required>
                                    <option value="">S√©lectionner une chambre</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="checkinDate" class="form-label">Date d'arriv√©e</label>
                                <input type="date" class="form-control" id="checkinDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="checkoutDate" class="form-label">Date de d√©part</label>
                                <input type="date" class="form-control" id="checkoutDate" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="adults" class="form-label">Adultes</label>
                                <input type="number" class="form-control" id="adults" value="1" min="1">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="children" class="form-label">Enfants</label>
                                <input type="number" class="form-control" id="children" value="0" min="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="specialRequests" class="form-label">Pr√©f√©rences sp√©ciales</label>
                            <textarea class="form-control" id="specialRequests" rows="3"></textarea>
                        </div>
                        <div class="alert alert-info" role="status">
                            <strong>Total estim√©:</strong> <span id="estimatedTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="reservationForm" class="btn btn-primary">Confirmer la r√©servation</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderModalLabel">
                        <i class="fas fa-utensils me-2" aria-hidden="true"></i>
                        Nouvelle commande
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="orderForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="tableNumber" class="form-label">Num√©ro de table</label>
                                <input type="number" class="form-control" id="tableNumber" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="orderGuestName" class="form-label">Nom du client (optionnel)</label>
                                <input type="text" class="form-control" id="orderGuestName">
                            </div>
                        </div>

                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="chargeToRoom">
                                <label class="form-check-label" for="chargeToRoom">
                                    Imputer √† une chambre
                                </label>
                            </div>
                        </div>

                        <div class="mb-3" id="roomSelectionDiv" style="display: none;">
                            <label for="chargeRoomSelect" class="form-label">S√©lectionner la chambre</label>
                            <select class="form-control" id="chargeRoomSelect">
                                <option value="">Choisir une chambre</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Articles command√©s</label>
                            <div id="orderItems">
                                <div class="row mb-2 order-item">
                                    <div class="col-md-6">
                                        <select class="form-control item-select">
                                            <option value="">S√©lectionner un article</option>
                                            <option value="Thieboudienne" data-price="12500">Thieboudienne - 12 500 XOF</option>
                                            <option value="Yassa Poulet" data-price="11000">Yassa Poulet - 11 000 XOF</option>
                                            <option value="Maf√© d'agneau" data-price="12000">Maf√© d'agneau - 12 000 XOF</option>
                                            <option value="Poulet DG" data-price="13800">Poulet DG - 13 800 XOF</option>
                                            <option value="Pastels" data-price="8000">Pastels - 8 000 XOF</option>
                                            <option value="Filet de Capitaine" data-price="14500">Filet de Capitaine - 14 500 XOF</option>
                                            <option value="Jus de bissap" data-price="3500">Jus de bissap - 3 500 XOF</option>
                                            <option value="Jus de gingembre" data-price="3500">Jus de gingembre - 3 500 XOF</option>
                                            <option value="Jus de bouye" data-price="4000">Jus de bouye - 4 000 XOF</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="number" class="form-control item-qty" value="1" min="1">
                                    </div>
                                    <div class="col-md-2">
                                        <span class="item-price-display">12 500</span> XOF
                                    </div>
                                    <div class="col-md-1">
                                        <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                                            <i class="fas fa-times" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addOrderItem()">
                                <i class="fas fa-plus" aria-hidden="true"></i> Ajouter un article
                            </button>
                        </div>

                        <div class="alert alert-info" role="status">
                            <strong>Total commande:</strong> <span id="orderTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="orderForm" class="btn btn-primary">Valider la commande</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div class="modal fade" id="invoiceModal" tabindex="-1" aria-labelledby="invoiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invoiceModalLabel">
                        <i class="fas fa-file-invoice me-2" aria-hidden="true"></i>
                        Facture
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body" id="invoiceContent">
                    <!-- Le contenu de la facture est g√©n√©r√© dynamiquement -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                    <button type="button" class="btn btn-primary" onclick="downloadInvoicePDF()">
                        <i class="fas fa-download" aria-hidden="true"></i> T√©l√©charger PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Guest Modal -->
    <div class="modal fade" id="guestModal" tabindex="-1" aria-labelledby="guestModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="guestModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouveau client
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="guestForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestName" class="form-label">Nom complet</label>
                                <input type="text" class="form-control" id="newGuestName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="newGuestEmail" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="newGuestPhone" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPreferences" class="form-label">Pr√©f√©rences</label>
                                <input type="text" class="form-control" id="newGuestPreferences">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="guestForm" class="btn btn-primary">Ajouter client</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stock Modal -->
    <div class="modal fade" id="stockModal" tabindex="-1" aria-labelledby="stockModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="stockModalLabel">
                        <i class="fas fa-boxes me-2" aria-hidden="true"></i>
                        Nouvel article
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="stockForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockName" class="form-label">Nom de l'article</label>
                                <input type="text" class="form-control" id="stockName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockCategory" class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="stockCategory" required>
                                    <option value="√©picerie">√âpicerie</option>
                                    <option value="poissonnerie">Poissonnerie</option>
                                    <option value="viande">Viande</option>
                                    <option value="l√©gumes">L√©gumes</option>
                                    <option value="boissons">Boissons</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="stockQuantity" class="form-label">Quantit√©</label>
                                <input type="number" class="form-control" id="stockQuantity" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockUnit" class="form-label">Unit√©</label>
                                <select class="form-control" id="stockUnit" required>
                                    <option value="kg">kg</option>
                                    <option value="L">L</option>
                                    <option value="pi√®ce">pi√®ce</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockThreshold" class="form-label">Seuil d'alerte</label>
                                <input type="number" class="form-control" id="stockThreshold" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockExpiry" class="form-label">Date d'expiration</label>
                                <input type="date" class="form-control" id="stockExpiry">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockSupplier" class="form-label">Fournisseur</label>
                                <input type="text" class="form-control" id="stockSupplier" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="stockPrice" class="form-label">Prix unitaire (XOF)</label>
                            <input type="number" class="form-control" id="stockPrice" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="stockForm" class="btn btn-primary">Ajouter article</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Employee Modal -->
    <div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="employeeModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouvel employ√©
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="employeeForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeName" class="form-label">Nom complet</label>
                                <input type="text" class="form-control" id="employeeName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeRole" class="form-label">R√¥le</label>
                                <input type="text" class="form-control" id="employeeRole" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeDepartment" class="form-label">D√©partement</label>
                                <select class="form-control" id="employeeDepartment" required>
                                    <option value="restaurant">Restaurant</option>
                                    <option value="reception">R√©ception</option>
                                    <option value="direction">Direction</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeePhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="employeePhone" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="employeeEmail" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeSchedule" class="form-label">Planning</label>
                                <input type="text" class="form-control" id="employeeSchedule" placeholder="ex: Lun-Ven 8h-17h" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="employeeForm" class="btn btn-primary">Ajouter employ√©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Expense Modal -->
    <div class="modal fade" id="expenseModal" tabindex="-1" aria-labelledby="expenseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="expenseModalLabel">
                        <i class="fas fa-coins me-2" aria-hidden="true"></i>
                        Nouvelle d√©pense
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="expenseForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseDate" class="form-label">Date</label>
                                <input type="date" class="form-control" id="expenseDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseCategory" class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="expenseCategory" required>
                                    <option value="√©lectricit√©">√âlectricit√©</option>
                                    <option value="eau">Eau</option>
                                    <option value="achats">Achats</option>
                                    <option value="salaire">Salaire</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="expenseDescription" class="form-label">Description</label>
                            <input type="text" class="form-control" id="expenseDescription" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseAmount" class="form-label">Montant (XOF)</label>
                                <input type="number" class="form-control" id="expenseAmount" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseDueDate" class="form-label">Date d'√©ch√©ance</label>
                                <input type="date" class="form-control" id="expenseDueDate" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="expensePaid">
                                <label class="form-check-label" for="expensePaid">
                                    D√©j√† pay√©e
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="expenseForm" class="btn btn-primary">Ajouter d√©pense</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Room Modal -->
    <div class="modal fade" id="roomModal" tabindex="-1" aria-labelledby="roomModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="roomModalLabel">
                        <i class="fas fa-door-open me-2" aria-hidden="true"></i>
                        Nouvelle chambre
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="roomForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="roomNumber" class="form-label">Num√©ro de chambre</label>
                                <input type="number" class="form-control" id="roomNumber" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomType" class="form-label">Type</label>
                                <select class="form-control" id="roomType" required>
                                    <option value="Standard">Standard</option>
                                    <option value="Deluxe">Deluxe</option>
                                    <option value="Prestige">Prestige</option>
                                    <option value="Royale">Royale</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="roomPrice" class="form-label">Prix par nuit (XOF)</label>
                            <input type="number" class="form-control" id="roomPrice" required>
                        </div>
                        <div class="mb-3">
                            <label for="roomStatus" class="form-label">Statut initial</label>
                            <select class="form-control" id="roomStatus" required>
                                <option value="available">Disponible</option>
                                <option value="maintenance">Maintenance</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="roomForm" class="btn btn-primary">Ajouter chambre</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // DONN√âES DE L'APPLICATION
        // ============================================

        // Utilisateurs de d√©monstration
        const users = [
            { username: 'admin', password: 'admin123', role: 'manager', name: 'Admin' },
            { username: 'reception', password: 'reception123', role: 'reception', name: 'R√©ceptionniste' },
            { username: 'restaurant', password: 'restaurant123', role: 'restaurant', name: 'Restaurateur' }
        ];

        // Donn√©es de l'application (identiques √† la version pr√©c√©dente)
        let appData = {
            bookings: [
                { id: 'BK001', guest: 'Marie Diouf', room: 'Suite Prestige', roomNumber: 301, checkin: '2026-02-20', checkout: '2026-02-25', adults: 2, children: 1, status: 'confirmed', total: 750000, phone: '+221 77 123 45 67', email: 'marie.diouf@gmail.com', prepaid: 225000, specialRequests: 'Chambre calme' },
                { id: 'BK002', guest: 'Pierre Martin', room: 'Chambre Deluxe', roomNumber: 201, checkin: '2026-02-18', checkout: '2026-02-22', adults: 2, children: 0, status: 'checked-in', total: 380000, phone: '+221 78 234 56 78', email: 'pierre.martin@yahoo.fr', prepaid: 114000, specialRequests: '' },
                { id: 'BK003', guest: 'Aminata Ba', room: 'Chambre Standard', roomNumber: 102, checkin: '2026-02-15', checkout: '2026-02-19', adults: 1, children: 0, status: 'checked-out', total: 260000, phone: '+221 76 345 67 89', email: 'aminata.ba@gmail.com', prepaid: 78000, specialRequests: 'Vue piscine' },
                { id: 'BK004', guest: 'Jean Dupont', room: 'Suite Royale', roomNumber: 401, checkin: '2026-02-22', checkout: '2026-02-28', adults: 2, children: 2, status: 'confirmed', total: 2700000, phone: '+221 77 456 78 90', email: 'jean.dupont@orange.fr', prepaid: 540000, specialRequests: 'Lit b√©b√©' },
                { id: 'BK005', guest: 'Fatou Ndiaye', room: 'Chambre Deluxe', roomNumber: 202, checkin: '2026-02-19', checkout: '2026-02-23', adults: 2, children: 1, status: 'checked-in', total: 380000, phone: '+221 77 567 89 01', email: 'fatou.ndiaye@gmail.com', prepaid: 114000, specialRequests: '' },
                { id: 'BK006', guest: 'Omar Sy', room: 'Suite Prestige', roomNumber: 302, checkin: '2026-02-21', checkout: '2026-02-24', adults: 2, children: 0, status: 'confirmed', total: 450000, phone: '+221 77 678 90 12', email: 'omar.sy@icloud.com', prepaid: 135000, specialRequests: 'D√©jeuner inclus' },
                { id: 'BK007', guest: 'Sophie Diallo', room: 'Chambre Standard', roomNumber: 101, checkin: '2026-02-23', checkout: '2026-02-27', adults: 2, children: 1, status: 'pending', total: 260000, phone: '+221 78 789 01 23', email: 'sophie.diallo@gmail.com', prepaid: 0, specialRequests: '' }
            ],

            restaurantOrders: [
                { id: 'R001', table: 5, guest: 'Marie Diouf', items: [{ name: 'Thieboudienne', qty: 2, price: 12500 }, { name: 'Jus de bissap', qty: 2, price: 3500 }], total: 32000, status: 'paid', roomCharge: true, roomNumber: 301, roomId: 'BK001', time: '12:30', date: '2026-02-20' },
                { id: 'R002', table: 3, guest: 'Pierre Martin', items: [{ name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Pastels', qty: 1, price: 8000 }], total: 19000, status: 'pending', roomCharge: false, roomId: null, time: '19:15', date: '2026-02-20' },
                { id: 'R003', table: 2, guest: 'Aminata Ba', items: [{ name: 'Maf√© d\'agneau', qty: 1, price: 12000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 15500, status: 'preparing', roomCharge: false, roomId: null, time: '20:00', date: '2026-02-20' },
                { id: 'R004', table: 8, guest: 'Jean Dupont', items: [{ name: 'Filet de Capitaine', qty: 2, price: 14500 }, { name: 'Accra', qty: 1, price: 6500 }], total: 35500, status: 'paid', roomCharge: true, roomNumber: 401, roomId: 'BK004', time: '13:15', date: '2026-02-20' },
                { id: 'R005', table: 1, guest: 'Fatou Ndiaye', items: [{ name: 'Poulet DG', qty: 1, price: 13800 }, { name: 'Jus de bouye', qty: 1, price: 4000 }], total: 17800, status: 'preparing', roomCharge: false, roomId: null, time: '19:45', date: '2026-02-20' },
                { id: 'R006', table: 4, guest: 'Omar Sy', items: [{ name: 'Thieboudienne', qty: 1, price: 12500 }, { name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Bissap', qty: 2, price: 3500 }], total: 30500, status: 'paid', roomCharge: false, roomId: null, time: '20:30', date: '2026-02-20' },
                { id: 'R007', table: 6, guest: 'Sophie Diallo', items: [{ name: 'Pastels', qty: 2, price: 8000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 19500, status: 'pending', roomCharge: false, roomId: null, time: '12:45', date: '2026-02-20' }
            ],

            guests: [
                { id: 'G001', name: 'Marie Diouf', email: 'marie.diouf@gmail.com', phone: '+221 77 123 45 67', stays: 3, preferences: 'Chambre calme, oreillers fermes', totalSpent: 1850000, lastStay: '2026-02-20' },
                { id: 'G002', name: 'Pierre Martin', email: 'pierre.martin@yahoo.fr', phone: '+221 78 234 56 78', stays: 1, preferences: 'Petit-d√©jeuner continental', totalSpent: 380000, lastStay: '2026-02-18' },
                { id: 'G003', name: 'Aminata Ba', email: 'aminata.ba@gmail.com', phone: '+221 76 345 67 89', stays: 2, preferences: 'Chambre vue piscine', totalSpent: 520000, lastStay: '2026-02-15' },
                { id: 'G004', name: 'Jean Dupont', email: 'jean.dupont@orange.fr', phone: '+221 77 456 78 90', stays: 1, preferences: 'Suite avec jacuzzi', totalSpent: 2700000, lastStay: '2026-02-22' },
                { id: 'G005', name: 'Fatou Ndiaye', email: 'fatou.ndiaye@gmail.com', phone: '+221 77 567 89 01', stays: 1, preferences: 'Chambre proche piscine', totalSpent: 380000, lastStay: '2026-02-19' }
            ],

            stock: [
                { id: 'S001', name: 'Riz', category: '√©picerie', quantity: 25, unit: 'kg', threshold: 10, expiry: '2026-04-01', supplier: 'March√© Gandiol', price: 650 },
                { id: 'S002', name: 'Poisson frais', category: 'poissonnerie', quantity: 5, unit: 'kg', threshold: 8, expiry: '2026-02-22', supplier: 'P√™cheurs Tassin√®re', price: 2500 },
                { id: 'S003', name: 'Poulet', category: 'viande', quantity: 8, unit: 'kg', threshold: 5, expiry: '2026-02-25', supplier: 'Ferme de Gandiol', price: 1800 },
                { id: 'S004', name: 'Oignons', category: 'l√©gumes', quantity: 12, unit: 'kg', threshold: 5, expiry: '2026-02-28', supplier: 'March√© Gandiol', price: 500 },
                { id: 'S005', name: 'Huile', category: '√©picerie', quantity: 15, unit: 'L', threshold: 5, expiry: '2026-05-01', supplier: 'Saint-Louis', price: 1200 }
            ],

            employees: [
                { id: 'E001', name: 'Oumar Diallo', role: 'serveur', department: 'restaurant', phone: '+221 77 111 22 33', schedule: 'Lun-Ven 8h-17h', email: 'oumar.diallo@lawmar.sn' },
                { id: 'E002', name: 'Fatou Ndiaye', role: 'r√©ceptionniste', department: 'reception', phone: '+221 77 444 55 66', schedule: 'Mar-Sam 14h-22h', email: 'fatou.ndiaye@lawmar.sn' },
                { id: 'E003', name: 'Moussa Sow', role: 'cuisinier', department: 'restaurant', phone: '+221 77 777 88 99', schedule: 'Lun-Dim 10h-19h', email: 'moussa.sow@lawmar.sn' },
                { id: 'E004', name: 'Aminata Fall', role: 'manager', department: 'direction', phone: '+221 77 999 00 11', schedule: 'Lun-Ven 9h-18h', email: 'aminata.fall@lawmar.sn' }
            ],

            expenses: [
                { id: 'EX001', date: '2026-02-15', category: '√©lectricit√©', amount: 85000, description: 'Facture Senelec', paid: true, dueDate: '2026-02-28' },
                { id: 'EX002', date: '2026-02-10', category: 'achats', amount: 125000, description: 'Approvisionnement restaurant', paid: true, dueDate: '2026-02-20' },
                { id: 'EX003', date: '2026-02-18', category: 'eau', amount: 35000, description: 'Facture SDE', paid: false, dueDate: '2026-03-05' },
                { id: 'EX004', date: '2026-02-20', category: 'salaire', amount: 450000, description: 'Salaires f√©vrier', paid: true, dueDate: '2026-02-28' }
            ],

            rooms: [
                { number: 101, type: 'Standard', price: 65000, status: 'available' },
                { number: 102, type: 'Standard', price: 65000, status: 'occupied', guest: 'Aminata Ba' },
                { number: 201, type: 'Deluxe', price: 95000, status: 'occupied', guest: 'Pierre Martin' },
                { number: 202, type: 'Deluxe', price: 95000, status: 'available' },
                { number: 301, type: 'Prestige', price: 150000, status: 'occupied', guest: 'Marie Diouf' },
                { number: 302, type: 'Prestige', price: 150000, status: 'available' },
                { number: 401, type: 'Royale', price: 450000, status: 'reserved', guest: 'Jean Dupont' }
            ],

            get stats() {
                const today = new Date().toISOString().split('T')[0];
                const totalRooms = this.rooms.length;
                const occupiedRooms = this.rooms.filter(r => r.status === 'occupied' || r.status === 'reserved').length;
                const occupancyRate = Math.round((occupiedRooms / totalRooms) * 100);
                const checkinsToday = this.bookings.filter(b => b.checkin === today).length;
                const checkoutsToday = this.bookings.filter(b => b.checkout === today).length;
                const hotelRevenue = this.bookings.reduce((sum, b) => sum + b.total, 0);
                const restaurantRevenue = this.restaurantOrders.reduce((sum, o) => sum + o.total, 0);
                const pendingOrders = this.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
                const lowStock = this.stock.filter(s => s.quantity <= s.threshold).length;

                return {
                    occupancyRate,
                    occupiedRooms,
                    totalRooms,
                    checkinsToday,
                    checkoutsToday,
                    hotelRevenue,
                    restaurantRevenue,
                    pendingOrders,
                    lowStock
                };
            }
        };

        // ============================================
        // GESTION DE LA CONNEXION - RENFORC√âE
        // ============================================

        // V√©rifier l'authentification √† chaque chargement
        function checkAuth() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
            
            if (!isLoggedIn) {
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('dashboard').style.display = 'none';
                return false;
            } else {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'flex';
                return true;
            }
        }

        // Prot√©ger toutes les actions
        function protectAction(action) {
            return function(...args) {
                if (!checkAuth()) {
                    showNotification('Veuillez vous connecter', 'error');
                    return;
                }
                return action.apply(this, args);
            };
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            if (checkAuth()) {
                initializeApp();
            }
        });

        // Gestionnaire de connexion
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const alertDiv = document.getElementById('loginAlert');
            const alertMessage = document.getElementById('alertMessage');
            const spinner = loginBtn.querySelector('.spinner');
            const btnText = loginBtn.querySelector('.btn-text');
            const overlay = document.getElementById('loadingOverlay');

            loginBtn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = 'Connexion...';
            overlay.style.display = 'flex';

            setTimeout(() => {
                const user = users.find(u => u.username === username && u.password === password);

                if (user) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userRole', user.role);
                    sessionStorage.setItem('userName', user.name);
                    sessionStorage.setItem('username', user.username);

                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'flex';

                    initializeApp();
                    showNotification(`Bienvenue ${user.name} !`, 'success');
                } else {
                    loginBtn.disabled = false;
                    spinner.style.display = 'none';
                    btnText.textContent = 'Se connecter';

                    alertMessage.textContent = 'Nom d\'utilisateur ou mot de passe incorrect';
                    alertDiv.style.display = 'block';

                    setTimeout(() => {
                        alertDiv.style.display = 'none';
                    }, 5000);
                }
                
                overlay.style.display = 'none';
            }, 1000);
        });

        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                sessionStorage.clear();
                window.location.reload();
            }
        }

        // ============================================
        // FONCTIONS PRINCIPALES
        // ============================================

        let currentModule = 'dashboard';
        let charts = {};
        let currentInvoice = null;
        let invoiceCounter = 1;

        function initializeApp() {
            updateDate();
            updateUserInfo();
            updateBadges();
            loadDashboard();
            setupForms();
            initEventListeners();
        }

        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('fr-FR', options);
        }

        function updateUserInfo() {
            const userName = sessionStorage.getItem('userName') || 'Utilisateur';
            const userRole = sessionStorage.getItem('userRole') || 'r√©ception';

            const roleLabels = {
                manager: 'Manager',
                reception: 'R√©ception',
                restaurant: 'Restaurant'
            };
            
            document.getElementById('userRoleDisplay').textContent = roleLabels[userRole] || 'Utilisateur';
            document.getElementById('userInitials').textContent = userName.charAt(0).toUpperCase();
        }

        function updateBadges() {
            document.getElementById('dashboard-badge').textContent = appData.stats.pendingOrders;
            document.getElementById('bookings-badge').textContent = appData.bookings.filter(b => b.status === 'pending').length;
            document.getElementById('orders-badge').textContent = appData.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
        }

        function initEventListeners() {
            setInterval(() => {
                if (checkAuth()) {
                    refreshData();
                }
            }, 30000);

            document.getElementById('chargeToRoom')?.addEventListener('change', function(e) {
                document.getElementById('roomSelectionDiv').style.display = e.target.checked ? 'block' : 'none';
            });

            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('item-select') || e.target.classList.contains('item-qty')) {
                    calculateOrderTotal();
                }
            });

            document.getElementById('roomSelect')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkinDate')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkoutDate')?.addEventListener('change', calculateEstimatedTotal);
        }

        function refreshData() {
            showNotification('Donn√©es synchronis√©es', 'success');
            loadModule(currentModule);
            updateBadges();
        }

        function setupForms() {
            document.getElementById('reservationForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitReservation();
            });

            document.getElementById('orderForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitOrder();
            });

            document.getElementById('guestForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitGuest();
            });

            document.getElementById('stockForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitStock();
            });

            document.getElementById('employeeForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitEmployee();
            });

            document.getElementById('expenseForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitExpense();
            });

            document.getElementById('roomForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitRoom();
            });

            updateRoomSelectors();
        }

        function updateRoomSelectors() {
            const roomSelect = document.getElementById('roomSelect');
            const chargeRoomSelect = document.getElementById('chargeRoomSelect');

            if (roomSelect) {
                roomSelect.innerHTML = '<option value="">S√©lectionner une chambre</option>';
                appData.rooms.filter(r => r.status === 'available').forEach(room => {
                    roomSelect.innerHTML += `<option value="${room.number}" data-price="${room.price}">${room.number} - ${room.type} (${room.price.toLocaleString()} XOF/nuit)</option>`;
                });
            }

            if (chargeRoomSelect) {
                chargeRoomSelect.innerHTML = '<option value="">Choisir une chambre</option>';
                appData.rooms.filter(r => r.status === 'occupied').forEach(room => {
                    chargeRoomSelect.innerHTML += `<option value="${room.number}">${room.number} - ${room.type} (Occup√© par ${room.guest})</option>`;
                });
            }
        }

        function calculateEstimatedTotal() {
            const roomSelect = document.getElementById('roomSelect');
            const checkin = document.getElementById('checkinDate').value;
            const checkout = document.getElementById('checkoutDate').value;

            if (roomSelect.value && checkin && checkout) {
                const selectedOption = roomSelect.options[roomSelect.selectedIndex];
                const pricePerNight = parseInt(selectedOption.dataset.price);
                const nights = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
                const total = pricePerNight * nights;
                document.getElementById('estimatedTotal').textContent = total.toLocaleString();
            }
        }

        function loadModule(module) {
            if (!checkAuth()) return;

            // Fermer le menu sur mobile
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('show');
            }

            currentModule = module;

            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                item.removeAttribute('aria-current');
                if (item.dataset.module === module) {
                    item.classList.add('active');
                    item.setAttribute('aria-current', 'page');
                }
            });

            const titles = {
                dashboard: 'Tableau de bord',
                calendar: 'Calendrier des r√©servations',
                bookings: 'Gestion des r√©servations',
                orders: 'Commandes restaurant',
                rooms: 'Gestion des chambres',
                guests: 'Fiches clients',
                stock: 'Gestion des stocks',
                staff: 'Personnel',
                invoices: 'Facturation',
                reports: 'Rapports',
                expenses: 'D√©penses'
            };
            document.getElementById('page-title').textContent = titles[module] || 'Tableau de bord';

            loadModuleContent(module);
        }

        function loadModuleContent(module) {
            const content = document.getElementById('dashboard-content');

            if (module === 'dashboard') {
                content.innerHTML = renderDashboard();
                setTimeout(() => {
                    initCharts();
                }, 100);
            } else if (module === 'calendar') {
                content.innerHTML = renderCalendar();
                setTimeout(() => {
                    initCalendar();
                }, 100);
            } else if (module === 'bookings') {
                content.innerHTML = renderBookings();
                setTimeout(() => {
                    initDataTable('#bookings-table');
                }, 100);
            } else if (module === 'orders') {
                content.innerHTML = renderOrders();
                setTimeout(() => {
                    initDataTable('#orders-table');
                }, 100);
            } else if (module === 'rooms') {
                content.innerHTML = renderRooms();
            } else if (module === 'guests') {
                content.innerHTML = renderGuests();
            } else if (module === 'stock') {
                content.innerHTML = renderStock();
            } else if (module === 'staff') {
                content.innerHTML = renderStaff();
            } else if (module === 'invoices') {
                content.innerHTML = renderInvoices();
            } else if (module === 'reports') {
                content.innerHTML = renderReports();
                setTimeout(() => {
                    initReportsCharts();
                }, 100);
            } else if (module === 'expenses') {
                content.innerHTML = renderExpenses();
            }
        }

        // ============================================
        // FONCTIONS DE RENDU (simplifi√©es - identiques √† la version pr√©c√©dente)
        // ============================================

        function renderDashboard() {
            const stats = appData.stats;
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon primary">
                                <i class="fas fa-hotel" aria-hidden="true"></i>
                            </div>
                            <span class="badge badge-info">${stats.occupiedRooms}/${stats.totalRooms}</span>
                        </div>
                        <div class="stat-value">${stats.occupancyRate}%</div>
                        <div class="stat-label">Taux d'occupation</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +8%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted">Arriv√©es: ${stats.checkinsToday} | D√©parts: ${stats.checkoutsToday}</small>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon success">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(stats.hotelRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA H√¥tel (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +15%</span>
                            <span>ce mois</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon warning">
                                <i class="fas fa-utensils" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(stats.restaurantRevenue / 1000).toFixed(0)}k</div>
                        <div class="stat-label">CA Restaurant (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +5%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted">${stats.pendingOrders} commandes en cours</small>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon danger">
                                <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${stats.lowStock}</div>
                        <div class="stat-label">Alertes stock</div>
                        <small class="text-muted">Produits sous seuil</small>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar me-2" aria-hidden="true"></i>Occupation 7 derniers jours</h3>
                            <i class="fas fa-ellipsis-h" aria-hidden="true"></i>
                        </div>
                        <canvas id="occupancy-chart" style="height: 250px;" aria-label="Graphique d'occupation" role="img"></canvas>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie me-2" aria-hidden="true"></i>R√©partition des revenus</h3>
                            <i class="fas fa-ellipsis-h" aria-hidden="true"></i>
                        </div>
                        <canvas id="revenue-chart" style="height: 250px;" aria-label="Graphique des revenus" role="img"></canvas>
                    </div>
                </div>

                ${renderReceptionDashboard()}
            `;
        }

        function renderReceptionDashboard() {
            const today = new Date().toISOString().split('T')[0];
            const todayCheckins = appData.bookings.filter(b => b.checkin === today);
            const todayCheckouts = appData.bookings.filter(b => b.checkout === today);

            return `
                <div class="room-grid">
                    ${appData.rooms.filter(r => r.status === 'available').slice(0, 4).map(room => `
                        <button class="room-card available" onclick="quickReserve(${room.number})" aria-label="R√©server la chambre ${room.number}">
                            <div class="d-flex justify-content-between">
                                <span class="room-number">Ch. ${room.number}</span>
                                <span class="badge badge-success">Disponible</span>
                            </div>
                            <div class="room-type">${room.type}</div>
                            <div class="room-price">${room.price.toLocaleString()} XOF/nuit</div>
                        </button>
                    `).join('')}
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="table-card">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-in-alt me-2" style="color: #28a745;" aria-hidden="true"></i>Arriv√©es aujourd'hui</h3>
                                <span class="badge badge-success">${todayCheckins.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="Arriv√©es du jour">
                                    <thead>
                                        <tr>
                                            <th>Client</th>
                                            <th>Chambre</th>
                                            <th>Heure</th>
                                            <th>Statut</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckins.length ? todayCheckins.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong></td>
                                                <td>${b.room}</td>
                                                <td>14:00</td>
                                                <td><span class="badge badge-info">Attente</span></td>
                                                <td><button class="btn btn-success btn-sm" onclick="checkIn('${b.id}')" aria-label="Effectuer le check-in de ${b.guest}"><i class="fas fa-check" aria-hidden="true"></i></button></td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center">Aucune arriv√©e aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="table-card">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-out-alt me-2" style="color: #dc3545;" aria-hidden="true"></i>D√©parts aujourd'hui</h3>
                                <span class="badge badge-danger">${todayCheckouts.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="D√©parts du jour">
                                    <thead>
                                        <tr>
                                            <th>Client</th>
                                            <th>Chambre</th>
                                            <th>Heure</th>
                                            <th>Facture</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckouts.length ? todayCheckouts.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong></td>
                                                <td>${b.room}</td>
                                                <td>11:00</td>
                                                <td><button class="btn btn-info btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de ${b.guest}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button></td>
                                                <td><button class="btn btn-success btn-sm" onclick="checkOut('${b.id}')" aria-label="Effectuer le check-out de ${b.guest}"><i class="fas fa-check" aria-hidden="true"></i></button></td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center">Aucun d√©part aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-card mt-3">
                    <div class="table-header">
                        <h3><i class="fas fa-calendar-alt me-2" aria-hidden="true"></i>Prochaines r√©servations</h3>
                        <button class="btn btn-primary" onclick="openReservationModal()" aria-label="Nouvelle r√©servation">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle r√©servation
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="dashboard-bookings-table" aria-label="Liste des r√©servations">
                            <thead>
                                <tr>
                                    <th>N¬∞</th>
                                    <th>Client</th>
                                    <th>Chambre</th>
                                    <th>Arriv√©e</th>
                                    <th>D√©part</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.slice(0, 5).map(b => `
                                    <tr>
                                        <td><strong>${b.id}</strong></td>
                                        <td>${b.guest}<br><small>${b.phone}</small></td>
                                        <td>${b.room}</td>
                                        <td>${formatDate(b.checkin)}</td>
                                        <td>${formatDate(b.checkout)}</td>
                                        <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                        <td><span class="badge ${getStatusClass(b.status)}">${getStatusLabel(b.status)}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir les d√©tails de la r√©servation ${b.id}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de la r√©servation ${b.id}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // Les autres fonctions de rendu (renderBookings, renderOrders, etc.) restent identiques
        // Pour des raisons de concision, je ne les r√©p√®te pas ici
        // Elles sont disponibles dans la version pr√©c√©dente

        // ============================================
        // FONCTIONS DE GESTION (identiques √† la version pr√©c√©dente)
        // ============================================

        // Toutes les fonctions de soumission et d'action restent identiques
        // Pour des raisons de concision, je ne les r√©p√®te pas ici

        // ============================================
        // FONCTIONS UTILITAIRES
        // ============================================

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('fr-FR');
        }

        function getStatusLabel(status) {
            const labels = {
                'confirmed': 'Confirm√©e',
                'checked-in': 'En cours',
                'checked-out': 'Termin√©e',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function getStatusClass(status) {
            const classes = {
                'confirmed': 'badge-success',
                'checked-in': 'badge-info',
                'checked-out': 'badge-secondary',
                'pending': 'badge-warning'
            };
            return classes[status] || 'badge-info';
        }

        function getOrderStatusLabel(status) {
            const labels = {
                'paid': 'Pay√©e',
                'preparing': 'En pr√©paration',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function showNotification(message, type = 'success') {
            const container = document.getElementById('notification-center');
            const notification = document.createElement('div');
            notification.className = `notification`;
            notification.style.borderLeftColor = type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107';
            notification.setAttribute('role', 'alert');
            notification.setAttribute('aria-live', 'assertive');

            const icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'info' ? 'fa-info-circle' : 'fa-exclamation-triangle';

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas ${icon}" style="color: ${type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107'};" aria-hidden="true"></i>
                    <span>${message}</span>
                </div>
            `;

            container.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // ============================================
        // FONCTIONS MOBILE
        // ============================================

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('menuToggle');
            
            sidebar.classList.toggle('show');
            
            if (sidebar.classList.contains('show')) {
                toggleBtn.innerHTML = '<i class="fas fa-times" aria-hidden="true"></i>';
                toggleBtn.setAttribute('aria-label', 'Fermer le menu');
            } else {
                toggleBtn.innerHTML = '<i class="fas fa-bars" aria-hidden="true"></i>';
                toggleBtn.setAttribute('aria-label', 'Ouvrir le menu');
            }
        }

        // Fermer le menu quand on clique en dehors
        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('menuToggle');
            
            if (window.innerWidth <= 768 && 
                sidebar.classList.contains('show') && 
                !sidebar.contains(e.target) && 
                !toggleBtn.contains(e.target)) {
                toggleSidebar();
            }
        });

        // ============================================
        // INITIALISATION DES GRAPHIQUES
        // ============================================

        function initCharts() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            charts = {};

            if (document.getElementById('occupancy-chart')) {
                charts.occupancy = new Chart(document.getElementById('occupancy-chart'), {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
                        datasets: [{
                            label: 'Taux d\'occupation %',
                            data: [65, 70, 75, 80, 85, 90, 78],
                            borderColor: '#0d6efd',
                            backgroundColor: 'rgba(13, 110, 253, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }

            if (document.getElementById('revenue-chart')) {
                charts.revenue = new Chart(document.getElementById('revenue-chart'), {
                    type: 'doughnut',
                    data: {
                        labels: ['H√¥tel', 'Restaurant'],
                        datasets: [{
                            data: [appData.stats.hotelRevenue, appData.stats.restaurantRevenue],
                            backgroundColor: ['#0d6efd', '#ffc107'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (calendarEl) {
                const calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: window.innerWidth <= 768 ? 'timeGridDay' : 'dayGridMonth',
                    locale: 'fr',
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: window.innerWidth <= 768 ? 'dayGridMonth,timeGridDay' : 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    events: appData.bookings.map(b => ({
                        title: `${b.guest} - ${b.room}`,
                        start: b.checkin,
                        end: b.checkout,
                        color: '#0d6efd'
                    }))
                });
                calendar.render();
            }
        }

        function initDataTable(tableId) {
            if ($(tableId).length && $.fn.DataTable) {
                if ($(tableId).hasClass('dataTable')) {
                    $(tableId).DataTable().destroy();
                }

                $(tableId).DataTable({
                    language: {
                        url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json'
                    },
                    pageLength: window.innerWidth <= 768 ? 5 : 10,
                    responsive: true
                });
            }
        }

        function loadDashboard() {
            loadModule('dashboard');
        }

        // ============================================
        // EXPOSITION DES FONCTIONS GLOBALES
        // ============================================

        window.logout = logout;
        window.loadModule = loadModule;
        window.toggleSidebar = toggleSidebar;
        window.openReservationModal = openReservationModal;
        window.openOrderModal = openOrderModal;
        window.openRoomModal = openRoomModal;
        window.openGuestModal = openGuestModal;
        window.openStockModal = openStockModal;
        window.openEmployeeModal = openEmployeeModal;
        window.openExpenseModal = openExpenseModal;
        window.quickReserve = quickReserve;
        window.checkIn = checkIn;
        window.checkOut = checkOut;
        window.showInvoice = showInvoice;
        window.showOrderInvoice = showOrderInvoice;
        window.downloadInvoicePDF = downloadInvoicePDF;
        window.deleteBooking = deleteBooking;
        window.deleteOrder = deleteOrder;
        window.markOrderReady = markOrderReady;
        window.addOrderItem = addOrderItem;
        window.removeOrderItem = removeOrderItem;
        window.viewBooking = viewBooking;
        window.viewOrder = viewOrder;
        window.viewRoom = viewRoom;
        window.viewGuest = viewGuest;
        window.editStock = editStock;
        window.editEmployee = editEmployee;
        window.editExpense = editExpense;
        window.orderStock = orderStock;
        window.markAsPaid = markAsPaid;
        window.generateNewInvoice = generateNewInvoice;
        window.exportData = exportData;
        window.generateGuestInvoice = generateGuestInvoice;
    </script>
</body>
</html>