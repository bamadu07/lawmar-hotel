<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lawmar PMS - Syst√®me de Gestion H√¥teli√®re</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- DataTables -->
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <!-- FullCalendar -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <!-- FullCalendar -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0d6efd;
            --primary-dark: #0b5ed7;
            --secondary: #6c757d;
            --success: #198754;
            --info: #0dcaf0;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #212529;
            --sidebar-width: 260px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
        }

        /* Accessibilit√© - Focus visible */
        :focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }

        /* Skip link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px;
            z-index: 10000;
            text-decoration: none;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Login Page */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 1rem;
        }

        .login-container {
            max-width: 400px;
            width: 100%;
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-logo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 1rem;
            object-fit: cover;
            border: 3px solid var(--primary);
        }

        .login-header h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .login-header p {
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .input-group {
            position: relative;
        }

        .input-group i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            z-index: 10;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.8rem;
            border: 2px solid #dee2e6;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(13,110,253,0.25);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            width: 100%;
            justify-content: center;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.875rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            display: none;
        }

        .alert-danger {
            background: #f8d7da;
            color: #842029;
            border: 1px solid #f5c2c7;
        }

        .alert-success {
            background: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }

        .spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .demo-credentials {
            margin-top: 2rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 0.5rem;
            font-size: 0.9rem;
        }

        .demo-credentials p {
            margin: 0.5rem 0;
            color: var(--secondary);
        }

        .demo-credentials strong {
            color: var(--primary);
        }

        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
        }

        .sidebar-header {
            padding: 1.5rem 1rem;
            border-bottom: 1px solid #dee2e6;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .sidebar-logo-img {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            object-fit: cover;
        }

        .sidebar-logo-text h2 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
            line-height: 1.2;
        }

        .sidebar-logo-text p {
            font-size: 0.7rem;
            color: var(--secondary);
            margin: 0;
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .menu-section {
            margin-bottom: 1.5rem;
        }

        .menu-title {
            padding: 0 1rem;
            margin-bottom: 0.5rem;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--secondary);
            font-weight: 600;
        }

        .menu-item {
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--secondary);
            transition: var(--transition);
            cursor: pointer;
            margin: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            border: none;
            background: none;
            width: calc(100% - 1rem);
            text-align: left;
            font-size: 0.95rem;
        }

        .menu-item i {
            width: 20px;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .menu-item:hover {
            background: #e7f1ff;
            color: var(--primary);
        }

        .menu-item.active {
            background: var(--primary);
            color: white;
        }

        .menu-item.active i {
            color: white;
        }

        .menu-item .badge {
            margin-left: auto;
            background: var(--warning);
            color: var(--dark);
            font-size: 0.65rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
        }

        /* Main Content */
        .main {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 1.5rem;
        }

        /* Top Bar */
        .top-bar {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        .date-display {
            background: #e7f1ff;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-role {
            background: #f8f9fa;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }

        .user-avatar:hover {
            background: var(--danger);
        }

        /* Role Tabs */
        .role-tabs {
            background: white;
            border-radius: 2rem;
            padding: 0.25rem;
            display: inline-flex;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
        }

        .role-tab {
            padding: 0.5rem 1.5rem;
            border-radius: 2rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            color: var(--secondary);
            border: none;
            background: none;
        }

        .role-tab i {
            margin-right: 0.5rem;
        }

        .role-tab:hover {
            color: var(--primary);
        }

        .role-tab.active {
            background: var(--primary);
            color: white;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.primary {
            background: #e7f1ff;
            color: var(--primary);
        }

        .stat-icon.success {
            background: #d1e7dd;
            color: var(--success);
        }

        .stat-icon.warning {
            background: #fff3cd;
            color: #856404;
        }

        .stat-icon.danger {
            background: #f8d7da;
            color: var(--danger);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark);
            line-height: 1.2;
        }

        .stat-label {
            color: var(--secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            margin-top: 0.75rem;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .chart-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .chart-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        /* Room Grid */
        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .room-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            border-left: 4px solid;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            width: 100%;
            text-align: left;
        }

        .room-card.available { border-left-color: var(--success); }
        .room-card.occupied { border-left-color: var(--primary); }
        .room-card.reserved { border-left-color: var(--warning); }
        .room-card.maintenance { border-left-color: var(--danger); }

        .room-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .room-number {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .room-type {
            font-size: 0.8rem;
            color: var(--secondary);
        }

        .room-price {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }

        /* Tables */
        .table-card {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .table-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            text-align: left;
            padding: 0.75rem;
            background: #f8f9fa;
            color: var(--secondary);
            font-weight: 600;
            font-size: 0.85rem;
        }

        .table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            color: var(--dark);
        }

        /* Badges */
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }

        .badge-success {
            background: #d1e7dd;
            color: var(--success);
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-danger {
            background: #f8d7da;
            color: var(--danger);
        }

        .badge-info {
            background: #cff4fc;
            color: #055160;
        }

        /* Kitchen Orders */
        .kitchen-orders {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }

        .kitchen-card {
            background: #f8f9fa;
            border-radius: 0.75rem;
            padding: 1rem;
            border-left: 4px solid var(--warning);
        }

        .kitchen-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .table-number {
            font-weight: 700;
            color: var(--primary);
        }

        .timer {
            font-size: 0.75rem;
            color: var(--secondary);
        }

        .kitchen-items {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0;
        }

        .kitchen-items li {
            font-size: 0.8rem;
            padding: 0.25rem 0;
            border-bottom: 1px dashed #dee2e6;
        }

        /* Notifications */
        .notification-center {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 9999;
            max-width: 350px;
        }

        .notification {
            background: white;
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            margin-bottom: 0.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            border-left: 4px solid;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Invoice Preview */
        .invoice-preview {
            background: white;
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
            font-family: 'Inter', sans-serif;
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1.5rem;
            border-bottom: 2px dashed #dee2e6;
            margin-bottom: 1.5rem;
        }

        .invoice-logo {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
        }

        .invoice-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .invoice-details {
            margin-bottom: 1.5rem;
        }

        .invoice-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }

        .invoice-table th {
            background: #e7f1ff;
            color: var(--primary);
            padding: 0.75rem;
            text-align: left;
        }

        .invoice-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #dee2e6;
        }

        .invoice-total {
            text-align: right;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-top: 1rem;
        }

        /* Modal */
        .modal-content {
            border-radius: 1rem;
            border: none;
        }

        .modal-header {
            background: var(--primary);
            color: white;
            border-radius: 1rem 1rem 0 0;
            padding: 1.5rem;
        }

        .modal-header .btn-close {
            filter: brightness(0) invert(1);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #dee2e6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main {
                margin-left: 0;
            }

            .stats-grid,
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .role-tabs {
                flex-wrap: wrap;
                border-radius: 1rem;
            }

            .role-tab {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Aller au contenu principal</a>

    <!-- Login Page -->
    <div id="loginPage" class="login-page">
        <div class="login-container" role="main" aria-labelledby="login-title">
            <div class="login-header">
                <img src="images/logo1.png" alt="Lawmar Logo" class="login-logo" onerror="this.src='https://via.placeholder.com/100x100/0d6efd/ffffff?text=LAW'">
                <h1 id="login-title">Lawmar PMS</h1>
                <p>Les R√©sidences du Lawmar - Gandiol üá∏üá≥</p>
            </div>

            <div id="loginAlert" class="alert alert-danger" role="alert" aria-live="polite">
                <i class="fas fa-exclamation-circle me-2"></i>
                <span id="alertMessage"></span>
            </div>

            <form id="loginForm" class="login-form" aria-label="Formulaire de connexion">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user me-2" aria-hidden="true"></i>
                        Nom d'utilisateur
                    </label>
                    <div class="input-group">
                        <i class="fas fa-user" aria-hidden="true"></i>
                        <input type="text" class="form-control" id="username" placeholder="Entrez votre nom d'utilisateur" required autofocus aria-required="true">
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock me-2" aria-hidden="true"></i>
                        Mot de passe
                    </label>
                    <div class="input-group">
                        <i class="fas fa-lock" aria-hidden="true"></i>
                        <input type="password" class="form-control" id="password" placeholder="Entrez votre mot de passe" required aria-required="true">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary" id="loginBtn">
                    <span class="spinner" style="display: none;" aria-hidden="true"></span>
                    <span class="btn-text">Se connecter</span>
                </button>
            </form>

            <div class="demo-credentials" aria-label="Comptes de d√©monstration">
                <p><i class="fas fa-info-circle me-2" style="color: var(--primary);"></i><strong>Comptes de d√©monstration :</strong></p>
                <p>üëë <strong>admin</strong> / <strong>admin123</strong> (Manager)</p>
                <p>üè® <strong>reception</strong> / <strong>reception123</strong> (R√©ception)</p>
                <p>üçΩÔ∏è <strong>restaurant</strong> / <strong>restaurant123</strong> (Restaurant)</p>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard" role="application" aria-label="Tableau de bord">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" aria-label="Menu principal">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo" onclick="loadModule('dashboard'); return false;">
                    <img src="images/logo1.png" alt="Lawmar" class="sidebar-logo-img" onerror="this.src='https://via.placeholder.com/45x45/0d6efd/ffffff?text=LAW'">
                    <div class="sidebar-logo-text">
                        <h2>LAWMAR PMS</h2>
                        <p>Les R√©sidences du Lawmar</p>
                    </div>
                </a>
            </div>

            <nav class="sidebar-menu" aria-label="Navigation">
                <div class="menu-section">
                    <div class="menu-title">PRINCIPAL</div>
                    <button class="menu-item active" onclick="loadModule('dashboard')" data-module="dashboard" aria-current="page">
                        <i class="fas fa-chart-pie" aria-hidden="true"></i>
                        <span>Dashboard</span>
                        <span class="badge" id="dashboard-badge" aria-label="Notifications">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('calendar')" data-module="calendar">
                        <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                        <span>Calendrier</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('bookings')" data-module="bookings">
                        <i class="fas fa-hotel" aria-hidden="true"></i>
                        <span>R√©servations</span>
                        <span class="badge" id="bookings-badge" aria-label="Notifications">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('orders')" data-module="orders">
                        <i class="fas fa-utensils" aria-hidden="true"></i>
                        <span>Commandes</span>
                        <span class="badge" id="orders-badge" aria-label="Notifications">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('rooms')" data-module="rooms">
                        <i class="fas fa-door-open" aria-hidden="true"></i>
                        <span>Chambres</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">GESTION</div>
                    <button class="menu-item" onclick="loadModule('guests')" data-module="guests">
                        <i class="fas fa-users" aria-hidden="true"></i>
                        <span>Clients</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('stock')" data-module="stock">
                        <i class="fas fa-boxes" aria-hidden="true"></i>
                        <span>Stocks</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('staff')" data-module="staff">
                        <i class="fas fa-users-cog" aria-hidden="true"></i>
                        <span>Personnel</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">FINANCES</div>
                    <button class="menu-item" onclick="loadModule('invoices')" data-module="invoices">
                        <i class="fas fa-file-invoice" aria-hidden="true"></i>
                        <span>Factures</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('reports')" data-module="reports">
                        <i class="fas fa-chart-line" aria-hidden="true"></i>
                        <span>Rapports</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('expenses')" data-module="expenses">
                        <i class="fas fa-coins" aria-hidden="true"></i>
                        <span>D√©penses</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main" id="main-content">
            <!-- Top Bar -->
            <header class="top-bar" role="banner">
                <h1 class="page-title" id="page-title">Tableau de bord</h1>

                <div class="date-display" aria-live="polite">
                    <i class="fas fa-calendar-day" aria-hidden="true"></i>
                    <span id="current-date"></span>
                </div>

                <div class="user-profile">
                    <div class="user-role" id="user-role">
                        <i class="fas fa-user-tie" aria-hidden="true"></i>
                        <span id="userRoleDisplay">Manager</span>
                    </div>
                    <button class="user-avatar" onclick="logout()" title="D√©connexion" aria-label="Se d√©connecter">
                        <span id="userInitials">AD</span>
                    </button>
                </div>
            </header>

            <!-- Role Tabs -->
            <div class="role-tabs" role="tablist" aria-label="Filtres par r√¥le">
                <button class="role-tab active" onclick="switchRole('reception')" data-role="reception" role="tab" aria-selected="true" id="tab-reception">
                    <i class="fas fa-hotel" aria-hidden="true"></i> R√©ception
                </button>
                <button class="role-tab" onclick="switchRole('restaurant')" data-role="restaurant" role="tab" aria-selected="false" id="tab-restaurant">
                    <i class="fas fa-utensils" aria-hidden="true"></i> Restaurant
                </button>
                <button class="role-tab" onclick="switchRole('manager')" data-role="manager" role="tab" aria-selected="false" id="tab-manager">
                    <i class="fas fa-chart-line" aria-hidden="true"></i> Manager
                </button>
            </div>

            <!-- Dynamic Content -->
            <div id="dashboard-content" role="region" aria-label="Contenu du tableau de bord">
                <!-- Le contenu est charg√© dynamiquement -->
            </div>
        </main>
    </div>

    <!-- Notification Center -->
    <div class="notification-center" id="notification-center" role="status" aria-live="polite"></div>

    <!-- Reservation Modal -->
    <div class="modal fade" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reservationModalLabel">
                        <i class="fas fa-hotel me-2" aria-hidden="true"></i>
                        Nouvelle r√©servation
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="reservationForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestName" class="form-label">Nom du client</label>
                                <input type="text" class="form-control" id="guestName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="guestPhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="guestPhone" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="guestEmail">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomSelect" class="form-label">Chambre</label>
                                <select class="form-control" id="roomSelect" required>
                                    <option value="">S√©lectionner une chambre</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="checkinDate" class="form-label">Date d'arriv√©e</label>
                                <input type="date" class="form-control" id="checkinDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="checkoutDate" class="form-label">Date de d√©part</label>
                                <input type="date" class="form-control" id="checkoutDate" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="adults" class="form-label">Adultes</label>
                                <input type="number" class="form-control" id="adults" value="1" min="1">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="children" class="form-label">Enfants</label>
                                <input type="number" class="form-control" id="children" value="0" min="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="specialRequests" class="form-label">Pr√©f√©rences sp√©ciales</label>
                            <textarea class="form-control" id="specialRequests" rows="3"></textarea>
                        </div>
                        <div class="alert alert-info" role="status">
                            <strong>Total estim√©:</strong> <span id="estimatedTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="reservationForm" class="btn btn-primary">Confirmer la r√©servation</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderModalLabel">
                        <i class="fas fa-utensils me-2" aria-hidden="true"></i>
                        Nouvelle commande
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="orderForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="tableNumber" class="form-label">Num√©ro de table</label>
                                <input type="number" class="form-control" id="tableNumber" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="orderGuestName" class="form-label">Nom du client (optionnel)</label>
                                <input type="text" class="form-control" id="orderGuestName">
                            </div>
                        </div>

                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="chargeToRoom">
                                <label class="form-check-label" for="chargeToRoom">
                                    Imputer √† une chambre
                                </label>
                            </div>
                        </div>

                        <div class="mb-3" id="roomSelectionDiv" style="display: none;">
                            <label for="chargeRoomSelect" class="form-label">S√©lectionner la chambre</label>
                            <select class="form-control" id="chargeRoomSelect">
                                <option value="">Choisir une chambre</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Articles command√©s</label>
                            <div id="orderItems">
                                <div class="row mb-2 order-item">
                                    <div class="col-md-6">
                                        <select class="form-control item-select">
                                            <option value="">S√©lectionner un article</option>
                                            <option value="Thieboudienne" data-price="12500">Thieboudienne - 12 500 XOF</option>
                                            <option value="Yassa Poulet" data-price="11000">Yassa Poulet - 11 000 XOF</option>
                                            <option value="Maf√© d'agneau" data-price="12000">Maf√© d'agneau - 12 000 XOF</option>
                                            <option value="Poulet DG" data-price="13800">Poulet DG - 13 800 XOF</option>
                                            <option value="Pastels" data-price="8000">Pastels - 8 000 XOF</option>
                                            <option value="Filet de Capitaine" data-price="14500">Filet de Capitaine - 14 500 XOF</option>
                                            <option value="Jus de bissap" data-price="3500">Jus de bissap - 3 500 XOF</option>
                                            <option value="Jus de gingembre" data-price="3500">Jus de gingembre - 3 500 XOF</option>
                                            <option value="Jus de bouye" data-price="4000">Jus de bouye - 4 000 XOF</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="number" class="form-control item-qty" value="1" min="1">
                                    </div>
                                    <div class="col-md-2">
                                        <span class="item-price-display">12 500</span> XOF
                                    </div>
                                    <div class="col-md-1">
                                        <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                                            <i class="fas fa-times" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addOrderItem()">
                                <i class="fas fa-plus" aria-hidden="true"></i> Ajouter un article
                            </button>
                        </div>

                        <div class="alert alert-info" role="status">
                            <strong>Total commande:</strong> <span id="orderTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="orderForm" class="btn btn-primary">Valider la commande</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div class="modal fade" id="invoiceModal" tabindex="-1" aria-labelledby="invoiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invoiceModalLabel">
                        <i class="fas fa-file-invoice me-2" aria-hidden="true"></i>
                        Facture
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body" id="invoiceContent">
                    <!-- Le contenu de la facture est g√©n√©r√© dynamiquement -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                    <button type="button" class="btn btn-primary" onclick="downloadInvoicePDF()">
                        <i class="fas fa-download" aria-hidden="true"></i> T√©l√©charger PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Guest Modal -->
    <div class="modal fade" id="guestModal" tabindex="-1" aria-labelledby="guestModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="guestModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouveau client
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="guestForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestName" class="form-label">Nom complet</label>
                                <input type="text" class="form-control" id="newGuestName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="newGuestEmail" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="newGuestPhone" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPreferences" class="form-label">Pr√©f√©rences</label>
                                <input type="text" class="form-control" id="newGuestPreferences">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="guestForm" class="btn btn-primary">Ajouter client</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stock Modal -->
    <div class="modal fade" id="stockModal" tabindex="-1" aria-labelledby="stockModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="stockModalLabel">
                        <i class="fas fa-boxes me-2" aria-hidden="true"></i>
                        Nouvel article
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="stockForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockName" class="form-label">Nom de l'article</label>
                                <input type="text" class="form-control" id="stockName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockCategory" class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="stockCategory" required>
                                    <option value="√©picerie">√âpicerie</option>
                                    <option value="poissonnerie">Poissonnerie</option>
                                    <option value="viande">Viande</option>
                                    <option value="l√©gumes">L√©gumes</option>
                                    <option value="boissons">Boissons</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="stockQuantity" class="form-label">Quantit√©</label>
                                <input type="number" class="form-control" id="stockQuantity" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockUnit" class="form-label">Unit√©</label>
                                <select class="form-control" id="stockUnit" required>
                                    <option value="kg">kg</option>
                                    <option value="L">L</option>
                                    <option value="pi√®ce">pi√®ce</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockThreshold" class="form-label">Seuil d'alerte</label>
                                <input type="number" class="form-control" id="stockThreshold" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockExpiry" class="form-label">Date d'expiration</label>
                                <input type="date" class="form-control" id="stockExpiry">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockSupplier" class="form-label">Fournisseur</label>
                                <input type="text" class="form-control" id="stockSupplier" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="stockPrice" class="form-label">Prix unitaire (XOF)</label>
                            <input type="number" class="form-control" id="stockPrice" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="stockForm" class="btn btn-primary">Ajouter article</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Employee Modal -->
    <div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="employeeModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouvel employ√©
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="employeeForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeName" class="form-label">Nom complet</label>
                                <input type="text" class="form-control" id="employeeName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeRole" class="form-label">R√¥le</label>
                                <input type="text" class="form-control" id="employeeRole" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeDepartment" class="form-label">D√©partement</label>
                                <select class="form-control" id="employeeDepartment" required>
                                    <option value="restaurant">Restaurant</option>
                                    <option value="reception">R√©ception</option>
                                    <option value="direction">Direction</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeePhone" class="form-label">T√©l√©phone</label>
                                <input type="tel" class="form-control" id="employeePhone" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="employeeEmail" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeSchedule" class="form-label">Planning</label>
                                <input type="text" class="form-control" id="employeeSchedule" placeholder="ex: Lun-Ven 8h-17h" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="employeeForm" class="btn btn-primary">Ajouter employ√©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Expense Modal -->
    <div class="modal fade" id="expenseModal" tabindex="-1" aria-labelledby="expenseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="expenseModalLabel">
                        <i class="fas fa-coins me-2" aria-hidden="true"></i>
                        Nouvelle d√©pense
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="expenseForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseDate" class="form-label">Date</label>
                                <input type="date" class="form-control" id="expenseDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseCategory" class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="expenseCategory" required>
                                    <option value="√©lectricit√©">√âlectricit√©</option>
                                    <option value="eau">Eau</option>
                                    <option value="achats">Achats</option>
                                    <option value="salaire">Salaire</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="expenseDescription" class="form-label">Description</label>
                            <input type="text" class="form-control" id="expenseDescription" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseAmount" class="form-label">Montant (XOF)</label>
                                <input type="number" class="form-control" id="expenseAmount" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseDueDate" class="form-label">Date d'√©ch√©ance</label>
                                <input type="date" class="form-control" id="expenseDueDate" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="expensePaid">
                                <label class="form-check-label" for="expensePaid">
                                    D√©j√† pay√©e
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="expenseForm" class="btn btn-primary">Ajouter d√©pense</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Room Modal -->
    <div class="modal fade" id="roomModal" tabindex="-1" aria-labelledby="roomModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="roomModalLabel">
                        <i class="fas fa-door-open me-2" aria-hidden="true"></i>
                        Nouvelle chambre
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="roomForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="roomNumber" class="form-label">Num√©ro de chambre</label>
                                <input type="number" class="form-control" id="roomNumber" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomType" class="form-label">Type</label>
                                <select class="form-control" id="roomType" required>
                                    <option value="Standard">Standard</option>
                                    <option value="Deluxe">Deluxe</option>
                                    <option value="Prestige">Prestige</option>
                                    <option value="Royale">Royale</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="roomPrice" class="form-label">Prix par nuit (XOF)</label>
                            <input type="number" class="form-control" id="roomPrice" required>
                        </div>
                        <div class="mb-3">
                            <label for="roomStatus" class="form-label">Statut initial</label>
                            <select class="form-control" id="roomStatus" required>
                                <option value="available">Disponible</option>
                                <option value="maintenance">Maintenance</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="roomForm" class="btn btn-primary">Ajouter chambre</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // DONN√âES DE L'APPLICATION
        // ============================================

        // Utilisateurs de d√©monstration
        const users = [
            { username: 'admin', password: 'admin123', role: 'manager', name: 'Admin' },
            { username: 'reception', password: 'reception123', role: 'reception', name: 'R√©ceptionniste' },
            { username: 'restaurant', password: 'restaurant123', role: 'restaurant', name: 'Restaurateur' }
        ];

        // Donn√©es de l'application
        let appData = {
            bookings: [
                { id: 'BK001', guest: 'Marie Diouf', room: 'Suite Prestige', roomNumber: 301, checkin: '2026-02-20', checkout: '2026-02-25', adults: 2, children: 1, status: 'confirmed', total: 750000, phone: '+221 77 123 45 67', email: 'marie.diouf@gmail.com', prepaid: 225000, specialRequests: 'Chambre calme' },
                { id: 'BK002', guest: 'Pierre Martin', room: 'Chambre Deluxe', roomNumber: 201, checkin: '2026-02-18', checkout: '2026-02-22', adults: 2, children: 0, status: 'checked-in', total: 380000, phone: '+221 78 234 56 78', email: 'pierre.martin@yahoo.fr', prepaid: 114000, specialRequests: '' },
                { id: 'BK003', guest: 'Aminata Ba', room: 'Chambre Standard', roomNumber: 102, checkin: '2026-02-15', checkout: '2026-02-19', adults: 1, children: 0, status: 'checked-out', total: 260000, phone: '+221 76 345 67 89', email: 'aminata.ba@gmail.com', prepaid: 78000, specialRequests: 'Vue piscine' },
                { id: 'BK004', guest: 'Jean Dupont', room: 'Suite Royale', roomNumber: 401, checkin: '2026-02-22', checkout: '2026-02-28', adults: 2, children: 2, status: 'confirmed', total: 2700000, phone: '+221 77 456 78 90', email: 'jean.dupont@orange.fr', prepaid: 540000, specialRequests: 'Lit b√©b√©' },
                { id: 'BK005', guest: 'Fatou Ndiaye', room: 'Chambre Deluxe', roomNumber: 202, checkin: '2026-02-19', checkout: '2026-02-23', adults: 2, children: 1, status: 'checked-in', total: 380000, phone: '+221 77 567 89 01', email: 'fatou.ndiaye@gmail.com', prepaid: 114000, specialRequests: '' },
                { id: 'BK006', guest: 'Omar Sy', room: 'Suite Prestige', roomNumber: 302, checkin: '2026-02-21', checkout: '2026-02-24', adults: 2, children: 0, status: 'confirmed', total: 450000, phone: '+221 77 678 90 12', email: 'omar.sy@icloud.com', prepaid: 135000, specialRequests: 'D√©jeuner inclus' },
                { id: 'BK007', guest: 'Sophie Diallo', room: 'Chambre Standard', roomNumber: 101, checkin: '2026-02-23', checkout: '2026-02-27', adults: 2, children: 1, status: 'pending', total: 260000, phone: '+221 78 789 01 23', email: 'sophie.diallo@gmail.com', prepaid: 0, specialRequests: '' }
            ],

            restaurantOrders: [
                { id: 'R001', table: 5, guest: 'Marie Diouf', items: [{ name: 'Thieboudienne', qty: 2, price: 12500 }, { name: 'Jus de bissap', qty: 2, price: 3500 }], total: 32000, status: 'paid', roomCharge: true, roomNumber: 301, roomId: 'BK001', time: '12:30', date: '2026-02-20' },
                { id: 'R002', table: 3, guest: 'Pierre Martin', items: [{ name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Pastels', qty: 1, price: 8000 }], total: 19000, status: 'pending', roomCharge: false, roomId: null, time: '19:15', date: '2026-02-20' },
                { id: 'R003', table: 2, guest: 'Aminata Ba', items: [{ name: 'Maf√© d\'agneau', qty: 1, price: 12000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 15500, status: 'preparing', roomCharge: false, roomId: null, time: '20:00', date: '2026-02-20' },
                { id: 'R004', table: 8, guest: 'Jean Dupont', items: [{ name: 'Filet de Capitaine', qty: 2, price: 14500 }, { name: 'Accra', qty: 1, price: 6500 }], total: 35500, status: 'paid', roomCharge: true, roomNumber: 401, roomId: 'BK004', time: '13:15', date: '2026-02-20' },
                { id: 'R005', table: 1, guest: 'Fatou Ndiaye', items: [{ name: 'Poulet DG', qty: 1, price: 13800 }, { name: 'Jus de bouye', qty: 1, price: 4000 }], total: 17800, status: 'preparing', roomCharge: false, roomId: null, time: '19:45', date: '2026-02-20' },
                { id: 'R006', table: 4, guest: 'Omar Sy', items: [{ name: 'Thieboudienne', qty: 1, price: 12500 }, { name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Bissap', qty: 2, price: 3500 }], total: 30500, status: 'paid', roomCharge: false, roomId: null, time: '20:30', date: '2026-02-20' },
                { id: 'R007', table: 6, guest: 'Sophie Diallo', items: [{ name: 'Pastels', qty: 2, price: 8000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 19500, status: 'pending', roomCharge: false, roomId: null, time: '12:45', date: '2026-02-20' }
            ],

            guests: [
                { id: 'G001', name: 'Marie Diouf', email: 'marie.diouf@gmail.com', phone: '+221 77 123 45 67', stays: 3, preferences: 'Chambre calme, oreillers fermes', totalSpent: 1850000, lastStay: '2026-02-20' },
                { id: 'G002', name: 'Pierre Martin', email: 'pierre.martin@yahoo.fr', phone: '+221 78 234 56 78', stays: 1, preferences: 'Petit-d√©jeuner continental', totalSpent: 380000, lastStay: '2026-02-18' },
                { id: 'G003', name: 'Aminata Ba', email: 'aminata.ba@gmail.com', phone: '+221 76 345 67 89', stays: 2, preferences: 'Chambre vue piscine', totalSpent: 520000, lastStay: '2026-02-15' },
                { id: 'G004', name: 'Jean Dupont', email: 'jean.dupont@orange.fr', phone: '+221 77 456 78 90', stays: 1, preferences: 'Suite avec jacuzzi', totalSpent: 2700000, lastStay: '2026-02-22' },
                { id: 'G005', name: 'Fatou Ndiaye', email: 'fatou.ndiaye@gmail.com', phone: '+221 77 567 89 01', stays: 1, preferences: 'Chambre proche piscine', totalSpent: 380000, lastStay: '2026-02-19' }
            ],

            stock: [
                { id: 'S001', name: 'Riz', category: '√©picerie', quantity: 25, unit: 'kg', threshold: 10, expiry: '2026-04-01', supplier: 'March√© Gandiol', price: 650 },
                { id: 'S002', name: 'Poisson frais', category: 'poissonnerie', quantity: 5, unit: 'kg', threshold: 8, expiry: '2026-02-22', supplier: 'P√™cheurs Tassin√®re', price: 2500 },
                { id: 'S003', name: 'Poulet', category: 'viande', quantity: 8, unit: 'kg', threshold: 5, expiry: '2026-02-25', supplier: 'Ferme de Gandiol', price: 1800 },
                { id: 'S004', name: 'Oignons', category: 'l√©gumes', quantity: 12, unit: 'kg', threshold: 5, expiry: '2026-02-28', supplier: 'March√© Gandiol', price: 500 },
                { id: 'S005', name: 'Huile', category: '√©picerie', quantity: 15, unit: 'L', threshold: 5, expiry: '2026-05-01', supplier: 'Saint-Louis', price: 1200 }
            ],

            employees: [
                { id: 'E001', name: 'Oumar Diallo', role: 'serveur', department: 'restaurant', phone: '+221 77 111 22 33', schedule: 'Lun-Ven 8h-17h', email: 'oumar.diallo@lawmar.sn' },
                { id: 'E002', name: 'Fatou Ndiaye', role: 'r√©ceptionniste', department: 'reception', phone: '+221 77 444 55 66', schedule: 'Mar-Sam 14h-22h', email: 'fatou.ndiaye@lawmar.sn' },
                { id: 'E003', name: 'Moussa Sow', role: 'cuisinier', department: 'restaurant', phone: '+221 77 777 88 99', schedule: 'Lun-Dim 10h-19h', email: 'moussa.sow@lawmar.sn' },
                { id: 'E004', name: 'Aminata Fall', role: 'manager', department: 'direction', phone: '+221 77 999 00 11', schedule: 'Lun-Ven 9h-18h', email: 'aminata.fall@lawmar.sn' }
            ],

            expenses: [
                { id: 'EX001', date: '2026-02-15', category: '√©lectricit√©', amount: 85000, description: 'Facture Senelec', paid: true, dueDate: '2026-02-28' },
                { id: 'EX002', date: '2026-02-10', category: 'achats', amount: 125000, description: 'Approvisionnement restaurant', paid: true, dueDate: '2026-02-20' },
                { id: 'EX003', date: '2026-02-18', category: 'eau', amount: 35000, description: 'Facture SDE', paid: false, dueDate: '2026-03-05' },
                { id: 'EX004', date: '2026-02-20', category: 'salaire', amount: 450000, description: 'Salaires f√©vrier', paid: true, dueDate: '2026-02-28' }
            ],

            rooms: [
                { number: 101, type: 'Standard', price: 65000, status: 'available' },
                { number: 102, type: 'Standard', price: 65000, status: 'occupied', guest: 'Aminata Ba' },
                { number: 201, type: 'Deluxe', price: 95000, status: 'occupied', guest: 'Pierre Martin' },
                { number: 202, type: 'Deluxe', price: 95000, status: 'available' },
                { number: 301, type: 'Prestige', price: 150000, status: 'occupied', guest: 'Marie Diouf' },
                { number: 302, type: 'Prestige', price: 150000, status: 'available' },
                { number: 401, type: 'Royale', price: 450000, status: 'reserved', guest: 'Jean Dupont' }
            ],

            get stats() {
                const today = new Date().toISOString().split('T')[0];
                const totalRooms = this.rooms.length;
                const occupiedRooms = this.rooms.filter(r => r.status === 'occupied' || r.status === 'reserved').length;
                const occupancyRate = Math.round((occupiedRooms / totalRooms) * 100);
                const checkinsToday = this.bookings.filter(b => b.checkin === today).length;
                const checkoutsToday = this.bookings.filter(b => b.checkout === today).length;
                const hotelRevenue = this.bookings.reduce((sum, b) => sum + b.total, 0);
                const restaurantRevenue = this.restaurantOrders.reduce((sum, o) => sum + o.total, 0);
                const pendingOrders = this.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
                const lowStock = this.stock.filter(s => s.quantity <= s.threshold).length;

                return {
                    occupancyRate,
                    occupiedRooms,
                    totalRooms,
                    checkinsToday,
                    checkoutsToday,
                    hotelRevenue,
                    restaurantRevenue,
                    pendingOrders,
                    lowStock
                };
            }
        };

        // ============================================
        // GESTION DE LA CONNEXION
        // ============================================

        // V√©rifier l'authentification
        function checkAuth() {
            if (sessionStorage.getItem('isLoggedIn') !== 'true') {
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('dashboard').style.display = 'none';
                return false;
            } else {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'flex';
                return true;
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            if (checkAuth()) {
                initializeApp();
            }
        });

        // Gestionnaire de connexion
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const alertDiv = document.getElementById('loginAlert');
            const alertMessage = document.getElementById('alertMessage');
            const spinner = loginBtn.querySelector('.spinner');
            const btnText = loginBtn.querySelector('.btn-text');

            loginBtn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = 'Connexion...';

            setTimeout(() => {
                const user = users.find(u => u.username === username && u.password === password);

                if (user) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userRole', user.role);
                    sessionStorage.setItem('userName', user.name);
                    sessionStorage.setItem('username', user.username);

                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'flex';

                    initializeApp();
                    showNotification(`Bienvenue ${user.name} !`, 'success');
                } else {
                    loginBtn.disabled = false;
                    spinner.style.display = 'none';
                    btnText.textContent = 'Se connecter';

                    alertMessage.textContent = 'Nom d\'utilisateur ou mot de passe incorrect';
                    alertDiv.style.display = 'block';

                    setTimeout(() => {
                        alertDiv.style.display = 'none';
                    }, 5000);
                }
            }, 1000);
        });

        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                sessionStorage.clear();
                window.location.reload();
            }
        }

        // ============================================
        // FONCTIONS PRINCIPALES
        // ============================================

        let currentRole = sessionStorage.getItem('userRole') || 'reception';
        let currentModule = 'dashboard';
        let charts = {};
        let currentInvoice = null;
        let invoiceCounter = 1;

        function initializeApp() {
            updateDate();
            updateUserInfo();
            updateBadges();
            loadDashboard();
            setupForms();
            initEventListeners();
        }

        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('fr-FR', options);
        }

        function updateUserInfo() {
            const userName = sessionStorage.getItem('userName') || 'Utilisateur';
            const userRole = sessionStorage.getItem('userRole') || 'reception';

            document.getElementById('userRoleDisplay').textContent = 
                userRole === 'manager' ? 'Manager' : 
                userRole === 'reception' ? 'R√©ception' : 'Restaurant';
            document.getElementById('userInitials').textContent = userName.charAt(0).toUpperCase();
        }

        function updateBadges() {
            document.getElementById('dashboard-badge').textContent = appData.stats.pendingOrders;
            document.getElementById('bookings-badge').textContent = appData.bookings.filter(b => b.status === 'pending').length;
            document.getElementById('orders-badge').textContent = appData.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
        }

        function initEventListeners() {
            setInterval(() => {
                if (checkAuth()) {
                    refreshData();
                }
            }, 30000);

            document.getElementById('chargeToRoom')?.addEventListener('change', function(e) {
                document.getElementById('roomSelectionDiv').style.display = e.target.checked ? 'block' : 'none';
            });

            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('item-select') || e.target.classList.contains('item-qty')) {
                    calculateOrderTotal();
                }
            });

            document.getElementById('roomSelect')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkinDate')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkoutDate')?.addEventListener('change', calculateEstimatedTotal);
        }

        function refreshData() {
            showNotification('Donn√©es synchronis√©es', 'success');
            loadModule(currentModule);
            updateBadges();
        }

        function setupForms() {
            document.getElementById('reservationForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitReservation();
            });

            document.getElementById('orderForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitOrder();
            });

            document.getElementById('guestForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitGuest();
            });

            document.getElementById('stockForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitStock();
            });

            document.getElementById('employeeForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitEmployee();
            });

            document.getElementById('expenseForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitExpense();
            });

            document.getElementById('roomForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitRoom();
            });

            updateRoomSelectors();
        }

        function updateRoomSelectors() {
            const roomSelect = document.getElementById('roomSelect');
            const chargeRoomSelect = document.getElementById('chargeRoomSelect');

            if (roomSelect) {
                roomSelect.innerHTML = '<option value="">S√©lectionner une chambre</option>';
                appData.rooms.filter(r => r.status === 'available').forEach(room => {
                    roomSelect.innerHTML += `<option value="${room.number}" data-price="${room.price}">${room.number} - ${room.type} (${room.price.toLocaleString()} XOF/nuit)</option>`;
                });
            }

            if (chargeRoomSelect) {
                chargeRoomSelect.innerHTML = '<option value="">Choisir une chambre</option>';
                appData.rooms.filter(r => r.status === 'occupied').forEach(room => {
                    chargeRoomSelect.innerHTML += `<option value="${room.number}">${room.number} - ${room.type} (Occup√© par ${room.guest})</option>`;
                });
            }
        }

        function calculateEstimatedTotal() {
            const roomSelect = document.getElementById('roomSelect');
            const checkin = document.getElementById('checkinDate').value;
            const checkout = document.getElementById('checkoutDate').value;

            if (roomSelect.value && checkin && checkout) {
                const selectedOption = roomSelect.options[roomSelect.selectedIndex];
                const pricePerNight = parseInt(selectedOption.dataset.price);
                const nights = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
                const total = pricePerNight * nights;
                document.getElementById('estimatedTotal').textContent = total.toLocaleString();
            }
        }

        function switchRole(role) {
            if (!checkAuth()) return;

            currentRole = role;

            document.querySelectorAll('.role-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.setAttribute('aria-selected', 'false');
                if (tab.dataset.role === role) {
                    tab.classList.add('active');
                    tab.setAttribute('aria-selected', 'true');
                }
            });

            const roleLabels = {
                reception: 'R√©ception',
                restaurant: 'Restaurant',
                manager: 'Manager'
            };
            document.getElementById('userRoleDisplay').textContent = roleLabels[role];

            loadModule(currentModule);
            showNotification(`Mode ${roleLabels[role]} activ√©`, 'success');
        }

        function loadModule(module) {
            if (!checkAuth()) return;

            currentModule = module;

            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                item.removeAttribute('aria-current');
                if (item.dataset.module === module) {
                    item.classList.add('active');
                    item.setAttribute('aria-current', 'page');
                }
            });

            const titles = {
                dashboard: 'Tableau de bord',
                calendar: 'Calendrier des r√©servations',
                bookings: 'Gestion des r√©servations',
                orders: 'Commandes restaurant',
                rooms: 'Gestion des chambres',
                guests: 'Fiches clients',
                stock: 'Gestion des stocks',
                staff: 'Personnel',
                invoices: 'Facturation',
                reports: 'Rapports',
                expenses: 'D√©penses'
            };
            document.getElementById('page-title').textContent = titles[module] || 'Tableau de bord';

            loadModuleContent(module);
        }

        function loadModuleContent(module) {
            const content = document.getElementById('dashboard-content');

            if (module === 'dashboard') {
                content.innerHTML = renderDashboard();
                setTimeout(() => {
                    initCharts();
                }, 100);
            } else if (module === 'calendar') {
                content.innerHTML = renderCalendar();
                setTimeout(() => {
                    initCalendar();
                }, 100);
            } else if (module === 'bookings') {
                content.innerHTML = renderBookings();
                setTimeout(() => {
                    initDataTable('#bookings-table');
                }, 100);
            } else if (module === 'orders') {
                content.innerHTML = renderOrders();
                setTimeout(() => {
                    initDataTable('#orders-table');
                }, 100);
            } else if (module === 'rooms') {
                content.innerHTML = renderRooms();
            } else if (module === 'guests') {
                content.innerHTML = renderGuests();
            } else if (module === 'stock') {
                content.innerHTML = renderStock();
            } else if (module === 'staff') {
                content.innerHTML = renderStaff();
            } else if (module === 'invoices') {
                content.innerHTML = renderInvoices();
            } else if (module === 'reports') {
                content.innerHTML = renderReports();
                setTimeout(() => {
                    initReportsCharts();
                }, 100);
            } else if (module === 'expenses') {
                content.innerHTML = renderExpenses();
            }
        }

        // ============================================
        // FONCTIONS DE RENDU
        // ============================================

        function renderDashboard() {
            const stats = appData.stats;

            let roleSpecificContent = '';
            if (currentRole === 'reception') {
                roleSpecificContent = renderReceptionDashboard();
            } else if (currentRole === 'restaurant') {
                roleSpecificContent = renderRestaurantDashboard();
            } else {
                roleSpecificContent = renderManagerDashboard();
            }

            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon primary">
                                <i class="fas fa-hotel" aria-hidden="true"></i>
                            </div>
                            <span class="badge badge-info">${stats.occupiedRooms}/${stats.totalRooms}</span>
                        </div>
                        <div class="stat-value">${stats.occupancyRate}%</div>
                        <div class="stat-label">Taux d'occupation</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +8%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted">Arriv√©es: ${stats.checkinsToday} | D√©parts: ${stats.checkoutsToday}</small>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon success">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(stats.hotelRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA H√¥tel (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +15%</span>
                            <span>ce mois</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon warning">
                                <i class="fas fa-utensils" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(stats.restaurantRevenue / 1000).toFixed(0)}k</div>
                        <div class="stat-label">CA Restaurant (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up" aria-hidden="true"></i> +5%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted">${stats.pendingOrders} commandes en cours</small>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon danger">
                                <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${stats.lowStock}</div>
                        <div class="stat-label">Alertes stock</div>
                        <small class="text-muted">Produits sous seuil</small>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar me-2" aria-hidden="true"></i>Occupation 7 derniers jours</h3>
                            <i class="fas fa-ellipsis-h" aria-hidden="true"></i>
                        </div>
                        <canvas id="occupancy-chart" style="height: 250px;" aria-label="Graphique d'occupation" role="img"></canvas>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie me-2" aria-hidden="true"></i>R√©partition des revenus</h3>
                            <i class="fas fa-ellipsis-h" aria-hidden="true"></i>
                        </div>
                        <canvas id="revenue-chart" style="height: 250px;" aria-label="Graphique des revenus" role="img"></canvas>
                    </div>
                </div>

                ${roleSpecificContent}
            `;
        }

        function renderReceptionDashboard() {
            const today = new Date().toISOString().split('T')[0];
            const todayCheckins = appData.bookings.filter(b => b.checkin === today);
            const todayCheckouts = appData.bookings.filter(b => b.checkout === today);

            return `
                <div class="room-grid">
                    ${appData.rooms.filter(r => r.status === 'available').slice(0, 4).map(room => `
                        <button class="room-card available" onclick="quickReserve(${room.number})" aria-label="R√©server la chambre ${room.number}">
                            <div class="d-flex justify-content-between">
                                <span class="room-number">Ch. ${room.number}</span>
                                <span class="badge badge-success">Disponible</span>
                            </div>
                            <div class="room-type">${room.type}</div>
                            <div class="room-price">${room.price.toLocaleString()} XOF/nuit</div>
                        </button>
                    `).join('')}
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="table-card">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-in-alt me-2" style="color: #28a745;" aria-hidden="true"></i>Arriv√©es aujourd'hui</h3>
                                <span class="badge badge-success">${todayCheckins.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="Arriv√©es du jour">
                                    <thead>
                                        <tr>
                                            <th>Client</th>
                                            <th>Chambre</th>
                                            <th>Heure</th>
                                            <th>Statut</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckins.length ? todayCheckins.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong></td>
                                                <td>${b.room}</td>
                                                <td>14:00</td>
                                                <td><span class="badge badge-info">Attente</span></td>
                                                <td><button class="btn btn-success btn-sm" onclick="checkIn('${b.id}')" aria-label="Effectuer le check-in de ${b.guest}"><i class="fas fa-check" aria-hidden="true"></i></button></td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center">Aucune arriv√©e aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="table-card">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-out-alt me-2" style="color: #dc3545;" aria-hidden="true"></i>D√©parts aujourd'hui</h3>
                                <span class="badge badge-danger">${todayCheckouts.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="D√©parts du jour">
                                    <thead>
                                        <tr>
                                            <th>Client</th>
                                            <th>Chambre</th>
                                            <th>Heure</th>
                                            <th>Facture</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckouts.length ? todayCheckouts.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong></td>
                                                <td>${b.room}</td>
                                                <td>11:00</td>
                                                <td><button class="btn btn-info btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de ${b.guest}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button></td>
                                                <td><button class="btn btn-success btn-sm" onclick="checkOut('${b.id}')" aria-label="Effectuer le check-out de ${b.guest}"><i class="fas fa-check" aria-hidden="true"></i></button></td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center">Aucun d√©part aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-card mt-3">
                    <div class="table-header">
                        <h3><i class="fas fa-calendar-alt me-2" aria-hidden="true"></i>Prochaines r√©servations</h3>
                        <button class="btn btn-primary" onclick="openReservationModal()" aria-label="Nouvelle r√©servation">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle r√©servation
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="dashboard-bookings-table" aria-label="Liste des r√©servations">
                            <thead>
                                <tr>
                                    <th>N¬∞</th>
                                    <th>Client</th>
                                    <th>Chambre</th>
                                    <th>Arriv√©e</th>
                                    <th>D√©part</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.slice(0, 5).map(b => `
                                    <tr>
                                        <td><strong>${b.id}</strong></td>
                                        <td>${b.guest}<br><small>${b.phone}</small></td>
                                        <td>${b.room}</td>
                                        <td>${formatDate(b.checkin)}</td>
                                        <td>${formatDate(b.checkout)}</td>
                                        <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                        <td><span class="badge ${getStatusClass(b.status)}">${getStatusLabel(b.status)}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir les d√©tails de la r√©servation ${b.id}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de la r√©servation ${b.id}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderRestaurantDashboard() {
            const preparing = appData.restaurantOrders.filter(o => o.status === 'preparing');

            return `
                <div class="row">
                    <div class="col-md-8">
                        <div class="table-card">
                            <div class="table-header">
                                <h3><i class="fas fa-utensils me-2" aria-hidden="true"></i>Commandes en cours</h3>
                                <button class="btn btn-primary" onclick="openOrderModal()" aria-label="Nouvelle commande">
                                    <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle commande
                                </button>
                            </div>
                            <div class="table-responsive">
                                <table class="table" id="dashboard-orders-table" aria-label="Liste des commandes">
                                    <thead>
                                        <tr>
                                            <th>N¬∞</th>
                                            <th>Table</th>
                                            <th>Client</th>
                                            <th>Articles</th>
                                            <th>Total</th>
                                            <th>Heure</th>
                                            <th>Statut</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${appData.restaurantOrders.slice(0, 5).map(o => `
                                            <tr>
                                                <td><strong>${o.id}</strong></td>
                                                <td><span class="badge badge-info">Table ${o.table}</span></td>
                                                <td>${o.guest || 'Anonyme'}</td>
                                                <td>${o.items.length} article(s)</td>
                                                <td>${(o.total / 1000).toFixed(0)}k XOF</td>
                                                <td>${o.time}</td>
                                                <td><span class="badge ${o.status === 'paid' ? 'badge-success' : o.status === 'preparing' ? 'badge-warning' : 'badge-info'}">${getOrderStatusLabel(o.status)}</span></td>
                                                <td>
                                                    <button class="btn btn-info btn-sm" onclick="viewOrder('${o.id}')" aria-label="Voir les d√©tails de la commande ${o.id}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                                    ${o.status === 'preparing' ? `<button class="btn btn-success btn-sm" onclick="markOrderReady('${o.id}')" aria-label="Marquer la commande comme pr√™te"><i class="fas fa-check" aria-hidden="true"></i></button>` : ''}
                                                    <button class="btn btn-primary btn-sm" onclick="showOrderInvoice('${o.id}')" aria-label="Voir la facture de la commande ${o.id}"><i class="fas fa-file-invoice" aria-hidden="true"></i></button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="table-card">
                            <h3><i class="fas fa-fire me-2" aria-hidden="true"></i>En cuisine</h3>
                            <div class="kitchen-orders">
                                ${preparing.map(o => `
                                    <div class="kitchen-card">
                                        <div class="kitchen-header">
                                            <span class="table-number">Table ${o.table}</span>
                                            <span class="timer"><i class="far fa-clock" aria-hidden="true"></i> ${calculateTimeSince(o.time)}</span>
                                        </div>
                                        <ul class="kitchen-items" aria-label="Articles de la commande">
                                            ${o.items.map(item => `<li>${item.qty}x ${item.name}</li>`).join('')}
                                        </ul>
                                        <button class="btn btn-success btn-sm w-100" onclick="markOrderReady('${o.id}')" aria-label="Marquer la commande comme pr√™te">
                                            <i class="fas fa-check" aria-hidden="true"></i> Pr√™t
                                        </button>
                                    </div>
                                `).join('')}
                                ${preparing.length === 0 ? '<p class="text-muted text-center">Aucune commande en cuisine</p>' : ''}
                            </div>
                        </div>

                        <div class="table-card mt-3">
                            <h3><i class="fas fa-chart-simple me-2" aria-hidden="true"></i>Statistiques du jour</h3>
                            <canvas id="restaurant-stats" style="height: 200px;" aria-label="Statistiques du restaurant" role="img"></canvas>
                            <div class="mt-3">
                                <p><strong>Total encaiss√©:</strong> ${(appData.restaurantOrders.filter(o => o.status === 'paid').reduce((sum, o) => sum + o.total, 0) / 1000).toFixed(0)}k XOF</p>
                                <p><strong>Commandes imput√©es:</strong> ${appData.restaurantOrders.filter(o => o.roomCharge).length}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderManagerDashboard() {
            const totalRevenue = appData.stats.hotelRevenue + appData.stats.restaurantRevenue;
            const expensesTotal = appData.expenses.reduce((sum, e) => sum + e.amount, 0);
            const profit = totalRevenue - expensesTotal;

            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon primary">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(totalRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA Total (XOF)</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon success">
                                <i class="fas fa-coins" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(profit / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">B√©n√©fice net</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon warning">
                                <i class="fas fa-users" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${appData.employees.length}</div>
                        <div class="stat-label">Employ√©s</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon danger">
                                <i class="fas fa-file-invoice" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${appData.expenses.filter(e => !e.paid).length}</div>
                        <div class="stat-label">Factures impay√©es</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="table-card">
                            <h3><i class="fas fa-chart-bar me-2" aria-hidden="true"></i>Performance mensuelle</h3>
                            <canvas id="performance-chart" style="height: 250px;" aria-label="Graphique de performance mensuelle" role="img"></canvas>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="table-card">
                            <h3><i class="fas fa-file-invoice me-2" aria-hidden="true"></i>Derni√®res factures</h3>
                            <div class="table-responsive">
                                <table class="table" aria-label="Liste des derni√®res factures">
                                    <thead>
                                        <tr>
                                            <th>N¬∞</th>
                                            <th>Client</th>
                                            <th>Montant</th>
                                            <th>Statut</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${appData.bookings.slice(0, 5).map(b => `
                                            <tr>
                                                <td>${b.id}</td>
                                                <td>${b.guest}</td>
                                                <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                                <td><span class="badge badge-success">Pay√©e</span></td>
                                                <td><button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture ${b.id}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="table-card">
                            <h3><i class="fas fa-exclamation-triangle me-2" aria-hidden="true"></i>Alertes stock</h3>
                            ${appData.stock.filter(s => s.quantity <= s.threshold).map(s => `
                                <div class="alert alert-warning d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>${s.name}</strong> - ${s.quantity} ${s.unit} restants
                                        <br><small>Seuil: ${s.threshold} ${s.unit}</small>
                                    </div>
                                    <button class="btn btn-warning btn-sm" onclick="orderStock('${s.id}')" aria-label="Commander du ${s.name}">
                                        Commander
                                    </button>
                                </div>
                            `).join('') || '<p class="text-muted">Aucune alerte stock</p>'}
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="table-card">
                            <h3><i class="fas fa-calendar-check me-2" aria-hidden="true"></i>√âquipe aujourd'hui</h3>
                            ${appData.employees.map(e => `
                                <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-light rounded">
                                    <div>
                                        <strong>${e.name}</strong>
                                        <br><small>${e.role}</small>
                                    </div>
                                    <span class="badge badge-success">Pr√©sent</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderBookings() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-hotel me-2" aria-hidden="true"></i>Toutes les r√©servations</h3>
                        <button class="btn btn-primary" onclick="openReservationModal()" aria-label="Nouvelle r√©servation">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle r√©servation
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="bookings-table" aria-label="Liste de toutes les r√©servations">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Client</th>
                                    <th>Chambre</th>
                                    <th>Arriv√©e</th>
                                    <th>D√©part</th>
                                    <th>Adultes</th>
                                    <th>Enfants</th>
                                    <th>Total</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.map(b => `
                                    <tr>
                                        <td>${b.id}</td>
                                        <td>${b.guest}<br><small>${b.phone}</small></td>
                                        <td>${b.room}</td>
                                        <td>${formatDate(b.checkin)}</td>
                                        <td>${formatDate(b.checkout)}</td>
                                        <td>${b.adults}</td>
                                        <td>${b.children}</td>
                                        <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                        <td><span class="badge ${getStatusClass(b.status)}">${getStatusLabel(b.status)}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir les d√©tails de la r√©servation ${b.id}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de la r√©servation ${b.id}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                            <button class="btn btn-danger btn-sm" onclick="deleteBooking('${b.id}')" aria-label="Supprimer la r√©servation ${b.id}"><i class="fas fa-trash" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderOrders() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-utensils me-2" aria-hidden="true"></i>Commandes restaurant</h3>
                        <button class="btn btn-primary" onclick="openOrderModal()" aria-label="Nouvelle commande">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle commande
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="orders-table" aria-label="Liste de toutes les commandes">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Table</th>
                                    <th>Client</th>
                                    <th>Articles</th>
                                    <th>Total</th>
                                    <th>Heure</th>
                                    <th>Statut</th>
                                    <th>Imputation</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.restaurantOrders.map(o => `
                                    <tr>
                                        <td>${o.id}</td>
                                        <td><span class="badge badge-info">${o.table}</span></td>
                                        <td>${o.guest || 'Anonyme'}</td>
                                        <td>${o.items.map(i => `${i.qty}x ${i.name}`).join(', ')}</td>
                                        <td>${(o.total / 1000).toFixed(0)}k XOF</td>
                                        <td>${o.time}</td>
                                        <td><span class="badge ${o.status === 'paid' ? 'badge-success' : o.status === 'preparing' ? 'badge-warning' : 'badge-info'}">${getOrderStatusLabel(o.status)}</span></td>
                                        <td>${o.roomCharge ? `<i class="fas fa-hotel text-primary" aria-hidden="true"></i> Ch. ${o.roomNumber}` : '-'}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewOrder('${o.id}')" aria-label="Voir les d√©tails de la commande ${o.id}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                            ${o.status === 'preparing' ? `<button class="btn btn-success btn-sm" onclick="markOrderReady('${o.id}')" aria-label="Marquer la commande comme pr√™te"><i class="fas fa-check" aria-hidden="true"></i></button>` : ''}
                                            <button class="btn btn-primary btn-sm" onclick="showOrderInvoice('${o.id}')" aria-label="Voir la facture de la commande ${o.id}"><i class="fas fa-file-invoice" aria-hidden="true"></i></button>
                                            <button class="btn btn-danger btn-sm" onclick="deleteOrder('${o.id}')" aria-label="Supprimer la commande ${o.id}"><i class="fas fa-trash" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderRooms() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-door-open me-2" aria-hidden="true"></i>Gestion des chambres</h3>
                        <button class="btn btn-primary" onclick="openRoomModal()" aria-label="Ajouter une chambre">
                            <i class="fas fa-plus" aria-hidden="true"></i> Ajouter chambre
                        </button>
                    </div>

                    <div class="room-grid">
                        ${appData.rooms.map(room => `
                            <button class="room-card ${room.status}" onclick="viewRoom(${room.number})" aria-label="Voir les d√©tails de la chambre ${room.number}">
                                <div class="d-flex justify-content-between">
                                    <span class="room-number">Ch. ${room.number}</span>
                                    <span class="badge ${room.status === 'available' ? 'badge-success' : room.status === 'occupied' ? 'badge-info' : room.status === 'reserved' ? 'badge-warning' : 'badge-danger'}">
                                        ${room.status === 'available' ? 'Disponible' : room.status === 'occupied' ? 'Occup√©e' : room.status === 'reserved' ? 'R√©serv√©e' : 'Maintenance'}
                                    </span>
                                </div>
                                <div class="room-type">${room.type}</div>
                                <div class="room-price">${room.price.toLocaleString()} XOF/nuit</div>
                                ${room.guest ? `<small class="text-muted">Occup√© par: ${room.guest}</small>` : ''}
                            </button>
                        `).join('')}
                    </div>

                    <div class="mt-4">
                        <h4>L√©gende</h4>
                        <div class="d-flex gap-3">
                            <span><span class="badge badge-success" style="width: 12px; height: 12px; padding: 0; border-radius: 50%; margin-right: 5px;"></span> Disponible</span>
                            <span><span class="badge badge-info" style="width: 12px; height: 12px; padding: 0; border-radius: 50%; margin-right: 5px;"></span> Occup√©e</span>
                            <span><span class="badge badge-warning" style="width: 12px; height: 12px; padding: 0; border-radius: 50%; margin-right: 5px;"></span> R√©serv√©e</span>
                            <span><span class="badge badge-danger" style="width: 12px; height: 12px; padding: 0; border-radius: 50%; margin-right: 5px;"></span> Maintenance</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCalendar() {
            return `
                <div class="table-card">
                    <div id="calendar" style="height: 600px;" aria-label="Calendrier des r√©servations" role="application"></div>
                </div>
            `;
        }

        function renderGuests() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-users me-2" aria-hidden="true"></i>Fiches clients</h3>
                        <button class="btn btn-primary" onclick="openGuestModal()" aria-label="Ajouter un client">
                            <i class="fas fa-user-plus" aria-hidden="true"></i> Nouveau client
                        </button>
                    </div>

                    ${appData.guests.map(g => `
                        <div class="card mb-3 p-3">
                            <div class="row">
                                <div class="col-md-3">
                                    <h5>${g.name}</h5>
                                    <p class="mb-1"><i class="fas fa-envelope me-2" aria-hidden="true"></i> ${g.email}</p>
                                    <p class="mb-1"><i class="fas fa-phone me-2" aria-hidden="true"></i> ${g.phone}</p>
                                </div>
                                <div class="col-md-2">
                                    <strong>S√©jours: ${g.stays}</strong><br>
                                    <small>D√©p. totale: ${(g.totalSpent / 1000000).toFixed(1)}M XOF</small>
                                </div>
                                <div class="col-md-4">
                                    <strong>Pr√©f√©rences:</strong>
                                    <p>${g.preferences}</p>
                                </div>
                                <div class="col-md-3">
                                    <strong>Dernier s√©jour:</strong> ${formatDate(g.lastStay)}
                                    <div class="mt-2">
                                        <button class="btn btn-info btn-sm" onclick="viewGuest('${g.id}')" aria-label="Voir les d√©tails du client ${g.name}"><i class="fas fa-eye" aria-hidden="true"></i></button>
                                        <button class="btn btn-primary btn-sm" onclick="generateGuestInvoice('${g.id}')" aria-label="G√©n√©rer une facture pour ${g.name}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <div class="table-card mt-3">
                    <h3><i class="fas fa-history me-2" aria-hidden="true"></i>Historique des s√©jours</h3>
                    <div class="table-responsive">
                        <table class="table" aria-label="Historique des s√©jours">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>P√©riode</th>
                                    <th>Chambre</th>
                                    <th>Montant</th>
                                    <th>Facture</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.map(b => `
                                    <tr>
                                        <td>${b.guest}</td>
                                        <td>${formatDate(b.checkin)} - ${formatDate(b.checkout)}</td>
                                        <td>${b.room}</td>
                                        <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                        <td>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de ${b.guest}">
                                                <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderStock() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-boxes me-2" aria-hidden="true"></i>Gestion des stocks</h3>
                        <button class="btn btn-primary" onclick="openStockModal()" aria-label="Ajouter un article">
                            <i class="fas fa-plus" aria-hidden="true"></i> Ajouter article
                        </button>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stat-card p-3">
                                <div class="stat-value">${appData.stock.length}</div>
                                <div class="stat-label">Total articles</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card p-3">
                                <div class="stat-value text-warning">${appData.stock.filter(s => s.quantity <= s.threshold).length}</div>
                                <div class="stat-label">Alertes</div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des stocks">
                            <thead>
                                <tr>
                                    <th>Article</th>
                                    <th>Cat√©gorie</th>
                                    <th>Quantit√©</th>
                                    <th>Seuil</th>
                                    <th>Expiration</th>
                                    <th>Fournisseur</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.stock.map(s => `
                                    <tr class="${s.quantity <= s.threshold ? 'table-warning' : ''}">
                                        <td><strong>${s.name}</strong></td>
                                        <td>${s.category}</td>
                                        <td>${s.quantity} ${s.unit}</td>
                                        <td>${s.threshold} ${s.unit}</td>
                                        <td>
                                            ${s.expiry ? formatDate(s.expiry) : '-'}
                                            ${s.expiry && new Date(s.expiry) < new Date() ? '<span class="badge badge-danger">P√©rim√©</span>' : ''}
                                        </td>
                                        <td>${s.supplier}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="editStock('${s.id}')" aria-label="Modifier l'article ${s.name}"><i class="fas fa-edit" aria-hidden="true"></i></button>
                                            <button class="btn btn-warning btn-sm" onclick="orderStock('${s.id}')" aria-label="Commander du ${s.name}"><i class="fas fa-shopping-cart" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderStaff() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-users-cog me-2" aria-hidden="true"></i>Personnel</h3>
                        <button class="btn btn-primary" onclick="openEmployeeModal()" aria-label="Ajouter un employ√©">
                            <i class="fas fa-user-plus" aria-hidden="true"></i> Ajouter employ√©
                        </button>
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stat-card p-3">
                                <div class="stat-value">${appData.employees.length}</div>
                                <div class="stat-label">Total employ√©s</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card p-3">
                                <div class="stat-value">${appData.employees.filter(e => e.department === 'restaurant').length}</div>
                                <div class="stat-label">Restaurant</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card p-3">
                                <div class="stat-value">${appData.employees.filter(e => e.department === 'reception').length}</div>
                                <div class="stat-label">R√©ception</div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table" aria-label="Liste du personnel">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>R√¥le</th>
                                    <th>D√©partement</th>
                                    <th>T√©l√©phone</th>
                                    <th>Email</th>
                                    <th>Planning</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.employees.map(e => `
                                    <tr>
                                        <td><strong>${e.name}</strong></td>
                                        <td>${e.role}</td>
                                        <td>${e.department}</td>
                                        <td>${e.phone}</td>
                                        <td>${e.email}</td>
                                        <td>${e.schedule}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="editEmployee('${e.id}')" aria-label="Modifier les informations de ${e.name}"><i class="fas fa-edit" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderInvoices() {
            return `
                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-file-invoice me-2" aria-hidden="true"></i>Factures</h3>
                        <button class="btn btn-primary" onclick="generateNewInvoice()" aria-label="Cr√©er une nouvelle facture">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle facture
                        </button>
                    </div>

                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des factures">
                            <thead>
                                <tr>
                                    <th>N¬∞ Facture</th>
                                    <th>Client</th>
                                    <th>Date</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.map((b, idx) => `
                                    <tr>
                                        <td><strong>FAC-${String(idx+1).padStart(4,'0')}</strong></td>
                                        <td>${b.guest}</td>
                                        <td>${formatDate(b.checkout)}</td>
                                        <td>${(b.total / 1000).toFixed(0)}k XOF</td>
                                        <td><span class="badge ${b.status === 'checked-out' ? 'badge-success' : 'badge-warning'}">${b.status === 'checked-out' ? 'Pay√©e' : 'En attente'}</span></td>
                                        <td>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture de ${b.guest}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}

                                ${appData.restaurantOrders.filter(o => !o.roomCharge).map((o, idx) => `
                                    <tr>
                                        <td><strong>FAC-REST-${String(idx+1).padStart(3,'0')}</strong></td>
                                        <td>${o.guest || 'Client restaurant'}</td>
                                        <td>${formatDate(o.date)}</td>
                                        <td>${(o.total / 1000).toFixed(0)}k XOF</td>
                                        <td><span class="badge badge-success">Pay√©e</span></td>
                                        <td>
                                            <button class="btn btn-primary btn-sm" onclick="showOrderInvoice('${o.id}')" aria-label="Voir la facture de la commande ${o.id}"><i class="fas fa-file-pdf" aria-hidden="true"></i></button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderReports() {
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${(appData.stats.hotelRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA H√¥tel</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(appData.stats.restaurantRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA Restaurant</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(appData.expenses.reduce((sum, e) => sum + e.amount, 0) / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">D√©penses</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="table-card">
                            <h3>Performance mensuelle</h3>
                            <canvas id="monthly-report-chart" style="height: 300px;" aria-label="Graphique de performance mensuelle" role="img"></canvas>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="table-card">
                            <h3>R√©partition des revenus</h3>
                            <canvas id="report-pie-chart" style="height: 300px;" aria-label="Graphique de r√©partition des revenus" role="img"></canvas>
                        </div>
                    </div>
                </div>

                <div class="table-card mt-3">
                    <h3>Export de donn√©es</h3>
                    <div class="row">
                        <div class="col-md-3">
                            <button class="btn btn-primary w-100 mb-2" onclick="exportData('hotel')" aria-label="Exporter les donn√©es h√¥tel">
                                <i class="fas fa-file-excel" aria-hidden="true"></i> Export H√¥tel
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-primary w-100 mb-2" onclick="exportData('restaurant')" aria-label="Exporter les donn√©es restaurant">
                                <i class="fas fa-file-excel" aria-hidden="true"></i> Export Restaurant
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-primary w-100 mb-2" onclick="exportData('financial')" aria-label="Exporter le rapport financier">
                                <i class="fas fa-file-pdf" aria-hidden="true"></i> Rapport financier
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderExpenses() {
            const totalPaid = appData.expenses.filter(e => e.paid).reduce((sum, e) => sum + e.amount, 0);
            const totalUnpaid = appData.expenses.filter(e => !e.paid).reduce((sum, e) => sum + e.amount, 0);

            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${(totalPaid / 1000).toFixed(0)}k</div>
                        <div class="stat-label">D√©penses pay√©es</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value text-warning">${(totalUnpaid / 1000).toFixed(0)}k</div>
                        <div class="stat-label">√Ä payer</div>
                    </div>
                </div>

                <div class="table-card">
                    <div class="table-header">
                        <h3><i class="fas fa-coins me-2" aria-hidden="true"></i>Liste des d√©penses</h3>
                        <button class="btn btn-primary" onclick="openExpenseModal()" aria-label="Ajouter une d√©pense">
                            <i class="fas fa-plus" aria-hidden="true"></i> Nouvelle d√©pense
                        </button>
                    </div>

                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des d√©penses">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Cat√©gorie</th>
                                    <th>Description</th>
                                    <th>Montant</th>
                                    <th>√âch√©ance</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.expenses.map(e => `
                                    <tr>
                                        <td>${formatDate(e.date)}</td>
                                        <td>${e.category}</td>
                                        <td>${e.description}</td>
                                        <td><strong>${(e.amount / 1000).toFixed(0)}k XOF</strong></td>
                                        <td>${formatDate(e.dueDate)}</td>
                                        <td><span class="badge ${e.paid ? 'badge-success' : 'badge-warning'}">${e.paid ? 'Pay√©e' : 'En attente'}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="editExpense('${e.id}')" aria-label="Modifier la d√©pense ${e.description}"><i class="fas fa-edit" aria-hidden="true"></i></button>
                                            ${!e.paid ? `<button class="btn btn-success btn-sm" onclick="markAsPaid('${e.id}')" aria-label="Marquer la d√©pense comme pay√©e"><i class="fas fa-check" aria-hidden="true"></i></button>` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // ============================================
        // GESTION DES R√âSERVATIONS
        // ============================================

        function submitReservation() {
            const guestName = document.getElementById('guestName').value;
            const guestPhone = document.getElementById('guestPhone').value;
            const guestEmail = document.getElementById('guestEmail').value;
            const roomNumber = parseInt(document.getElementById('roomSelect').value);
            const checkin = document.getElementById('checkinDate').value;
            const checkout = document.getElementById('checkoutDate').value;
            const adults = parseInt(document.getElementById('adults').value);
            const children = parseInt(document.getElementById('children').value);
            const specialRequests = document.getElementById('specialRequests').value;

            const room = appData.rooms.find(r => r.number === roomNumber);
            if (!room) return;

            const nights = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
            const total = room.price * nights;

            const newId = 'BK' + String(appData.bookings.length + 1).padStart(3, '0');

            const newBooking = {
                id: newId,
                guest: guestName,
                room: room.type,
                roomNumber: room.number,
                checkin: checkin,
                checkout: checkout,
                adults: adults,
                children: children,
                status: 'confirmed',
                total: total,
                phone: guestPhone,
                email: guestEmail,
                prepaid: Math.round(total * 0.3),
                specialRequests: specialRequests
            };

            appData.bookings.push(newBooking);
            room.status = 'reserved';
            room.guest = guestName;

            if (!appData.guests.some(g => g.phone === guestPhone)) {
                const newGuest = {
                    id: 'G' + String(appData.guests.length + 1).padStart(3, '0'),
                    name: guestName,
                    email: guestEmail,
                    phone: guestPhone,
                    stays: 1,
                    preferences: specialRequests,
                    totalSpent: total,
                    lastStay: checkin
                };
                appData.guests.push(newGuest);
            }

            const modal = bootstrap.Modal.getInstance(document.getElementById('reservationModal'));
            modal.hide();

            updateBadges();
            updateRoomSelectors();
            loadModule('bookings');

            showNotification(`R√©servation cr√©√©e pour ${guestName}`, 'success');
        }

        function deleteBooking(id) {
            if (!confirm('√ätes-vous s√ªr de vouloir supprimer cette r√©servation ?')) return;

            const booking = appData.bookings.find(b => b.id === id);
            if (!booking) return;

            const room = appData.rooms.find(r => r.number === booking.roomNumber);
            if (room) {
                room.status = 'available';
                room.guest = null;
            }

            appData.bookings = appData.bookings.filter(b => b.id !== id);

            updateBadges();
            loadModule('bookings');

            showNotification('R√©servation supprim√©e', 'success');
        }

        // ============================================
        // GESTION DES COMMANDES
        // ============================================

        function addOrderItem() {
            const orderItems = document.getElementById('orderItems');
            const newItem = document.createElement('div');
            newItem.className = 'row mb-2 order-item';
            newItem.innerHTML = `
                <div class="col-md-6">
                    <select class="form-control item-select">
                        <option value="">S√©lectionner un article</option>
                        <option value="Thieboudienne" data-price="12500">Thieboudienne - 12 500 XOF</option>
                        <option value="Yassa Poulet" data-price="11000">Yassa Poulet - 11 000 XOF</option>
                        <option value="Maf√© d'agneau" data-price="12000">Maf√© d'agneau - 12 000 XOF</option>
                        <option value="Poulet DG" data-price="13800">Poulet DG - 13 800 XOF</option>
                        <option value="Pastels" data-price="8000">Pastels - 8 000 XOF</option>
                        <option value="Filet de Capitaine" data-price="14500">Filet de Capitaine - 14 500 XOF</option>
                        <option value="Jus de bissap" data-price="3500">Jus de bissap - 3 500 XOF</option>
                        <option value="Jus de gingembre" data-price="3500">Jus de gingembre - 3 500 XOF</option>
                        <option value="Jus de bouye" data-price="4000">Jus de bouye - 4 000 XOF</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <input type="number" class="form-control item-qty" value="1" min="1">
                </div>
                <div class="col-md-2">
                    <span class="item-price-display">12 500</span> XOF
                </div>
                <div class="col-md-1">
                    <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
            `;
            orderItems.appendChild(newItem);

            const select = newItem.querySelector('.item-select');
            const qty = newItem.querySelector('.item-qty');
            select.addEventListener('change', updatePriceDisplay);
            qty.addEventListener('input', calculateOrderTotal);
        }

        function removeOrderItem(btn) {
            btn.closest('.order-item').remove();
            calculateOrderTotal();
        }

        function updatePriceDisplay(e) {
            const row = e.target.closest('.order-item');
            const select = row.querySelector('.item-select');
            const priceDisplay = row.querySelector('.item-price-display');
            const selectedOption = select.options[select.selectedIndex];

            if (selectedOption && selectedOption.dataset.price) {
                priceDisplay.textContent = parseInt(selectedOption.dataset.price).toLocaleString();
            }

            calculateOrderTotal();
        }

        function calculateOrderTotal() {
            let total = 0;
            document.querySelectorAll('.order-item').forEach(item => {
                const select = item.querySelector('.item-select');
                const qty = item.querySelector('.item-qty');
                const selectedOption = select.options[select.selectedIndex];

                if (selectedOption && selectedOption.dataset.price) {
                    total += parseInt(selectedOption.dataset.price) * parseInt(qty.value || 1);
                }
            });

            document.getElementById('orderTotal').textContent = total.toLocaleString();
        }

        function submitOrder() {
            const tableNumber = document.getElementById('tableNumber').value;
            const guestName = document.getElementById('orderGuestName').value;
            const chargeToRoom = document.getElementById('chargeToRoom').checked;
            const roomNumber = chargeToRoom ? parseInt(document.getElementById('chargeRoomSelect').value) : null;

            const items = [];
            document.querySelectorAll('.order-item').forEach(item => {
                const select = item.querySelector('.item-select');
                const qty = item.querySelector('.item-qty');
                const selectedOption = select.options[select.selectedIndex];

                if (selectedOption && selectedOption.value) {
                    items.push({
                        name: selectedOption.value,
                        qty: parseInt(qty.value),
                        price: parseInt(selectedOption.dataset.price)
                    });
                }
            });

            if (items.length === 0) {
                showNotification('Veuillez ajouter au moins un article', 'error');
                return;
            }

            const total = items.reduce((sum, item) => sum + (item.price * item.qty), 0);

            let roomId = null;
            if (chargeToRoom && roomNumber) {
                const booking = appData.bookings.find(b => b.roomNumber === roomNumber && b.status === 'checked-in');
                if (booking) {
                    roomId = booking.id;
                }
            }

            const newId = 'R' + String(appData.restaurantOrders.length + 1).padStart(3, '0');

            const now = new Date();
            const time = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
            const date = now.toISOString().split('T')[0];

            const newOrder = {
                id: newId,
                table: parseInt(tableNumber),
                guest: guestName || 'Anonyme',
                items: items,
                total: total,
                status: chargeToRoom ? 'paid' : 'preparing',
                roomCharge: chargeToRoom,
                roomNumber: roomNumber,
                roomId: roomId,
                time: time,
                date: date
            };

            appData.restaurantOrders.push(newOrder);

            const modal = bootstrap.Modal.getInstance(document.getElementById('orderModal'));
            modal.hide();

            updateBadges();
            loadModule('orders');

            showNotification(`Commande table ${tableNumber} enregistr√©e`, 'success');
        }

        function deleteOrder(id) {
            if (!confirm('√ätes-vous s√ªr de vouloir supprimer cette commande ?')) return;

            appData.restaurantOrders = appData.restaurantOrders.filter(o => o.id !== id);

            updateBadges();
            loadModule('orders');

            showNotification('Commande supprim√©e', 'success');
        }

        function markOrderReady(id) {
            const order = appData.restaurantOrders.find(o => o.id === id);
            if (order) {
                order.status = 'paid';
                loadModule(currentModule);
                showNotification(`Commande table ${order.table} pr√™te`, 'success');
            }
        }

        // ============================================
        // GESTION DES FACTURES - VERSION CORRIG√âE
        // ============================================

        function showInvoice(id) {
            const booking = appData.bookings.find(b => b.id === id);
            if (!booking) return;

            const roomOrders = appData.restaurantOrders.filter(o => o.roomId === id);
            const roomOrdersTotal = roomOrders.reduce((sum, o) => sum + o.total, 0);

            const total = booking.total + roomOrdersTotal;
            const paid = booking.prepaid + roomOrdersTotal;

            const invoiceHTML = `
                <div class="invoice-preview" id="invoice-preview">
                    <div class="invoice-header">
                        <div>
                            <img src="images/logo1.png" alt="Lawmar" class="invoice-logo" onerror="this.src='https://via.placeholder.com/80x80/0d6efd/ffffff?text=LAW'">
                        </div>
                        <div>
                            <h1 class="invoice-title">FACTURE</h1>
                            <p>N¬∞ FAC-${String(invoiceCounter).padStart(4,'0')}</p>
                        </div>
                    </div>

                    <div class="invoice-details">
                        <div class="row">
                            <div class="col-6">
                                <h5>√âmetteur</h5>
                                <p>
                                    <strong>Lawmar Les R√©sidences</strong><br>
                                    Gandiol, Saint-Louis, S√©n√©gal<br>
                                    NINEA: 12345678<br>
                                    T√©l: +221 33 123 45 67
                                </p>
                            </div>
                            <div class="col-6 text-end">
                                <h5>Client</h5>
                                <p>
                                    <strong>${booking.guest}</strong><br>
                                    T√©l: ${booking.phone}<br>
                                    Email: ${booking.email}
                                </p>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col-6">
                                <p><strong>Date de facture:</strong> ${formatDate(new Date().toISOString())}</p>
                                <p><strong>P√©riode:</strong> ${formatDate(booking.checkin)} au ${formatDate(booking.checkout)}</p>
                            </div>
                            <div class="col-6 text-end">
                                <p><strong>Chambre:</strong> ${booking.room}</p>
                                <p><strong>Statut:</strong> ${getStatusLabel(booking.status)}</p>
                            </div>
                        </div>
                    </div>

                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Quantit√©</th>
                                <th>Prix unitaire</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>H√©bergement - ${booking.room}</td>
                                <td>${Math.ceil((new Date(booking.checkout) - new Date(booking.checkin)) / (1000*60*60*24))} nuits</td>
                                <td>${(booking.total / Math.ceil((new Date(booking.checkout) - new Date(booking.checkin)) / (1000*60*60*24))).toLocaleString()} XOF</td>
                                <td>${booking.total.toLocaleString()} XOF</td>
                            </tr>
                            ${roomOrders.map(o => `
                                <tr>
                                    <td colspan="4">
                                        <strong>Commande Restaurant - Table ${o.table} (${o.time})</strong>
                                    </td>
                                </tr>
                                ${o.items.map(item => `
                                    <tr>
                                        <td style="padding-left: 30px;">${item.name}</td>
                                        <td>${item.qty}</td>
                                        <td>${item.price.toLocaleString()} XOF</td>
                                        <td>${(item.price * item.qty).toLocaleString()} XOF</td>
                                    </tr>
                                `).join('')}
                            `).join('')}
                        </tbody>
                    </table>

                    <div class="row">
                        <div class="col-6">
                            <h5>R√©capitulatif des paiements</h5>
                            <p>Acompte vers√©: ${booking.prepaid.toLocaleString()} XOF</p>
                            <p>Commandes imput√©es: ${roomOrdersTotal.toLocaleString()} XOF</p>
                            <p><strong>Total pay√©: ${paid.toLocaleString()} XOF</strong></p>
                        </div>
                        <div class="col-6">
                            <div class="invoice-total">
                                <p>Total TTC: ${total.toLocaleString()} XOF</p>
                                <p>D√©j√† pay√©: ${paid.toLocaleString()} XOF</p>
                                <hr>
                                <p><strong>Reste √† payer: ${(total - paid).toLocaleString()} XOF</strong></p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 text-center text-muted">
                        <small>Merci de votre s√©jour √† Lawmar Les R√©sidences - √Ä bient√¥t !</small>
                    </div>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceHTML;
            currentInvoice = booking;

            const invoiceModal = new bootstrap.Modal(document.getElementById('invoiceModal'));
            invoiceModal.show();

            invoiceCounter++;
        }

        function showOrderInvoice(id) {
            const order = appData.restaurantOrders.find(o => o.id === id);
            if (!order) return;

            const invoiceHTML = `
                <div class="invoice-preview" id="invoice-preview">
                    <div class="invoice-header">
                        <div>
                            <img src="images/logo1.png" alt="Lawmar" class="invoice-logo" onerror="this.src='https://via.placeholder.com/80x80/0d6efd/ffffff?text=LAW'">
                        </div>
                        <div>
                            <h1 class="invoice-title">FACTURE RESTAURANT</h1>
                            <p>N¬∞ FAC-REST-${String(invoiceCounter).padStart(4,'0')}</p>
                        </div>
                    </div>

                    <div class="invoice-details">
                        <div class="row">
                            <div class="col-6">
                                <h5>√âmetteur</h5>
                                <p>
                                    <strong>Lawmar Les R√©sidences - Restaurant</strong><br>
                                    Gandiol, Saint-Louis, S√©n√©gal<br>
                                    NINEA: 12345678<br>
                                    T√©l: +221 33 123 45 67
                                </p>
                            </div>
                            <div class="col-6 text-end">
                                <h5>Client</h5>
                                <p>
                                    <strong>${order.guest || 'Client restaurant'}</strong><br>
                                    Table: ${order.table}
                                </p>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <div class="col-6">
                                <p><strong>Date de facture:</strong> ${formatDate(new Date().toISOString())}</p>
                                <p><strong>Heure:</strong> ${order.time}</p>
                            </div>
                            <div class="col-6 text-end">
                                <p><strong>Statut:</strong> <span class="badge ${order.status === 'paid' ? 'badge-success' : 'badge-warning'}">${getOrderStatusLabel(order.status)}</span></p>
                                ${order.roomCharge ? `<p><strong>Imput√© √† la chambre:</strong> ${order.roomNumber}</p>` : ''}
                            </div>
                        </div>
                    </div>

                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Quantit√©</th>
                                <th>Prix unitaire</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${order.items.map(item => `
                                <tr>
                                    <td>${item.name}</td>
                                    <td>${item.qty}</td>
                                    <td>${item.price.toLocaleString()} XOF</td>
                                    <td>${(item.price * item.qty).toLocaleString()} XOF</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div class="invoice-total">
                        <p><strong>Total √† payer: ${order.total.toLocaleString()} XOF</strong></p>
                    </div>

                    <div class="mt-4 text-center text-muted">
                        <small>Merci de votre visite au restaurant Lawmar !</small>
                    </div>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceHTML;
            currentInvoice = order;

            const invoiceModal = new bootstrap.Modal(document.getElementById('invoiceModal'));
            invoiceModal.show();

            invoiceCounter++;
        }

        function downloadInvoicePDF() {
            if (!currentInvoice) {
                showNotification('Aucune facture √† t√©l√©charger', 'error');
                return;
            }

            const invoiceElement = document.getElementById('invoice-preview');

            showNotification('G√©n√©ration du PDF en cours...', 'info');

            // Utiliser html2canvas pour capturer la facture
            html2canvas(invoiceElement, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                allowTaint: true,
                useCORS: true
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');

                try {
                    // Cr√©er le PDF avec jsPDF
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF({
                        orientation: 'portrait',
                        unit: 'mm',
                        format: 'a4'
                    });

                    const imgWidth = 210; // Largeur A4 en mm
                    const pageHeight = 297; // Hauteur A4 en mm
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    let heightLeft = imgHeight;
                    let position = 0;

                    // Ajouter la premi√®re page
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;

                    // Ajouter des pages suppl√©mentaires si n√©cessaire
                    while (heightLeft > 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }

                    // G√©n√©rer le nom du fichier
                    const fileName = `facture_${currentInvoice.guest || 'restaurant'}_${new Date().toISOString().split('T')[0]}.pdf`;

                    // T√©l√©charger le PDF
                    pdf.save(fileName);

                    showNotification('Facture t√©l√©charg√©e avec succ√®s', 'success');
                } catch (error) {
                    console.error('Erreur jsPDF:', error);
                    showNotification('Erreur lors de la g√©n√©ration du PDF', 'error');
                }
            }).catch(error => {
                console.error('Erreur html2canvas:', error);
                showNotification('Erreur lors de la g√©n√©ration du PDF', 'error');
            });
        }

        // ============================================
        // GESTION DES CLIENTS
        // ============================================

        function submitGuest() {
            const name = document.getElementById('newGuestName').value;
            const email = document.getElementById('newGuestEmail').value;
            const phone = document.getElementById('newGuestPhone').value;
            const preferences = document.getElementById('newGuestPreferences').value;

            const newId = 'G' + String(appData.guests.length + 1).padStart(3, '0');

            const newGuest = {
                id: newId,
                name: name,
                email: email,
                phone: phone,
                stays: 0,
                preferences: preferences,
                totalSpent: 0,
                lastStay: new Date().toISOString().split('T')[0]
            };

            appData.guests.push(newGuest);

            const modal = bootstrap.Modal.getInstance(document.getElementById('guestModal'));
            modal.hide();

            loadModule('guests');

            showNotification(`Client ${name} ajout√©`, 'success');
        }

        // ============================================
        // GESTION DES STOCKS
        // ============================================

        function submitStock() {
            const name = document.getElementById('stockName').value;
            const category = document.getElementById('stockCategory').value;
            const quantity = parseInt(document.getElementById('stockQuantity').value);
            const unit = document.getElementById('stockUnit').value;
            const threshold = parseInt(document.getElementById('stockThreshold').value);
            const expiry = document.getElementById('stockExpiry').value;
            const supplier = document.getElementById('stockSupplier').value;
            const price = parseInt(document.getElementById('stockPrice').value);

            const newId = 'S' + String(appData.stock.length + 1).padStart(3, '0');

            const newStock = {
                id: newId,
                name: name,
                category: category,
                quantity: quantity,
                unit: unit,
                threshold: threshold,
                expiry: expiry || null,
                supplier: supplier,
                price: price
            };

            appData.stock.push(newStock);

            const modal = bootstrap.Modal.getInstance(document.getElementById('stockModal'));
            modal.hide();

            loadModule('stock');

            showNotification(`Article ${name} ajout√© au stock`, 'success');
        }

        // ============================================
        // GESTION DES EMPLOY√âS
        // ============================================

        function submitEmployee() {
            const name = document.getElementById('employeeName').value;
            const role = document.getElementById('employeeRole').value;
            const department = document.getElementById('employeeDepartment').value;
            const phone = document.getElementById('employeePhone').value;
            const email = document.getElementById('employeeEmail').value;
            const schedule = document.getElementById('employeeSchedule').value;

            const newId = 'E' + String(appData.employees.length + 1).padStart(3, '0');

            const newEmployee = {
                id: newId,
                name: name,
                role: role,
                department: department,
                phone: phone,
                email: email,
                schedule: schedule
            };

            appData.employees.push(newEmployee);

            const modal = bootstrap.Modal.getInstance(document.getElementById('employeeModal'));
            modal.hide();

            loadModule('staff');

            showNotification(`Employ√© ${name} ajout√©`, 'success');
        }

        // ============================================
        // GESTION DES D√âPENSES
        // ============================================

        function submitExpense() {
            const date = document.getElementById('expenseDate').value;
            const category = document.getElementById('expenseCategory').value;
            const description = document.getElementById('expenseDescription').value;
            const amount = parseInt(document.getElementById('expenseAmount').value);
            const dueDate = document.getElementById('expenseDueDate').value;
            const paid = document.getElementById('expensePaid').checked;

            const newId = 'EX' + String(appData.expenses.length + 1).padStart(3, '0');

            const newExpense = {
                id: newId,
                date: date,
                category: category,
                amount: amount,
                description: description,
                paid: paid,
                dueDate: dueDate
            };

            appData.expenses.push(newExpense);

            const modal = bootstrap.Modal.getInstance(document.getElementById('expenseModal'));
            modal.hide();

            loadModule('expenses');

            showNotification(`D√©pense ${description} ajout√©e`, 'success');
        }

        // ============================================
        // GESTION DES CHAMBRES
        // ============================================

        function submitRoom() {
            const number = parseInt(document.getElementById('roomNumber').value);
            const type = document.getElementById('roomType').value;
            const price = parseInt(document.getElementById('roomPrice').value);
            const status = document.getElementById('roomStatus').value;

            if (appData.rooms.some(r => r.number === number)) {
                showNotification('Ce num√©ro de chambre existe d√©j√†', 'error');
                return;
            }

            const newRoom = {
                number: number,
                type: type,
                price: price,
                status: status
            };

            appData.rooms.push(newRoom);

            const modal = bootstrap.Modal.getInstance(document.getElementById('roomModal'));
            modal.hide();

            loadModule('rooms');
            updateRoomSelectors();

            showNotification(`Chambre ${number} ajout√©e`, 'success');
        }

        // ============================================
        // FONCTIONS D'OUVERTURE DES MODALES
        // ============================================

        function openGuestModal() {
            if (!checkAuth()) return;
            document.getElementById('guestForm').reset();
            const modal = new bootstrap.Modal(document.getElementById('guestModal'));
            modal.show();
        }

        function openStockModal() {
            if (!checkAuth()) return;
            document.getElementById('stockForm').reset();
            const today = new Date().toISOString().split('T')[0];
            const nextYear = new Date();
            nextYear.setFullYear(nextYear.getFullYear() + 1);
            document.getElementById('stockExpiry').value = nextYear.toISOString().split('T')[0];
            const modal = new bootstrap.Modal(document.getElementById('stockModal'));
            modal.show();
        }

        function openEmployeeModal() {
            if (!checkAuth()) return;
            document.getElementById('employeeForm').reset();
            const modal = new bootstrap.Modal(document.getElementById('employeeModal'));
            modal.show();
        }

        function openExpenseModal() {
            if (!checkAuth()) return;
            document.getElementById('expenseForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('expenseDate').value = today;

            const nextMonth = new Date();
            nextMonth.setMonth(nextMonth.getMonth() + 1);
            document.getElementById('expenseDueDate').value = nextMonth.toISOString().split('T')[0];

            const modal = new bootstrap.Modal(document.getElementById('expenseModal'));
            modal.show();
        }

        function openRoomModal() {
            if (!checkAuth()) return;
            document.getElementById('roomForm').reset();
            const modal = new bootstrap.Modal(document.getElementById('roomModal'));
            modal.show();
        }

        function openReservationModal() {
            if (!checkAuth()) return;
            updateRoomSelectors();

            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];

            document.getElementById('checkinDate').value = today;
            document.getElementById('checkoutDate').value = tomorrow;
            document.getElementById('estimatedTotal').textContent = '0';
            document.getElementById('reservationForm').reset();

            const modal = new bootstrap.Modal(document.getElementById('reservationModal'));
            modal.show();
        }

        function openOrderModal() {
            if (!checkAuth()) return;
            document.getElementById('orderForm').reset();
            document.getElementById('orderItems').innerHTML = `
                <div class="row mb-2 order-item">
                    <div class="col-md-6">
                        <select class="form-control item-select">
                            <option value="">S√©lectionner un article</option>
                            <option value="Thieboudienne" data-price="12500">Thieboudienne - 12 500 XOF</option>
                            <option value="Yassa Poulet" data-price="11000">Yassa Poulet - 11 000 XOF</option>
                            <option value="Maf√© d'agneau" data-price="12000">Maf√© d'agneau - 12 000 XOF</option>
                            <option value="Poulet DG" data-price="13800">Poulet DG - 13 800 XOF</option>
                            <option value="Pastels" data-price="8000">Pastels - 8 000 XOF</option>
                            <option value="Filet de Capitaine" data-price="14500">Filet de Capitaine - 14 500 XOF</option>
                            <option value="Jus de bissap" data-price="3500">Jus de bissap - 3 500 XOF</option>
                            <option value="Jus de gingembre" data-price="3500">Jus de gingembre - 3 500 XOF</option>
                            <option value="Jus de bouye" data-price="4000">Jus de bouye - 4 000 XOF</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="number" class="form-control item-qty" value="1" min="1">
                    </div>
                    <div class="col-md-2">
                        <span class="item-price-display">12 500</span> XOF
                    </div>
                    <div class="col-md-1">
                        <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('roomSelectionDiv').style.display = 'none';
            document.getElementById('orderTotal').textContent = '0';

            updateRoomSelectors();

            const modal = new bootstrap.Modal(document.getElementById('orderModal'));
            modal.show();
        }

        // ============================================
        // FONCTIONS D'ACTION
        // ============================================

        function quickReserve(roomNumber) {
            if (!checkAuth()) return;
            openReservationModal();
            setTimeout(() => {
                document.getElementById('roomSelect').value = roomNumber;
                calculateEstimatedTotal();
            }, 500);
        }

        function checkIn(id) {
            if (!checkAuth()) return;
            const booking = appData.bookings.find(b => b.id === id);
            if (booking) {
                booking.status = 'checked-in';

                const room = appData.rooms.find(r => r.number === booking.roomNumber);
                if (room) {
                    room.status = 'occupied';
                }

                loadModule(currentModule);
                showNotification(`Check-in effectu√© pour ${booking.guest}`, 'success');
            }
        }

        function checkOut(id) {
            if (!checkAuth()) return;
            const booking = appData.bookings.find(b => b.id === id);
            if (booking) {
                booking.status = 'checked-out';

                const room = appData.rooms.find(r => r.number === booking.roomNumber);
                if (room) {
                    room.status = 'available';
                    room.guest = null;
                }

                loadModule(currentModule);
                showNotification(`Check-out effectu√© pour ${booking.guest}`, 'success');

                showInvoice(id);
            }
        }

        function viewBooking(id) {
            if (!checkAuth()) return;
            showNotification(`Consultation r√©servation ${id}`, 'info');
        }

        function viewOrder(id) {
            if (!checkAuth()) return;
            showNotification(`Consultation commande ${id}`, 'info');
        }

        function viewRoom(number) {
            if (!checkAuth()) return;
            const room = appData.rooms.find(r => r.number === number);
            if (room) {
                showNotification(`Chambre ${number} - ${room.type} (${room.status})`, 'info');
            }
        }

        function viewGuest(id) {
            if (!checkAuth()) return;
            showNotification(`Consultation client ${id}`, 'info');
        }

        function editStock(id) {
            if (!checkAuth()) return;
            showNotification(`Modification article ${id}`, 'info');
        }

        function editEmployee(id) {
            if (!checkAuth()) return;
            showNotification(`Modification employ√© ${id}`, 'info');
        }

        function editExpense(id) {
            if (!checkAuth()) return;
            showNotification(`Modification d√©pense ${id}`, 'info');
        }

        function orderStock(id) {
            if (!checkAuth()) return;
            showNotification(`Commande fournisseur pour article ${id}`, 'success');
        }

        function markAsPaid(id) {
            if (!checkAuth()) return;
            const expense = appData.expenses.find(e => e.id === id);
            if (expense) {
                expense.paid = true;
                loadModule('expenses');
                showNotification(`D√©pense ${expense.description} marqu√©e comme pay√©e`, 'success');
            }
        }

        function generateNewInvoice() {
            if (!checkAuth()) return;
            showNotification('Cr√©ation d\'une nouvelle facture', 'info');
        }

        function generateGuestInvoice(id) {
            if (!checkAuth()) return;
            showNotification(`G√©n√©ration facture client ${id}`, 'info');
        }

        function exportData(type) {
            if (!checkAuth()) return;
            showNotification(`Export ${type} g√©n√©r√©`, 'success');
        }

        // ============================================
        // FONCTIONS UTILITAIRES
        // ============================================

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('fr-FR');
        }

        function calculateTimeSince(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            const orderTime = new Date();
            orderTime.setHours(hours, minutes, 0);

            const now = new Date();
            const diffMinutes = Math.floor((now - orderTime) / (1000 * 60));

            if (diffMinutes < 60) {
                return `${diffMinutes} min`;
            } else {
                return `${Math.floor(diffMinutes / 60)}h ${diffMinutes % 60}min`;
            }
        }

        function getStatusLabel(status) {
            const labels = {
                'confirmed': 'Confirm√©e',
                'checked-in': 'En cours',
                'checked-out': 'Termin√©e',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function getStatusClass(status) {
            const classes = {
                'confirmed': 'badge-success',
                'checked-in': 'badge-info',
                'checked-out': 'badge-secondary',
                'pending': 'badge-warning'
            };
            return classes[status] || 'badge-info';
        }

        function getOrderStatusLabel(status) {
            const labels = {
                'paid': 'Pay√©e',
                'preparing': 'En pr√©paration',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function showNotification(message, type = 'success') {
            const container = document.getElementById('notification-center');
            const notification = document.createElement('div');
            notification.className = `notification`;
            notification.style.borderLeftColor = type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107';
            notification.setAttribute('role', 'alert');
            notification.setAttribute('aria-live', 'assertive');

            const icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'info' ? 'fa-info-circle' : 'fa-exclamation-triangle';

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas ${icon}" style="color: ${type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107'};" aria-hidden="true"></i>
                    <span>${message}</span>
                </div>
            `;

            container.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // ============================================
        // INITIALISATION DES GRAPHIQUES
        // ============================================

        function initCharts() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            charts = {};

            if (document.getElementById('occupancy-chart')) {
                charts.occupancy = new Chart(document.getElementById('occupancy-chart'), {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
                        datasets: [{
                            label: 'Taux d\'occupation %',
                            data: [65, 70, 75, 80, 85, 90, 78],
                            borderColor: '#0d6efd',
                            backgroundColor: 'rgba(13, 110, 253, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }

            if (document.getElementById('revenue-chart')) {
                charts.revenue = new Chart(document.getElementById('revenue-chart'), {
                    type: 'doughnut',
                    data: {
                        labels: ['H√¥tel', 'Restaurant'],
                        datasets: [{
                            data: [appData.stats.hotelRevenue, appData.stats.restaurantRevenue],
                            backgroundColor: ['#0d6efd', '#ffc107'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            if (document.getElementById('restaurant-stats')) {
                charts.restaurant = new Chart(document.getElementById('restaurant-stats'), {
                    type: 'doughnut',
                    data: {
                        labels: ['Pay√©es', 'En pr√©paration', 'En attente'],
                        datasets: [{
                            data: [
                                appData.restaurantOrders.filter(o => o.status === 'paid').length,
                                appData.restaurantOrders.filter(o => o.status === 'preparing').length,
                                appData.restaurantOrders.filter(o => o.status === 'pending').length
                            ],
                            backgroundColor: ['#198754', '#ffc107', '#0d6efd'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            if (document.getElementById('performance-chart')) {
                charts.performance = new Chart(document.getElementById('performance-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
                        datasets: [
                            {
                                label: 'H√¥tel (k XOF)',
                                data: [850, 920, 1100, 980],
                                backgroundColor: '#0d6efd'
                            },
                            {
                                label: 'Restaurant (k XOF)',
                                data: [320, 380, 410, 390],
                                backgroundColor: '#ffc107'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        function initReportsCharts() {
            if (document.getElementById('monthly-report-chart')) {
                new Chart(document.getElementById('monthly-report-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'],
                        datasets: [
                            {
                                label: 'H√¥tel (k XOF)',
                                data: [850, 920, 1100, 980],
                                backgroundColor: '#0d6efd'
                            },
                            {
                                label: 'Restaurant (k XOF)',
                                data: [320, 380, 410, 390],
                                backgroundColor: '#ffc107'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            if (document.getElementById('report-pie-chart')) {
                new Chart(document.getElementById('report-pie-chart'), {
                    type: 'pie',
                    data: {
                        labels: ['H√¥tel', 'Restaurant', 'Autres'],
                        datasets: [{
                            data: [70, 25, 5],
                            backgroundColor: ['#0d6efd', '#ffc107', '#6c757d']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }
        }

        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (calendarEl) {
                const calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: 'dayGridMonth',
                    locale: 'fr',
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    events: appData.bookings.map(b => ({
                        title: `${b.guest} - ${b.room}`,
                        start: b.checkin,
                        end: b.checkout,
                        color: '#0d6efd'
                    }))
                });
                calendar.render();
            }
        }

        function initDataTable(tableId) {
            if ($(tableId).length && $.fn.DataTable) {
                if ($(tableId).hasClass('dataTable')) {
                    $(tableId).DataTable().destroy();
                }

                $(tableId).DataTable({
                    language: {
                        url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json'
                    },
                    pageLength: 10,
                    responsive: true
                });
            }
        }

        function loadDashboard() {
            loadModule('dashboard');
        }

        // ============================================
        // EXPOSITION DES FONCTIONS GLOBALES
        // ============================================

        window.logout = logout;
        window.loadModule = loadModule;
        window.switchRole = switchRole;
        window.openReservationModal = openReservationModal;
        window.openOrderModal = openOrderModal;
        window.openRoomModal = openRoomModal;
        window.openGuestModal = openGuestModal;
        window.openStockModal = openStockModal;
        window.openEmployeeModal = openEmployeeModal;
        window.openExpenseModal = openExpenseModal;
        window.quickReserve = quickReserve;
        window.checkIn = checkIn;
        window.checkOut = checkOut;
        window.showInvoice = showInvoice;
        window.showOrderInvoice = showOrderInvoice;
        window.downloadInvoicePDF = downloadInvoicePDF;
        window.deleteBooking = deleteBooking;
        window.deleteOrder = deleteOrder;
        window.markOrderReady = markOrderReady;
        window.addOrderItem = addOrderItem;
        window.removeOrderItem = removeOrderItem;
        window.viewBooking = viewBooking;
        window.viewOrder = viewOrder;
        window.viewRoom = viewRoom;
        window.viewGuest = viewGuest;
        window.editStock = editStock;
        window.editEmployee = editEmployee;
        window.editExpense = editExpense;
        window.orderStock = orderStock;
        window.markAsPaid = markAsPaid;
        window.generateNewInvoice = generateNewInvoice;
        window.exportData = exportData;
        window.generateGuestInvoice = generateGuestInvoice;
    </script>
</body>
</html>