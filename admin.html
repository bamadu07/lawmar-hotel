<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Lawmar PMS - Syst√®me de Gestion H√¥teli√®re Premium</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome 6 (derni√®re version) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- DataTables -->
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <!-- FullCalendar -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <!-- FullCalendar -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js"></script>
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0d6efd;
            --primary-dark: #0b5ed7;
            --primary-light: #e7f1ff;
            --primary-soft: #cfe2ff;
            --secondary: #6c757d;
            --secondary-light: #e9ecef;
            --success: #198754;
            --success-light: #d1e7dd;
            --success-soft: #c3e6cb;
            --info: #0dcaf0;
            --info-light: #cff4fc;
            --info-soft: #b6effb;
            --warning: #ffc107;
            --warning-light: #fff3cd;
            --warning-soft: #ffe69c;
            --danger: #dc3545;
            --danger-light: #f8d7da;
            --danger-soft: #f1aeb5;
            --light: #f8f9fa;
            --dark: #212529;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --sidebar-width: 300px;
            --sidebar-width-mobile: 0px;
            --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            --shadow-xs: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
            --shadow-2xl: 0 25px 50px rgba(0,0,0,0.25);
            --shadow-inner: inset 0 2px 4px rgba(0,0,0,0.05);
            --gradient-primary: linear-gradient(145deg, var(--primary), var(--primary-dark));
            --gradient-success: linear-gradient(145deg, var(--success), #146c43);
            --gradient-warning: linear-gradient(145deg, var(--warning), #ffca2c);
            --gradient-danger: linear-gradient(145deg, var(--danger), #bb2d3b);
            --gradient-info: linear-gradient(145deg, var(--info), #3dd5f3);
            --gradient-dark: linear-gradient(145deg, var(--dark), #1a1e21);
            --gradient-light: linear-gradient(145deg, #ffffff, var(--light));
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #f6f9fc 0%, #edf2f7 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--gray-800);
        }

        /* Accessibilit√© - Focus visible premium */
        :focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 3px;
            border-radius: 8px;
            box-shadow: 0 0 0 6px rgba(13, 110, 253, 0.25);
        }

        /* Skip link am√©lior√© */
        .skip-link {
            position: absolute;
            top: -60px;
            left: 0;
            background: var(--gradient-primary);
            color: white;
            padding: 14px 18px;
            z-index: 10000;
            text-decoration: none;
            border-radius: 0 0 12px 0;
            font-weight: 600;
            transition: top 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        .skip-link:focus {
            top: 0;
        }

        /* Login Page Premium */
        .login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient-primary);
            padding: 1rem;
            position: relative;
            overflow: hidden;
        }

        .login-page::before {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
                        repeating-linear-gradient(45deg, rgba(255,255,255,0.03) 0px, rgba(255,255,255,0.03) 20px, transparent 20px, transparent 40px);
            animation: rotate 40s linear infinite;
        }

        .login-page::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="rgba(255,255,255,0.05)" fill-opacity="1" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,154.7C960,171,1056,181,1152,170.7C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') bottom center no-repeat;
            background-size: cover;
            opacity: 0.1;
            pointer-events: none;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .login-container {
            max-width: 480px;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 32px;
            padding: 3rem;
            box-shadow: var(--shadow-2xl);
            margin: 1rem;
            position: relative;
            z-index: 1;
            animation: slideUpFade 0.6s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        @keyframes slideUpFade {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-logo {
            width: 120px;
            height: 120px;
            border-radius: 24px;
            margin-bottom: 1.5rem;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
        }

        .login-logo:hover {
            transform: scale(1.05) rotate(5deg);
            box-shadow: 0 30px 40px rgba(13,110,253,0.3);
        }

        .login-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }

        .login-header p {
            color: var(--gray-600);
            font-size: 1rem;
            font-weight: 500;
        }

        /* Formulaires Premium */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }

        .input-group {
            position: relative;
        }

        .input-group i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            z-index: 10;
            font-size: 1.2rem;
            transition: var(--transition);
        }

        .form-control {
            width: 100%;
            padding: 1rem 1rem 1rem 3.2rem;
            border: 2px solid var(--gray-200);
            border-radius: 16px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            font-weight: 500;
        }

        .form-control:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(13,110,253,0.15);
            background: white;
        }

        .input-group:focus-within i {
            color: var(--primary-dark);
            transform: translateY(-50%) scale(1.1);
        }

        /* Boutons Premium */
        .btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            width: 100%;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(13,110,253,0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(13,110,253,0.5);
        }

        .btn-primary:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
            box-shadow: 0 4px 15px rgba(25,135,84,0.4);
        }

        .btn-warning {
            background: var(--gradient-warning);
            color: var(--dark);
            box-shadow: 0 4px 15px rgba(255,193,7,0.4);
        }

        .btn-danger {
            background: var(--gradient-danger);
            color: white;
            box-shadow: 0 4px 15px rgba(220,53,69,0.4);
        }

        .btn-info {
            background: var(--gradient-info);
            color: var(--dark);
            box-shadow: 0 4px 15px rgba(13,202,240,0.4);
        }

        .btn-outline-primary {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline-primary:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
            border-radius: 12px;
        }

        /* Alertes Premium */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            display: none;
            animation: slideInAlert 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border: none;
            font-weight: 500;
            box-shadow: var(--shadow-md);
        }

        .alert-danger {
            background: linear-gradient(145deg, #fee, #fdd);
            color: var(--danger);
            border-left: 6px solid var(--danger);
        }

        .alert-success {
            background: linear-gradient(145deg, #dfd, #cfc);
            color: var(--success);
            border-left: 6px solid var(--success);
        }

        @keyframes slideInAlert {
            0% {
                opacity: 0;
                transform: translateY(-20px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Demo credentials Premium */
        .demo-credentials {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(145deg, var(--gray-100), var(--gray-200));
            border-radius: 20px;
            font-size: 0.95rem;
            border: 1px solid rgba(13,110,253,0.2);
            box-shadow: var(--shadow-md);
        }

        .demo-credentials p {
            margin: 0.5rem 0;
            color: var(--gray-700);
        }

        .demo-credentials strong {
            color: var(--primary);
            font-weight: 800;
            background: white;
            padding: 0.2rem 0.5rem;
            border-radius: 8px;
        }

        /* Dashboard Premium */
        .dashboard {
            display: none;
            min-height: 100vh;
            position: relative;
        }

        /* Menu toggle Premium */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1001;
            background: var(--gradient-primary);
            color: white;
            border: none;
            width: 56px;
            height: 56px;
            border-radius: 16px;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
            font-size: 1.5rem;
        }

        .menu-toggle:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: var(--shadow-2xl);
        }

        /* Sidebar Premium */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            box-shadow: 2px 0 30px rgba(0,0,0,0.08);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
            border-right: 1px solid rgba(13,110,253,0.1);
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 2px solid var(--primary-light);
            background: linear-gradient(145deg, white, var(--primary-light));
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .sidebar-logo-img {
            width: 60px;
            height: 60px;
            border-radius: 18px;
            object-fit: cover;
            box-shadow: var(--shadow-lg);
            border: 3px solid white;
        }

        .sidebar-logo-text h2 {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 0;
            line-height: 1.2;
            letter-spacing: -0.5px;
        }

        .sidebar-logo-text p {
            font-size: 0.8rem;
            color: var(--gray-600);
            margin: 0;
            font-weight: 600;
        }

        .sidebar-menu {
            padding: 2rem 0;
        }

        .menu-section {
            margin-bottom: 2rem;
        }

        .menu-title {
            padding: 0 1.5rem;
            margin-bottom: 1rem;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--gray-500);
            font-weight: 800;
        }

        .menu-item {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--gray-700);
            transition: var(--transition);
            cursor: pointer;
            margin: 0.25rem 1rem;
            border-radius: 14px;
            border: none;
            background: none;
            width: calc(100% - 2rem);
            text-align: left;
            font-size: 1rem;
            font-weight: 600;
            position: relative;
        }

        .menu-item i {
            width: 24px;
            font-size: 1.3rem;
            color: var(--primary);
            transition: var(--transition);
        }

        .menu-item:hover {
            background: var(--primary-light);
            color: var(--primary);
            transform: translateX(5px);
            box-shadow: var(--shadow-md);
        }

        .menu-item:hover i {
            transform: scale(1.2) rotate(5deg);
            color: var(--primary-dark);
        }

        .menu-item.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .menu-item.active i {
            color: white;
        }

        .menu-item .badge {
            margin-left: auto;
            background: var(--warning);
            color: var(--dark);
            font-size: 0.7rem;
            padding: 0.3rem 0.6rem;
            border-radius: 30px;
            font-weight: 700;
            box-shadow: var(--shadow-sm);
        }

        /* Main Content Premium */
        .main {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
            transition: var(--transition);
        }

        /* Top Bar Premium */
        .top-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            border: 1px solid rgba(255,255,255,0.5);
            position: relative;
            overflow: hidden;
        }

        .top-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0;
            letter-spacing: -0.5px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .date-display {
            background: var(--primary-light);
            padding: 0.6rem 1.5rem;
            border-radius: 40px;
            font-size: 1rem;
            color: var(--primary);
            font-weight: 700;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .date-display i {
            font-size: 1.1rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-role {
            background: var(--gradient-light);
            padding: 0.6rem 1.5rem;
            border-radius: 40px;
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary);
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid var(--primary-light);
        }

        .user-avatar {
            width: 52px;
            height: 52px;
            border-radius: 18px;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            cursor: pointer;
            border: none;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
        }

        .user-avatar:hover {
            transform: scale(1.1) rotate(10deg);
            background: var(--gradient-danger);
        }

        /* Stats Cards Premium */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 1.8rem;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
            border: 1px solid rgba(255,255,255,0.5);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-2xl);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.2rem;
        }

        .stat-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            transition: var(--transition);
            box-shadow: var(--shadow-md);
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .stat-icon.primary {
            background: linear-gradient(145deg, var(--primary-light), #fff);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .stat-icon.success {
            background: linear-gradient(145deg, var(--success-light), #fff);
            color: var(--success);
            border: 2px solid var(--success);
        }

        .stat-icon.warning {
            background: linear-gradient(145deg, var(--warning-light), #fff);
            color: #856404;
            border: 2px solid var(--warning);
        }

        .stat-icon.danger {
            background: linear-gradient(145deg, var(--danger-light), #fff);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .stat-icon.info {
            background: linear-gradient(145deg, var(--info-light), #fff);
            color: #055160;
            border: 2px solid var(--info);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--gray-900);
            line-height: 1.2;
        }

        .stat-label {
            color: var(--gray-600);
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            margin-top: 1rem;
            padding: 0.4rem 1rem;
            background: var(--gray-100);
            border-radius: 30px;
            width: fit-content;
            font-weight: 600;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        /* Charts Premium */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 1.8rem;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255,255,255,0.5);
            transition: var(--transition);
        }

        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-2xl);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--gray-800);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-header i {
            color: var(--primary);
            font-size: 1.3rem;
        }

        /* Room Grid Premium */
        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .room-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.5rem;
            border-left: 6px solid;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            width: 100%;
            text-align: left;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .room-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at top right, rgba(255,255,255,0.8), transparent);
            opacity: 0;
            transition: var(--transition);
        }

        .room-card:hover::after {
            opacity: 1;
        }

        .room-card.available { 
            border-left-color: var(--success);
            background: linear-gradient(145deg, white, var(--success-light));
        }
        .room-card.occupied { 
            border-left-color: var(--primary);
            background: linear-gradient(145deg, white, var(--primary-light));
        }
        .room-card.reserved { 
            border-left-color: var(--warning);
            background: linear-gradient(145deg, white, var(--warning-light));
        }
        .room-card.maintenance { 
            border-left-color: var(--danger);
            background: linear-gradient(145deg, white, var(--danger-light));
        }

        .room-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-2xl);
        }

        .room-number {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--gray-900);
        }

        .room-type {
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 600;
        }

        .room-price {
            font-weight: 800;
            color: var(--primary);
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        /* Tables Premium */
        .table-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 1.8rem;
            box-shadow: var(--shadow-xl);
            margin-bottom: 2rem;
            border: 1px solid rgba(255,255,255,0.5);
            transition: var(--transition);
        }

        .table-card:hover {
            box-shadow: var(--shadow-2xl);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .table-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--gray-800);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 8px;
            min-width: 600px;
        }

        .table th {
            text-align: left;
            padding: 1rem;
            background: var(--primary-light);
            color: var(--primary);
            font-weight: 700;
            font-size: 0.95rem;
            border-radius: 12px 12px 0 0;
        }

        .table td {
            padding: 1.2rem 1rem;
            background: white;
            border-bottom: 1px solid var(--gray-200);
            color: var(--gray-800);
            font-weight: 500;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
        }

        .table tbody tr {
            transition: var(--transition);
        }

        .table tbody tr:hover td {
            background: var(--primary-light);
            transform: scale(1.01);
            box-shadow: var(--shadow-md);
        }

        /* Badges Premium */
        .badge {
            padding: 0.4rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 700;
            display: inline-block;
            letter-spacing: 0.3px;
            box-shadow: var(--shadow-sm);
        }

        .badge-success {
            background: linear-gradient(145deg, var(--success-light), var(--success-soft));
            color: var(--success);
            border: 1px solid var(--success);
        }

        .badge-warning {
            background: linear-gradient(145deg, var(--warning-light), var(--warning-soft));
            color: #856404;
            border: 1px solid var(--warning);
        }

        .badge-danger {
            background: linear-gradient(145deg, var(--danger-light), var(--danger-soft));
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .badge-info {
            background: linear-gradient(145deg, var(--info-light), var(--info-soft));
            color: #055160;
            border: 1px solid var(--info);
        }

        .badge-primary {
            background: linear-gradient(145deg, var(--primary-light), var(--primary-soft));
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        /* Kitchen Orders Premium */
        .kitchen-orders {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .kitchen-card {
            background: linear-gradient(145deg, white, var(--gray-100));
            border-radius: 20px;
            padding: 1.5rem;
            border-left: 6px solid var(--warning);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .kitchen-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50px;
            height: 50px;
            background: var(--warning);
            opacity: 0.1;
            border-radius: 0 0 0 50px;
        }

        .kitchen-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .kitchen-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
        }

        .table-number {
            font-weight: 800;
            color: var(--primary);
            font-size: 1.2rem;
            background: var(--primary-light);
            padding: 0.3rem 1rem;
            border-radius: 30px;
        }

        .timer {
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 600;
            background: white;
            padding: 0.3rem 1rem;
            border-radius: 30px;
            box-shadow: var(--shadow-sm);
        }

        .kitchen-items {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

        .kitchen-items li {
            font-size: 0.95rem;
            padding: 0.6rem 0;
            border-bottom: 1px dashed var(--gray-300);
            font-weight: 500;
        }

        /* Notifications Premium */
        .notification-center {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 9999;
            max-width: 400px;
            width: calc(100% - 3rem);
        }

        .notification {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.2rem 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-2xl);
            border-left: 6px solid;
            animation: slideInNotification 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            word-break: break-word;
            border: 1px solid rgba(255,255,255,0.2);
            font-weight: 600;
        }

        @keyframes slideInNotification {
            0% {
                transform: translateX(100%) scale(0.5) rotate(10deg);
                opacity: 0;
            }
            100% {
                transform: translateX(0) scale(1) rotate(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            0% {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateX(100%) scale(0.5);
                opacity: 0;
            }
        }

        /* Modal Premium */
        .modal-content {
            border-radius: 28px;
            border: none;
            box-shadow: var(--shadow-2xl);
            overflow: hidden;
        }

        .modal-header {
            background: var(--gradient-primary);
            color: white;
            border-radius: 28px 28px 0 0;
            padding: 1.8rem 2rem;
            border: none;
        }

        .modal-header .modal-title {
            font-weight: 800;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .modal-header .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
            transition: var(--transition);
        }

        .modal-header .btn-close:hover {
            opacity: 1;
            transform: rotate(90deg) scale(1.2);
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 2px solid var(--gray-200);
        }

        /* Loading Overlay Premium */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.98);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 6px solid var(--primary-light);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Invoice Preview Premium */
        .invoice-preview {
            background: white;
            padding: 3rem;
            max-width: 1000px;
            margin: 0 auto;
            font-family: 'Plus Jakarta Sans', sans-serif;
            border-radius: 28px;
            box-shadow: var(--shadow-2xl);
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 2.5rem;
            border-bottom: 4px dashed var(--primary);
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .invoice-logo {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 24px;
            box-shadow: var(--shadow-xl);
        }

        .invoice-title {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: -2px;
        }

        /* Tooltips Premium */
        [data-tooltip] {
            position: relative;
            cursor: help;
        }

        [data-tooltip]:before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            padding: 0.6rem 1.2rem;
            background: var(--gradient-dark);
            color: white;
            border-radius: 12px;
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            font-weight: 600;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(255,255,255,0.2);
        }

        [data-tooltip]:hover:before {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-15px);
        }

        [data-tooltip]:after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-2px);
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark) transparent transparent transparent;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        [data-tooltip]:hover:after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-7px);
        }

        /* Scrollbar Premium */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 20px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-primary);
            border-radius: 20px;
            border: 2px solid var(--gray-100);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gradient-dark);
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }

        /* Responsive Premium */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 280px;
            }
            .main {
                margin-left: 280px;
            }
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }

            .sidebar {
                transform: translateX(-100%);
                width: 280px;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main {
                margin-left: 0;
                padding: 1rem;
                padding-top: 5rem;
            }

            .top-bar {
                flex-direction: column;
                align-items: flex-start;
                padding: 1.5rem;
            }

            .user-profile {
                width: 100%;
                justify-content: space-between;
            }

            .page-title {
                font-size: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .room-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .table-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .table-header .btn {
                width: 100%;
            }

            .modal-dialog {
                margin: 0.5rem;
            }

            .invoice-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .invoice-title {
                font-size: 2.2rem;
            }
        }

        @media (max-width: 576px) {
            .room-grid {
                grid-template-columns: 1fr;
            }

            .stat-card {
                padding: 1.5rem;
            }

            .stat-value {
                font-size: 2rem;
            }

            .btn-sm {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }

            .login-container {
                padding: 2rem;
            }

            .login-header h1 {
                font-size: 1.8rem;
            }

            .login-logo {
                width: 100px;
                height: 100px;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .chart-card {
                padding: 1.2rem;
            }
        }

        /* Print Styles */
        @media print {
            .sidebar, .top-bar, .menu-toggle, .btn, .modal-footer {
                display: none !important;
            }
            .main {
                margin: 0;
                padding: 0;
            }
            .invoice-preview {
                box-shadow: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Aller au contenu principal</a>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="login-page">
        <div class="login-container" role="main" aria-labelledby="login-title" data-aos="fade-up" data-aos-duration="800">
            <div class="login-header">
                <img src="images/logo1.png" alt="Lawmar Logo" class="login-logo" onerror="this.src='https://via.placeholder.com/120x120/0d6efd/ffffff?text=LAW'">
                <h1 id="login-title">Lawmar PMS</h1>
                <p>Les R√©sidences du Lawmar - Gandiol üá∏üá≥</p>
            </div>

            <div id="loginAlert" class="alert alert-danger" role="alert" aria-live="polite">
                <i class="fas fa-exclamation-circle me-2" aria-hidden="true"></i>
                <span id="alertMessage"></span>
            </div>

            <form id="loginForm" class="login-form" aria-label="Formulaire de connexion">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user-circle me-2" aria-hidden="true"></i>
                        Nom d'utilisateur
                    </label>
                    <div class="input-group">
                        <i class="fas fa-user" aria-hidden="true"></i>
                        <input type="text" class="form-control" id="username" placeholder="Entrez votre nom d'utilisateur" required autofocus aria-required="true">
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock me-2" aria-hidden="true"></i>
                        Mot de passe
                    </label>
                    <div class="input-group">
                        <i class="fas fa-lock" aria-hidden="true"></i>
                        <input type="password" class="form-control" id="password" placeholder="Entrez votre mot de passe" required aria-required="true">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary" id="loginBtn">
                    <span class="spinner" style="display: none;" aria-hidden="true"><i class="fas fa-spinner fa-spin"></i></span>
                    <span class="btn-text">Se connecter</span>
                    <i class="fas fa-arrow-right" aria-hidden="true"></i>
                </button>
            </form>

            <div class="demo-credentials" aria-label="Comptes de d√©monstration" data-aos="fade-up" data-aos-delay="200">
                <p><i class="fas fa-info-circle me-2" style="color: var(--primary);"></i><strong>Comptes de d√©monstration :</strong></p>
                <p><i class="fas fa-crown me-2" style="color: #ffc107;"></i> <strong>admin</strong> / <strong>admin123</strong> (Manager)</p>
                <p><i class="fas fa-bell-concierge me-2" style="color: #0d6efd;"></i> <strong>reception</strong> / <strong>reception123</strong> (R√©ception)</p>
                <p><i class="fas fa-utensils me-2" style="color: #198754;"></i> <strong>restaurant</strong> / <strong>restaurant123</strong> (Restaurant)</p>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard" role="application" aria-label="Tableau de bord">
        <!-- Menu Toggle pour mobile -->
        <button class="menu-toggle" id="menuToggle" onclick="toggleSidebar()" aria-label="Ouvrir le menu">
            <i class="fas fa-bars" aria-hidden="true"></i>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" aria-label="Menu principal">
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo" onclick="loadModule('dashboard'); return false;">
                    <img src="images/logo1.png" alt="Lawmar" class="sidebar-logo-img" onerror="this.src='https://via.placeholder.com/60x60/0d6efd/ffffff?text=LAW'">
                    <div class="sidebar-logo-text">
                        <h2>LAWMAR PMS</h2>
                        <p>Les R√©sidences du Lawmar</p>
                    </div>
                </a>
            </div>

            <nav class="sidebar-menu" aria-label="Navigation">
                <div class="menu-section">
                    <div class="menu-title">PRINCIPAL</div>
                    <button class="menu-item active" onclick="loadModule('dashboard')" data-module="dashboard" aria-current="page">
                        <i class="fas fa-chart-pie" aria-hidden="true"></i>
                        <span>Dashboard</span>
                        <span class="badge" id="dashboard-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('calendar')" data-module="calendar">
                        <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                        <span>Calendrier</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('bookings')" data-module="bookings">
                        <i class="fas fa-hotel" aria-hidden="true"></i>
                        <span>R√©servations</span>
                        <span class="badge" id="bookings-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('orders')" data-module="orders">
                        <i class="fas fa-utensils" aria-hidden="true"></i>
                        <span>Commandes</span>
                        <span class="badge" id="orders-badge">0</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('rooms')" data-module="rooms">
                        <i class="fas fa-door-open" aria-hidden="true"></i>
                        <span>Chambres</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">GESTION</div>
                    <button class="menu-item" onclick="loadModule('guests')" data-module="guests">
                        <i class="fas fa-users" aria-hidden="true"></i>
                        <span>Clients</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('stock')" data-module="stock">
                        <i class="fas fa-boxes" aria-hidden="true"></i>
                        <span>Stocks</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('staff')" data-module="staff">
                        <i class="fas fa-users-cog" aria-hidden="true"></i>
                        <span>Personnel</span>
                    </button>
                </div>

                <div class="menu-section">
                    <div class="menu-title">FINANCES</div>
                    <button class="menu-item" onclick="loadModule('invoices')" data-module="invoices">
                        <i class="fas fa-file-invoice" aria-hidden="true"></i>
                        <span>Factures</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('reports')" data-module="reports">
                        <i class="fas fa-chart-line" aria-hidden="true"></i>
                        <span>Rapports</span>
                    </button>
                    <button class="menu-item" onclick="loadModule('expenses')" data-module="expenses">
                        <i class="fas fa-coins" aria-hidden="true"></i>
                        <span>D√©penses</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main" id="main-content">
            <!-- Top Bar -->
            <header class="top-bar" role="banner" data-aos="fade-down">
                <h1 class="page-title" id="page-title">Tableau de bord</h1>

                <div class="date-display" aria-live="polite">
                    <i class="fas fa-calendar-day" aria-hidden="true"></i>
                    <span id="current-date"></span>
                </div>

                <div class="user-profile">
                    <div class="user-role" id="user-role">
                        <i class="fas fa-user-tie" aria-hidden="true"></i>
                        <span id="userRoleDisplay">Manager</span>
                    </div>
                    <button class="user-avatar" onclick="logout()" title="D√©connexion" aria-label="Se d√©connecter" data-tooltip="Se d√©connecter">
                        <span id="userInitials">AD</span>
                    </button>
                </div>
            </header>

            <!-- Dynamic Content -->
            <div id="dashboard-content" role="region" aria-label="Contenu du tableau de bord">
                <!-- Le contenu est charg√© dynamiquement -->
            </div>
        </main>
    </div>

    <!-- Notification Center -->
    <div class="notification-center" id="notification-center" role="status" aria-live="polite"></div>

    <!-- Modals (conserv√©s avec ic√¥nes am√©lior√©es) -->
    <!-- Reservation Modal -->
    <div class="modal fade" id="reservationModal" tabindex="-1" aria-labelledby="reservationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reservationModalLabel">
                        <i class="fas fa-calendar-plus me-2" aria-hidden="true"></i>
                        Nouvelle r√©servation
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="reservationForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestName" class="form-label"><i class="fas fa-user me-2"></i>Nom du client</label>
                                <input type="text" class="form-control" id="guestName" required placeholder="Ex: Jean Dupont">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="guestPhone" class="form-label"><i class="fas fa-phone me-2"></i>T√©l√©phone</label>
                                <input type="tel" class="form-control" id="guestPhone" required placeholder="+221 77 123 45 67">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="guestEmail" class="form-label"><i class="fas fa-envelope me-2"></i>Email</label>
                                <input type="email" class="form-control" id="guestEmail" placeholder="client@exemple.com">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomSelect" class="form-label"><i class="fas fa-door-open me-2"></i>Chambre</label>
                                <select class="form-control" id="roomSelect" required>
                                    <option value="">S√©lectionner une chambre</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="checkinDate" class="form-label"><i class="fas fa-calendar-check me-2"></i>Date d'arriv√©e</label>
                                <input type="date" class="form-control" id="checkinDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="checkoutDate" class="form-label"><i class="fas fa-calendar-times me-2"></i>Date de d√©part</label>
                                <input type="date" class="form-control" id="checkoutDate" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="adults" class="form-label"><i class="fas fa-user-friends me-2"></i>Adultes</label>
                                <input type="number" class="form-control" id="adults" value="1" min="1">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="children" class="form-label"><i class="fas fa-child me-2"></i>Enfants</label>
                                <input type="number" class="form-control" id="children" value="0" min="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="specialRequests" class="form-label"><i class="fas fa-comment me-2"></i>Pr√©f√©rences sp√©ciales</label>
                            <textarea class="form-control" id="specialRequests" rows="3" placeholder="Ex: Chambre calme, lit b√©b√©, vue piscine..."></textarea>
                        </div>
                        <div class="alert alert-info" role="status">
                            <i class="fas fa-calculator me-2"></i>
                            <strong>Total estim√©:</strong> <span id="estimatedTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="reservationForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Confirmer la r√©servation</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Modal -->
    <div class="modal fade" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderModalLabel">
                        <i class="fas fa-cart-plus me-2" aria-hidden="true"></i>
                        Nouvelle commande
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="orderForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="tableNumber" class="form-label"><i class="fas fa-chair me-2"></i>Num√©ro de table</label>
                                <input type="number" class="form-control" id="tableNumber" required placeholder="Ex: 5">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="orderGuestName" class="form-label"><i class="fas fa-user me-2"></i>Nom du client (optionnel)</label>
                                <input type="text" class="form-control" id="orderGuestName" placeholder="Ex: Marie Diouf">
                            </div>
                        </div>

                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="chargeToRoom">
                                <label class="form-check-label" for="chargeToRoom">
                                    <i class="fas fa-hotel me-2"></i>Imputer √† une chambre
                                </label>
                            </div>
                        </div>

                        <div class="mb-3" id="roomSelectionDiv" style="display: none;">
                            <label for="chargeRoomSelect" class="form-label"><i class="fas fa-door-open me-2"></i>S√©lectionner la chambre</label>
                            <select class="form-control" id="chargeRoomSelect">
                                <option value="">Choisir une chambre</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label"><i class="fas fa-utensils me-2"></i>Articles command√©s</label>
                            <div id="orderItems">
                                <div class="row mb-2 order-item">
                                    <div class="col-md-6">
                                        <select class="form-control item-select">
                                            <option value="">S√©lectionner un article</option>
                                            <option value="Thieboudienne" data-price="12500">ü•ò Thieboudienne - 12 500 XOF</option>
                                            <option value="Yassa Poulet" data-price="11000">üçó Yassa Poulet - 11 000 XOF</option>
                                            <option value="Maf√© d'agneau" data-price="12000">ü•© Maf√© d'agneau - 12 000 XOF</option>
                                            <option value="Poulet DG" data-price="13800">üçõ Poulet DG - 13 800 XOF</option>
                                            <option value="Pastels" data-price="8000">ü•ü Pastels - 8 000 XOF</option>
                                            <option value="Filet de Capitaine" data-price="14500">üêü Filet de Capitaine - 14 500 XOF</option>
                                            <option value="Jus de bissap" data-price="3500">üßÉ Jus de bissap - 3 500 XOF</option>
                                            <option value="Jus de gingembre" data-price="3500">üßÉ Jus de gingembre - 3 500 XOF</option>
                                            <option value="Jus de bouye" data-price="4000">üßÉ Jus de bouye - 4 000 XOF</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="number" class="form-control item-qty" value="1" min="1">
                                    </div>
                                    <div class="col-md-2">
                                        <span class="item-price-display">12 500</span> XOF
                                    </div>
                                    <div class="col-md-1">
                                        <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article" data-tooltip="Supprimer">
                                            <i class="fas fa-trash" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-primary btn-sm mt-2" onclick="addOrderItem()">
                                <i class="fas fa-plus me-2"></i>Ajouter un article
                            </button>
                        </div>

                        <div class="alert alert-info" role="status">
                            <i class="fas fa-calculator me-2"></i>
                            <strong>Total commande:</strong> <span id="orderTotal">0</span> XOF
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="orderForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Valider la commande</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div class="modal fade" id="invoiceModal" tabindex="-1" aria-labelledby="invoiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="invoiceModalLabel">
                        <i class="fas fa-file-invoice-dollar me-2" aria-hidden="true"></i>
                        Facture
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body" id="invoiceContent">
                    <!-- Le contenu de la facture est g√©n√©r√© dynamiquement -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Fermer</button>
                    <button type="button" class="btn btn-primary" onclick="downloadInvoicePDF()">
                        <i class="fas fa-file-pdf me-2" aria-hidden="true"></i> T√©l√©charger PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Guest Modal -->
    <div class="modal fade" id="guestModal" tabindex="-1" aria-labelledby="guestModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="guestModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouveau client
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="guestForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestName" class="form-label"><i class="fas fa-user me-2"></i>Nom complet</label>
                                <input type="text" class="form-control" id="newGuestName" required placeholder="Ex: Marie Diouf">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestEmail" class="form-label"><i class="fas fa-envelope me-2"></i>Email</label>
                                <input type="email" class="form-control" id="newGuestEmail" required placeholder="client@exemple.com">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPhone" class="form-label"><i class="fas fa-phone me-2"></i>T√©l√©phone</label>
                                <input type="tel" class="form-control" id="newGuestPhone" required placeholder="+221 77 123 45 67">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="newGuestPreferences" class="form-label"><i class="fas fa-heart me-2"></i>Pr√©f√©rences</label>
                                <input type="text" class="form-control" id="newGuestPreferences" placeholder="Ex: Chambre calme, oreillers fermes">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="guestForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Ajouter client</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stock Modal -->
    <div class="modal fade" id="stockModal" tabindex="-1" aria-labelledby="stockModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="stockModalLabel">
                        <i class="fas fa-boxes me-2" aria-hidden="true"></i>
                        Nouvel article
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="stockForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockName" class="form-label"><i class="fas fa-tag me-2"></i>Nom de l'article</label>
                                <input type="text" class="form-control" id="stockName" required placeholder="Ex: Riz">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockCategory" class="form-label"><i class="fas fa-folder me-2"></i>Cat√©gorie</label>
                                <select class="form-control" id="stockCategory" required>
                                    <option value="√©picerie">üì¶ √âpicerie</option>
                                    <option value="poissonnerie">üêü Poissonnerie</option>
                                    <option value="viande">ü•© Viande</option>
                                    <option value="l√©gumes">ü•¨ L√©gumes</option>
                                    <option value="boissons">ü•§ Boissons</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="stockQuantity" class="form-label"><i class="fas fa-weight me-2"></i>Quantit√©</label>
                                <input type="number" class="form-control" id="stockQuantity" required placeholder="Ex: 25">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockUnit" class="form-label"><i class="fas fa-ruler me-2"></i>Unit√©</label>
                                <select class="form-control" id="stockUnit" required>
                                    <option value="kg">kg</option>
                                    <option value="L">L</option>
                                    <option value="pi√®ce">pi√®ce</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="stockThreshold" class="form-label"><i class="fas fa-exclamation-triangle me-2"></i>Seuil d'alerte</label>
                                <input type="number" class="form-control" id="stockThreshold" required placeholder="Ex: 10">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="stockExpiry" class="form-label"><i class="fas fa-calendar-times me-2"></i>Date d'expiration</label>
                                <input type="date" class="form-control" id="stockExpiry">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="stockSupplier" class="form-label"><i class="fas fa-truck me-2"></i>Fournisseur</label>
                                <input type="text" class="form-control" id="stockSupplier" required placeholder="Ex: March√© Gandiol">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="stockPrice" class="form-label"><i class="fas fa-coins me-2"></i>Prix unitaire (XOF)</label>
                            <input type="number" class="form-control" id="stockPrice" required placeholder="Ex: 650">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="stockForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Ajouter article</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Employee Modal -->
    <div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="employeeModalLabel">
                        <i class="fas fa-user-plus me-2" aria-hidden="true"></i>
                        Nouvel employ√©
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="employeeForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeName" class="form-label"><i class="fas fa-user me-2"></i>Nom complet</label>
                                <input type="text" class="form-control" id="employeeName" required placeholder="Ex: Oumar Diallo">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeRole" class="form-label"><i class="fas fa-briefcase me-2"></i>R√¥le</label>
                                <input type="text" class="form-control" id="employeeRole" required placeholder="Ex: Serveur">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeDepartment" class="form-label"><i class="fas fa-building me-2"></i>D√©partement</label>
                                <select class="form-control" id="employeeDepartment" required>
                                    <option value="restaurant">üçΩÔ∏è Restaurant</option>
                                    <option value="reception">üè® R√©ception</option>
                                    <option value="direction">üëî Direction</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeePhone" class="form-label"><i class="fas fa-phone me-2"></i>T√©l√©phone</label>
                                <input type="tel" class="form-control" id="employeePhone" required placeholder="+221 77 111 22 33">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="employeeEmail" class="form-label"><i class="fas fa-envelope me-2"></i>Email</label>
                                <input type="email" class="form-control" id="employeeEmail" required placeholder="employe@lawmar.sn">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="employeeSchedule" class="form-label"><i class="fas fa-clock me-2"></i>Planning</label>
                                <input type="text" class="form-control" id="employeeSchedule" placeholder="ex: Lun-Ven 8h-17h" required>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="employeeForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Ajouter employ√©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Expense Modal -->
    <div class="modal fade" id="expenseModal" tabindex="-1" aria-labelledby="expenseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="expenseModalLabel">
                        <i class="fas fa-coins me-2" aria-hidden="true"></i>
                        Nouvelle d√©pense
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="expenseForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseDate" class="form-label"><i class="fas fa-calendar me-2"></i>Date</label>
                                <input type="date" class="form-control" id="expenseDate" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseCategory" class="form-label"><i class="fas fa-folder me-2"></i>Cat√©gorie</label>
                                <select class="form-control" id="expenseCategory" required>
                                    <option value="√©lectricit√©">‚ö° √âlectricit√©</option>
                                    <option value="eau">üíß Eau</option>
                                    <option value="achats">üõí Achats</option>
                                    <option value="salaire">üí∞ Salaire</option>
                                    <option value="maintenance">üîß Maintenance</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="expenseDescription" class="form-label"><i class="fas fa-pen me-2"></i>Description</label>
                            <input type="text" class="form-control" id="expenseDescription" required placeholder="Ex: Facture Senelec">
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="expenseAmount" class="form-label"><i class="fas fa-coins me-2"></i>Montant (XOF)</label>
                                <input type="number" class="form-control" id="expenseAmount" required placeholder="Ex: 85000">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="expenseDueDate" class="form-label"><i class="fas fa-calendar-times me-2"></i>Date d'√©ch√©ance</label>
                                <input type="date" class="form-control" id="expenseDueDate" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="expensePaid">
                                <label class="form-check-label" for="expensePaid">
                                    <i class="fas fa-check-circle me-2" style="color: var(--success);"></i>D√©j√† pay√©e
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="expenseForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Ajouter d√©pense</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Room Modal -->
    <div class="modal fade" id="roomModal" tabindex="-1" aria-labelledby="roomModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="roomModalLabel">
                        <i class="fas fa-door-open me-2" aria-hidden="true"></i>
                        Nouvelle chambre
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <form id="roomForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="roomNumber" class="form-label"><i class="fas fa-hashtag me-2"></i>Num√©ro de chambre</label>
                                <input type="number" class="form-control" id="roomNumber" required placeholder="Ex: 101">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="roomType" class="form-label"><i class="fas fa-tag me-2"></i>Type</label>
                                <select class="form-control" id="roomType" required>
                                    <option value="Standard">üè® Standard</option>
                                    <option value="Deluxe">‚ú® Deluxe</option>
                                    <option value="Prestige">üëë Prestige</option>
                                    <option value="Royale">üè∞ Royale</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="roomPrice" class="form-label"><i class="fas fa-coins me-2"></i>Prix par nuit (XOF)</label>
                            <input type="number" class="form-control" id="roomPrice" required placeholder="Ex: 65000">
                        </div>
                        <div class="mb-3">
                            <label for="roomStatus" class="form-label"><i class="fas fa-info-circle me-2"></i>Statut initial</label>
                            <select class="form-control" id="roomStatus" required>
                                <option value="available">‚úÖ Disponible</option>
                                <option value="maintenance">üîß Maintenance</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fas fa-times me-2"></i>Annuler</button>
                    <button type="submit" form="roomForm" class="btn btn-primary"><i class="fas fa-check me-2"></i>Ajouter chambre</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialisation AOS
        AOS.init({
            duration: 800,
            once: true,
            offset: 100
        });

        // ============================================
        // DONN√âES DE L'APPLICATION
        // ============================================

        // Utilisateurs de d√©monstration
        const users = [
            { username: 'admin', password: 'admin123', role: 'manager', name: 'Admin' },
            { username: 'reception', password: 'reception123', role: 'reception', name: 'R√©ceptionniste' },
            { username: 'restaurant', password: 'restaurant123', role: 'restaurant', name: 'Restaurateur' }
        ];

        // Donn√©es de l'application
        let appData = {
            bookings: [
                { id: 'BK001', guest: 'Marie Diouf', room: 'Suite Prestige', roomNumber: 301, checkin: '2026-02-20', checkout: '2026-02-25', adults: 2, children: 1, status: 'confirmed', total: 750000, phone: '+221 77 123 45 67', email: 'marie.diouf@gmail.com', prepaid: 225000, specialRequests: 'Chambre calme' },
                { id: 'BK002', guest: 'Pierre Martin', room: 'Chambre Deluxe', roomNumber: 201, checkin: '2026-02-18', checkout: '2026-02-22', adults: 2, children: 0, status: 'checked-in', total: 380000, phone: '+221 78 234 56 78', email: 'pierre.martin@yahoo.fr', prepaid: 114000, specialRequests: '' },
                { id: 'BK003', guest: 'Aminata Ba', room: 'Chambre Standard', roomNumber: 102, checkin: '2026-02-15', checkout: '2026-02-19', adults: 1, children: 0, status: 'checked-out', total: 260000, phone: '+221 76 345 67 89', email: 'aminata.ba@gmail.com', prepaid: 78000, specialRequests: 'Vue piscine' },
                { id: 'BK004', guest: 'Jean Dupont', room: 'Suite Royale', roomNumber: 401, checkin: '2026-02-22', checkout: '2026-02-28', adults: 2, children: 2, status: 'confirmed', total: 2700000, phone: '+221 77 456 78 90', email: 'jean.dupont@orange.fr', prepaid: 540000, specialRequests: 'Lit b√©b√©' },
                { id: 'BK005', guest: 'Fatou Ndiaye', room: 'Chambre Deluxe', roomNumber: 202, checkin: '2026-02-19', checkout: '2026-02-23', adults: 2, children: 1, status: 'checked-in', total: 380000, phone: '+221 77 567 89 01', email: 'fatou.ndiaye@gmail.com', prepaid: 114000, specialRequests: '' },
                { id: 'BK006', guest: 'Omar Sy', room: 'Suite Prestige', roomNumber: 302, checkin: '2026-02-21', checkout: '2026-02-24', adults: 2, children: 0, status: 'confirmed', total: 450000, phone: '+221 77 678 90 12', email: 'omar.sy@icloud.com', prepaid: 135000, specialRequests: 'D√©jeuner inclus' },
                { id: 'BK007', guest: 'Sophie Diallo', room: 'Chambre Standard', roomNumber: 101, checkin: '2026-02-23', checkout: '2026-02-27', adults: 2, children: 1, status: 'pending', total: 260000, phone: '+221 78 789 01 23', email: 'sophie.diallo@gmail.com', prepaid: 0, specialRequests: '' }
            ],

            restaurantOrders: [
                { id: 'R001', table: 5, guest: 'Marie Diouf', items: [{ name: 'Thieboudienne', qty: 2, price: 12500 }, { name: 'Jus de bissap', qty: 2, price: 3500 }], total: 32000, status: 'paid', roomCharge: true, roomNumber: 301, roomId: 'BK001', time: '12:30', date: '2026-02-20' },
                { id: 'R002', table: 3, guest: 'Pierre Martin', items: [{ name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Pastels', qty: 1, price: 8000 }], total: 19000, status: 'pending', roomCharge: false, roomId: null, time: '19:15', date: '2026-02-20' },
                { id: 'R003', table: 2, guest: 'Aminata Ba', items: [{ name: 'Maf√© d\'agneau', qty: 1, price: 12000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 15500, status: 'preparing', roomCharge: false, roomId: null, time: '20:00', date: '2026-02-20' },
                { id: 'R004', table: 8, guest: 'Jean Dupont', items: [{ name: 'Filet de Capitaine', qty: 2, price: 14500 }, { name: 'Accra', qty: 1, price: 6500 }], total: 35500, status: 'paid', roomCharge: true, roomNumber: 401, roomId: 'BK004', time: '13:15', date: '2026-02-20' },
                { id: 'R005', table: 1, guest: 'Fatou Ndiaye', items: [{ name: 'Poulet DG', qty: 1, price: 13800 }, { name: 'Jus de bouye', qty: 1, price: 4000 }], total: 17800, status: 'preparing', roomCharge: false, roomId: null, time: '19:45', date: '2026-02-20' },
                { id: 'R006', table: 4, guest: 'Omar Sy', items: [{ name: 'Thieboudienne', qty: 1, price: 12500 }, { name: 'Yassa Poulet', qty: 1, price: 11000 }, { name: 'Bissap', qty: 2, price: 3500 }], total: 30500, status: 'paid', roomCharge: false, roomId: null, time: '20:30', date: '2026-02-20' },
                { id: 'R007', table: 6, guest: 'Sophie Diallo', items: [{ name: 'Pastels', qty: 2, price: 8000 }, { name: 'Jus de gingembre', qty: 1, price: 3500 }], total: 19500, status: 'pending', roomCharge: false, roomId: null, time: '12:45', date: '2026-02-20' }
            ],

            guests: [
                { id: 'G001', name: 'Marie Diouf', email: 'marie.diouf@gmail.com', phone: '+221 77 123 45 67', stays: 3, preferences: 'Chambre calme, oreillers fermes', totalSpent: 1850000, lastStay: '2026-02-20' },
                { id: 'G002', name: 'Pierre Martin', email: 'pierre.martin@yahoo.fr', phone: '+221 78 234 56 78', stays: 1, preferences: 'Petit-d√©jeuner continental', totalSpent: 380000, lastStay: '2026-02-18' },
                { id: 'G003', name: 'Aminata Ba', email: 'aminata.ba@gmail.com', phone: '+221 76 345 67 89', stays: 2, preferences: 'Chambre vue piscine', totalSpent: 520000, lastStay: '2026-02-15' },
                { id: 'G004', name: 'Jean Dupont', email: 'jean.dupont@orange.fr', phone: '+221 77 456 78 90', stays: 1, preferences: 'Suite avec jacuzzi', totalSpent: 2700000, lastStay: '2026-02-22' },
                { id: 'G005', name: 'Fatou Ndiaye', email: 'fatou.ndiaye@gmail.com', phone: '+221 77 567 89 01', stays: 1, preferences: 'Chambre proche piscine', totalSpent: 380000, lastStay: '2026-02-19' }
            ],

            stock: [
                { id: 'S001', name: 'Riz', category: '√©picerie', quantity: 25, unit: 'kg', threshold: 10, expiry: '2026-04-01', supplier: 'March√© Gandiol', price: 650 },
                { id: 'S002', name: 'Poisson frais', category: 'poissonnerie', quantity: 5, unit: 'kg', threshold: 8, expiry: '2026-02-22', supplier: 'P√™cheurs Tassin√®re', price: 2500 },
                { id: 'S003', name: 'Poulet', category: 'viande', quantity: 8, unit: 'kg', threshold: 5, expiry: '2026-02-25', supplier: 'Ferme de Gandiol', price: 1800 },
                { id: 'S004', name: 'Oignons', category: 'l√©gumes', quantity: 12, unit: 'kg', threshold: 5, expiry: '2026-02-28', supplier: 'March√© Gandiol', price: 500 },
                { id: 'S005', name: 'Huile', category: '√©picerie', quantity: 15, unit: 'L', threshold: 5, expiry: '2026-05-01', supplier: 'Saint-Louis', price: 1200 }
            ],

            employees: [
                { id: 'E001', name: 'Oumar Diallo', role: 'serveur', department: 'restaurant', phone: '+221 77 111 22 33', schedule: 'Lun-Ven 8h-17h', email: 'oumar.diallo@lawmar.sn' },
                { id: 'E002', name: 'Fatou Ndiaye', role: 'r√©ceptionniste', department: 'reception', phone: '+221 77 444 55 66', schedule: 'Mar-Sam 14h-22h', email: 'fatou.ndiaye@lawmar.sn' },
                { id: 'E003', name: 'Moussa Sow', role: 'cuisinier', department: 'restaurant', phone: '+221 77 777 88 99', schedule: 'Lun-Dim 10h-19h', email: 'moussa.sow@lawmar.sn' },
                { id: 'E004', name: 'Aminata Fall', role: 'manager', department: 'direction', phone: '+221 77 999 00 11', schedule: 'Lun-Ven 9h-18h', email: 'aminata.fall@lawmar.sn' }
            ],

            expenses: [
                { id: 'EX001', date: '2026-02-15', category: '√©lectricit√©', amount: 85000, description: 'Facture Senelec', paid: true, dueDate: '2026-02-28' },
                { id: 'EX002', date: '2026-02-10', category: 'achats', amount: 125000, description: 'Approvisionnement restaurant', paid: true, dueDate: '2026-02-20' },
                { id: 'EX003', date: '2026-02-18', category: 'eau', amount: 35000, description: 'Facture SDE', paid: false, dueDate: '2026-03-05' },
                { id: 'EX004', date: '2026-02-20', category: 'salaire', amount: 450000, description: 'Salaires f√©vrier', paid: true, dueDate: '2026-02-28' }
            ],

            rooms: [
                { number: 101, type: 'Standard', price: 65000, status: 'available' },
                { number: 102, type: 'Standard', price: 65000, status: 'occupied', guest: 'Aminata Ba' },
                { number: 201, type: 'Deluxe', price: 95000, status: 'occupied', guest: 'Pierre Martin' },
                { number: 202, type: 'Deluxe', price: 95000, status: 'available' },
                { number: 301, type: 'Prestige', price: 150000, status: 'occupied', guest: 'Marie Diouf' },
                { number: 302, type: 'Prestige', price: 150000, status: 'available' },
                { number: 401, type: 'Royale', price: 450000, status: 'reserved', guest: 'Jean Dupont' }
            ],

            get stats() {
                const today = new Date().toISOString().split('T')[0];
                const totalRooms = this.rooms.length;
                const occupiedRooms = this.rooms.filter(r => r.status === 'occupied' || r.status === 'reserved').length;
                const occupancyRate = Math.round((occupiedRooms / totalRooms) * 100);
                const checkinsToday = this.bookings.filter(b => b.checkin === today).length;
                const checkoutsToday = this.bookings.filter(b => b.checkout === today).length;
                const hotelRevenue = this.bookings.reduce((sum, b) => sum + b.total, 0);
                const restaurantRevenue = this.restaurantOrders.reduce((sum, o) => sum + o.total, 0);
                const pendingOrders = this.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
                const lowStock = this.stock.filter(s => s.quantity <= s.threshold).length;

                return {
                    occupancyRate,
                    occupiedRooms,
                    totalRooms,
                    checkinsToday,
                    checkoutsToday,
                    hotelRevenue,
                    restaurantRevenue,
                    pendingOrders,
                    lowStock
                };
            }
        };

        // ============================================
        // GESTION DE LA CONNEXION
        // ============================================

        function checkAuth() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
            
            if (!isLoggedIn) {
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('dashboard').style.display = 'none';
                return false;
            } else {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'flex';
                return true;
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (checkAuth()) {
                initializeApp();
            }
        });

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const alertDiv = document.getElementById('loginAlert');
            const alertMessage = document.getElementById('alertMessage');
            const spinner = loginBtn.querySelector('.spinner');
            const btnText = loginBtn.querySelector('.btn-text');
            const overlay = document.getElementById('loadingOverlay');

            loginBtn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = 'Connexion...';
            overlay.style.display = 'flex';

            setTimeout(() => {
                const user = users.find(u => u.username === username && u.password === password);

                if (user) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    sessionStorage.setItem('userRole', user.role);
                    sessionStorage.setItem('userName', user.name);
                    sessionStorage.setItem('username', user.username);

                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'flex';

                    initializeApp();
                    showNotification(`Bienvenue ${user.name} !`, 'success');
                } else {
                    loginBtn.disabled = false;
                    spinner.style.display = 'none';
                    btnText.textContent = 'Se connecter';

                    alertMessage.textContent = 'Nom d\'utilisateur ou mot de passe incorrect';
                    alertDiv.style.display = 'block';

                    setTimeout(() => {
                        alertDiv.style.display = 'none';
                    }, 5000);
                }
                
                overlay.style.display = 'none';
            }, 1000);
        });

        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                sessionStorage.clear();
                window.location.reload();
            }
        }

        // ============================================
        // FONCTIONS PRINCIPALES
        // ============================================

        let currentModule = 'dashboard';
        let charts = {};
        let currentInvoice = null;
        let invoiceCounter = 1;

        function initializeApp() {
            updateDate();
            updateUserInfo();
            updateBadges();
            loadDashboard();
            setupForms();
            initEventListeners();
        }

        function updateDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('fr-FR', options);
        }

        function updateUserInfo() {
            const userName = sessionStorage.getItem('userName') || 'Utilisateur';
            const userRole = sessionStorage.getItem('userRole') || 'r√©ception';

            const roleLabels = {
                manager: 'Manager',
                reception: 'R√©ception',
                restaurant: 'Restaurant'
            };
            
            document.getElementById('userRoleDisplay').textContent = roleLabels[userRole] || 'Utilisateur';
            document.getElementById('userInitials').textContent = userName.charAt(0).toUpperCase();
        }

        function updateBadges() {
            document.getElementById('dashboard-badge').textContent = appData.stats.pendingOrders;
            document.getElementById('bookings-badge').textContent = appData.bookings.filter(b => b.status === 'pending').length;
            document.getElementById('orders-badge').textContent = appData.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').length;
        }

        function initEventListeners() {
            setInterval(() => {
                if (checkAuth()) {
                    refreshData();
                }
            }, 30000);

            document.getElementById('chargeToRoom')?.addEventListener('change', function(e) {
                document.getElementById('roomSelectionDiv').style.display = e.target.checked ? 'block' : 'none';
            });

            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('item-select') || e.target.classList.contains('item-qty')) {
                    calculateOrderTotal();
                }
            });

            document.getElementById('roomSelect')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkinDate')?.addEventListener('change', calculateEstimatedTotal);
            document.getElementById('checkoutDate')?.addEventListener('change', calculateEstimatedTotal);
        }

        function refreshData() {
            showNotification('Donn√©es synchronis√©es', 'success');
            loadModule(currentModule);
            updateBadges();
        }

        function setupForms() {
            document.getElementById('reservationForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitReservation();
            });

            document.getElementById('orderForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitOrder();
            });

            document.getElementById('guestForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitGuest();
            });

            document.getElementById('stockForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitStock();
            });

            document.getElementById('employeeForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitEmployee();
            });

            document.getElementById('expenseForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitExpense();
            });

            document.getElementById('roomForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                if (checkAuth()) submitRoom();
            });

            updateRoomSelectors();
        }

        function updateRoomSelectors() {
            const roomSelect = document.getElementById('roomSelect');
            const chargeRoomSelect = document.getElementById('chargeRoomSelect');

            if (roomSelect) {
                roomSelect.innerHTML = '<option value="">S√©lectionner une chambre</option>';
                appData.rooms.filter(r => r.status === 'available').forEach(room => {
                    roomSelect.innerHTML += `<option value="${room.number}" data-price="${room.price}">üö™ ${room.number} - ${room.type} (${room.price.toLocaleString()} XOF/nuit)</option>`;
                });
            }

            if (chargeRoomSelect) {
                chargeRoomSelect.innerHTML = '<option value="">Choisir une chambre</option>';
                appData.rooms.filter(r => r.status === 'occupied').forEach(room => {
                    chargeRoomSelect.innerHTML += `<option value="${room.number}">üö™ ${room.number} - ${room.type} (Occup√© par ${room.guest})</option>`;
                });
            }
        }

        function calculateEstimatedTotal() {
            const roomSelect = document.getElementById('roomSelect');
            const checkin = document.getElementById('checkinDate').value;
            const checkout = document.getElementById('checkoutDate').value;

            if (roomSelect.value && checkin && checkout) {
                const selectedOption = roomSelect.options[roomSelect.selectedIndex];
                const pricePerNight = parseInt(selectedOption.dataset.price);
                const nights = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
                const total = pricePerNight * nights;
                document.getElementById('estimatedTotal').textContent = total.toLocaleString();
            }
        }

        function loadModule(module) {
            if (!checkAuth()) return;

            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('show');
            }

            currentModule = module;

            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                item.removeAttribute('aria-current');
                if (item.dataset.module === module) {
                    item.classList.add('active');
                    item.setAttribute('aria-current', 'page');
                }
            });

            const titles = {
                dashboard: 'Tableau de bord',
                calendar: 'Calendrier des r√©servations',
                bookings: 'Gestion des r√©servations',
                orders: 'Commandes restaurant',
                rooms: 'Gestion des chambres',
                guests: 'Fiches clients',
                stock: 'Gestion des stocks',
                staff: 'Personnel',
                invoices: 'Facturation',
                reports: 'Rapports',
                expenses: 'D√©penses'
            };
            document.getElementById('page-title').textContent = titles[module] || 'Tableau de bord';

            loadModuleContent(module);
        }

        function loadModuleContent(module) {
            const content = document.getElementById('dashboard-content');

            if (module === 'dashboard') {
                content.innerHTML = renderDashboard();
                setTimeout(() => {
                    initCharts();
                    AOS.refresh();
                }, 100);
            } else if (module === 'calendar') {
                content.innerHTML = renderCalendar();
                setTimeout(() => {
                    initCalendar();
                }, 100);
            } else if (module === 'bookings') {
                content.innerHTML = renderBookings();
                setTimeout(() => {
                    initDataTable('#bookings-table');
                }, 100);
            } else if (module === 'orders') {
                content.innerHTML = renderOrders();
                setTimeout(() => {
                    initDataTable('#orders-table');
                }, 100);
            } else if (module === 'rooms') {
                content.innerHTML = renderRooms();
            } else if (module === 'guests') {
                content.innerHTML = renderGuests();
            } else if (module === 'stock') {
                content.innerHTML = renderStock();
            } else if (module === 'staff') {
                content.innerHTML = renderStaff();
            } else if (module === 'invoices') {
                content.innerHTML = renderInvoices();
            } else if (module === 'reports') {
                content.innerHTML = renderReports();
                setTimeout(() => {
                    initReportsCharts();
                }, 100);
            } else if (module === 'expenses') {
                content.innerHTML = renderExpenses();
            }
        }

        // ============================================
        // FONCTIONS DE RENDU AVEC IC√îNES AM√âLIOR√âES
        // ============================================

        function renderDashboard() {
            const stats = appData.stats;
            
            return `
                <div class="stats-grid">
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
                        <div class="stat-header">
                            <div class="stat-icon primary">
                                <i class="fas fa-hotel" aria-hidden="true"></i>
                            </div>
                            <span class="badge badge-primary"><i class="fas fa-bed me-1"></i>${stats.occupiedRooms}/${stats.totalRooms} chambres</span>
                        </div>
                        <div class="stat-value">${stats.occupancyRate}%</div>
                        <div class="stat-label">Taux d'occupation</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> +8%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted"><i class="fas fa-calendar-check me-1"></i>Arriv√©es: ${stats.checkinsToday} | D√©parts: ${stats.checkoutsToday}</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="stat-header">
                            <div class="stat-icon success">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                            <span class="badge badge-success"><i class="fas fa-euro-sign me-1"></i>Total</span>
                        </div>
                        <div class="stat-value">${(stats.hotelRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">CA H√¥tel (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> +15%</span>
                            <span>ce mois</span>
                        </div>
                        <small class="text-muted"><i class="fas fa-calendar me-1"></i>Depuis Jan 2026</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
                        <div class="stat-header">
                            <div class="stat-icon warning">
                                <i class="fas fa-utensils" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(stats.restaurantRevenue / 1000).toFixed(0)}k</div>
                        <div class="stat-label">CA Restaurant (XOF)</div>
                        <div class="stat-trend">
                            <span class="trend-up"><i class="fas fa-arrow-up"></i> +5%</span>
                            <span>vs hier</span>
                        </div>
                        <small class="text-muted"><i class="fas fa-clock me-1"></i>${stats.pendingOrders} commandes en cours</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
                        <div class="stat-header">
                            <div class="stat-icon danger">
                                <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${stats.lowStock}</div>
                        <div class="stat-label">Alertes stock</div>
                        <div class="stat-trend ${stats.lowStock > 0 ? 'trend-down' : 'trend-up'}">
                            <i class="fas ${stats.lowStock > 0 ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i>
                            <span>${stats.lowStock > 0 ? 'Action requise' : 'Stock OK'}</span>
                        </div>
                        <small class="text-muted"><i class="fas fa-boxes me-1"></i>Produits sous seuil</small>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card" data-aos="fade-right">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar me-2" style="color: var(--primary);"></i>Occupation 7 derniers jours</h3>
                            <i class="fas fa-ellipsis-h text-muted"></i>
                        </div>
                        <canvas id="occupancy-chart" style="height: 250px;" aria-label="Graphique d'occupation" role="img"></canvas>
                    </div>

                    <div class="chart-card" data-aos="fade-left">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie me-2" style="color: var(--primary);"></i>R√©partition des revenus</h3>
                            <i class="fas fa-ellipsis-h text-muted"></i>
                        </div>
                        <canvas id="revenue-chart" style="height: 250px;" aria-label="Graphique des revenus" role="img"></canvas>
                    </div>
                </div>

                ${renderReceptionDashboard()}
            `;
        }

        function renderReceptionDashboard() {
            const today = new Date().toISOString().split('T')[0];
            const todayCheckins = appData.bookings.filter(b => b.checkin === today);
            const todayCheckouts = appData.bookings.filter(b => b.checkout === today);

            return `
                <div class="room-grid">
                    ${appData.rooms.filter(r => r.status === 'available').slice(0, 4).map(room => `
                        <button class="room-card available" onclick="quickReserve(${room.number})" aria-label="R√©server la chambre ${room.number}" data-aos="zoom-in">
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="room-number"><i class="fas fa-door-open me-2"></i>Ch. ${room.number}</span>
                                <span class="badge badge-success"><i class="fas fa-check-circle me-1"></i>Disponible</span>
                            </div>
                            <div class="room-type"><i class="fas fa-tag me-1"></i>${room.type}</div>
                            <div class="room-price mt-2"><i class="fas fa-coins me-1"></i>${room.price.toLocaleString()} XOF/nuit</div>
                        </button>
                    `).join('')}
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="table-card" data-aos="fade-right">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-in-alt me-2" style="color: #28a745;"></i>Arriv√©es aujourd'hui</h3>
                                <span class="badge badge-success"><i class="fas fa-users me-1"></i>${todayCheckins.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="Arriv√©es du jour">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-user me-2"></i>Client</th>
                                            <th><i class="fas fa-door-open me-2"></i>Chambre</th>
                                            <th><i class="fas fa-clock me-2"></i>Heure</th>
                                            <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                            <th><i class="fas fa-cog me-2"></i>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckins.length ? todayCheckins.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong><br><small class="text-muted"><i class="fas fa-phone me-1"></i>${b.phone}</small></td>
                                                <td>${b.room}</td>
                                                <td><i class="far fa-clock me-1"></i>14:00</td>
                                                <td><span class="badge badge-info"><i class="fas fa-hourglass-half me-1"></i>En attente</span></td>
                                                <td>
                                                    <button class="btn btn-success btn-sm" onclick="checkIn('${b.id}')" aria-label="Effectuer le check-in" data-tooltip="Check-in">
                                                        <i class="fas fa-check" aria-hidden="true"></i>
                                                    </button>
                                                    <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir d√©tails" data-tooltip="D√©tails">
                                                        <i class="fas fa-eye" aria-hidden="true"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center py-4"><i class="fas fa-check-circle me-2" style="color: #28a745;"></i>Aucune arriv√©e aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="table-card" data-aos="fade-left">
                            <div class="table-header">
                                <h3><i class="fas fa-sign-out-alt me-2" style="color: #dc3545;"></i>D√©parts aujourd'hui</h3>
                                <span class="badge badge-danger"><i class="fas fa-users me-1"></i>${todayCheckouts.length}</span>
                            </div>
                            <div class="table-responsive">
                                <table class="table" aria-label="D√©parts du jour">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-user me-2"></i>Client</th>
                                            <th><i class="fas fa-door-open me-2"></i>Chambre</th>
                                            <th><i class="fas fa-clock me-2"></i>Heure</th>
                                            <th><i class="fas fa-file-invoice me-2"></i>Facture</th>
                                            <th><i class="fas fa-cog me-2"></i>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${todayCheckouts.length ? todayCheckouts.map(b => `
                                            <tr>
                                                <td><strong>${b.guest}</strong><br><small class="text-muted"><i class="fas fa-phone me-1"></i>${b.phone}</small></td>
                                                <td>${b.room}</td>
                                                <td><i class="far fa-clock me-1"></i>11:00</td>
                                                <td>
                                                    <button class="btn btn-info btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture" data-tooltip="Voir facture">
                                                        <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                                    </button>
                                                </td>
                                                <td>
                                                    <button class="btn btn-success btn-sm" onclick="checkOut('${b.id}')" aria-label="Effectuer le check-out" data-tooltip="Check-out">
                                                        <i class="fas fa-check" aria-hidden="true"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        `).join('') : '<tr><td colspan="5" class="text-center py-4"><i class="fas fa-check-circle me-2" style="color: #28a745;"></i>Aucun d√©part aujourd\'hui</td></tr>'}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-card mt-4" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-calendar-alt me-2" style="color: var(--primary);"></i>Prochaines r√©servations</h3>
                        <button class="btn btn-primary" onclick="openReservationModal()" aria-label="Nouvelle r√©servation">
                            <i class="fas fa-plus me-2"></i> Nouvelle r√©servation
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="dashboard-bookings-table" aria-label="Liste des r√©servations">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>N¬∞</th>
                                    <th><i class="fas fa-user me-2"></i>Client</th>
                                    <th><i class="fas fa-door-open me-2"></i>Chambre</th>
                                    <th><i class="fas fa-calendar-plus me-2"></i>Arriv√©e</th>
                                    <th><i class="fas fa-calendar-minus me-2"></i>D√©part</th>
                                    <th><i class="fas fa-coins me-2"></i>Montant</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.slice(0, 5).map(b => `
                                    <tr>
                                        <td><strong>${b.id}</strong></td>
                                        <td>${b.guest}<br><small class="text-muted"><i class="fas fa-phone me-1"></i>${b.phone}</small></td>
                                        <td>${b.room}</td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(b.checkin)}</td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(b.checkout)}</td>
                                        <td><strong>${(b.total / 1000).toFixed(0)}k</strong> XOF</td>
                                        <td><span class="badge ${getStatusClass(b.status)}"><i class="fas ${getStatusIcon(b.status)} me-1"></i>${getStatusLabel(b.status)}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir les d√©tails" data-tooltip="D√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Voir la facture" data-tooltip="Facture">
                                                <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                            </button>
                                            ${b.status === 'pending' ? `
                                                <button class="btn btn-success btn-sm" onclick="confirmBooking('${b.id}')" aria-label="Confirmer" data-tooltip="Confirmer">
                                                    <i class="fas fa-check" aria-hidden="true"></i>
                                                </button>
                                                <button class="btn btn-danger btn-sm" onclick="deleteBooking('${b.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                    <i class="fas fa-trash" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="table-card mt-4" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-utensils me-2" style="color: #ffc107;"></i>Commandes restaurant en cours</h3>
                        <button class="btn btn-warning" onclick="openOrderModal()" aria-label="Nouvelle commande">
                            <i class="fas fa-plus me-2"></i> Nouvelle commande
                        </button>
                    </div>
                    <div class="kitchen-orders">
                        ${appData.restaurantOrders.filter(o => o.status === 'pending' || o.status === 'preparing').map(order => `
                            <div class="kitchen-card" data-aos="zoom-in">
                                <div class="kitchen-header">
                                    <span class="table-number"><i class="fas fa-chair me-1"></i>Table ${order.table}</span>
                                    <span class="timer"><i class="far fa-clock me-1"></i> ${order.time}</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <strong><i class="fas fa-user me-1"></i>${order.guest}</strong>
                                    <span class="badge ${order.status === 'preparing' ? 'badge-warning' : 'badge-info'}">
                                        <i class="fas ${order.status === 'preparing' ? 'fa-fire' : 'fa-hourglass-half'} me-1"></i>
                                        ${order.status === 'preparing' ? 'En pr√©paration' : 'En attente'}
                                    </span>
                                </div>
                                <ul class="kitchen-items">
                                    ${order.items.map(item => `
                                        <li class="d-flex justify-content-between">
                                            <span><i class="fas fa-utensil-spoon me-2"></i>${item.qty}x ${item.name}</span>
                                            <span class="fw-bold">${(item.price * item.qty / 1000).toFixed(0)}k XOF</span>
                                        </li>
                                    `).join('')}
                                </ul>
                                <div class="d-flex justify-content-between align-items-center mt-2 pt-2 border-top">
                                    <span class="fw-bold"><i class="fas fa-coins me-1"></i>Total: ${(order.total / 1000).toFixed(0)}k XOF</span>
                                    <div>
                                        <button class="btn btn-success btn-sm" onclick="markOrderReady('${order.id}')" aria-label="Marquer pr√™t" data-tooltip="Pr√™t">
                                            <i class="fas fa-check" aria-hidden="true"></i>
                                        </button>
                                        <button class="btn btn-info btn-sm" onclick="viewOrder('${order.id}')" aria-label="Voir d√©tails" data-tooltip="D√©tails">
                                            <i class="fas fa-eye" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('') || '<div class="text-center py-4"><i class="fas fa-check-circle me-2" style="color: #28a745;"></i>Aucune commande en cours</div>'}
                    </div>
                </div>
            `;
        }

        function renderBookings() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-hotel me-2" style="color: var(--primary);"></i>Liste des r√©servations</h3>
                        <div>
                            <button class="btn btn-outline-primary me-2" onclick="exportData('bookings')" aria-label="Exporter">
                                <i class="fas fa-download me-2"></i> Exporter
                            </button>
                            <button class="btn btn-primary" onclick="openReservationModal()" aria-label="Nouvelle r√©servation">
                                <i class="fas fa-plus me-2"></i> Nouvelle r√©servation
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="bookings-table" aria-label="Liste des r√©servations">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-user me-2"></i>Client</th>
                                    <th><i class="fas fa-door-open me-2"></i>Chambre</th>
                                    <th><i class="fas fa-calendar-plus me-2"></i>Arriv√©e</th>
                                    <th><i class="fas fa-calendar-minus me-2"></i>D√©part</th>
                                    <th><i class="fas fa-user-friends me-2"></i>Adultes/Enfants</th>
                                    <th><i class="fas fa-coins me-2"></i>Total</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.bookings.map(b => `
                                    <tr>
                                        <td><strong>${b.id}</strong></td>
                                        <td>
                                            ${b.guest}<br>
                                            <small class="text-muted"><i class="fas fa-phone me-1"></i>${b.phone}</small><br>
                                            <small class="text-muted"><i class="fas fa-envelope me-1"></i>${b.email}</small>
                                        </td>
                                        <td>${b.room}</td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(b.checkin)}</td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(b.checkout)}</td>
                                        <td><i class="fas fa-user me-1"></i>${b.adults} <i class="fas fa-child ms-2 me-1"></i>${b.children}</td>
                                        <td><strong>${(b.total / 1000).toFixed(0)}k XOF</strong><br><small class="text-muted"><i class="fas fa-hand-holding-usd me-1"></i>Acompte: ${(b.prepaid / 1000).toFixed(0)}k</small></td>
                                        <td><span class="badge ${getStatusClass(b.status)}"><i class="fas ${getStatusIcon(b.status)} me-1"></i>${getStatusLabel(b.status)}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewBooking('${b.id}')" aria-label="Voir" data-tooltip="D√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-primary btn-sm" onclick="showInvoice('${b.id}')" aria-label="Facture" data-tooltip="Facture">
                                                <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                            </button>
                                            ${b.status !== 'checked-out' ? `
                                                <button class="btn btn-warning btn-sm" onclick="editBooking('${b.id}')" aria-label="Modifier" data-tooltip="Modifier">
                                                    <i class="fas fa-edit" aria-hidden="true"></i>
                                                </button>
                                                <button class="btn btn-danger btn-sm" onclick="deleteBooking('${b.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                    <i class="fas fa-trash" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderOrders() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-utensils me-2" style="color: #ffc107;"></i>Commandes restaurant</h3>
                        <div>
                            <button class="btn btn-outline-primary me-2" onclick="exportData('orders')" aria-label="Exporter">
                                <i class="fas fa-download me-2"></i> Exporter
                            </button>
                            <button class="btn btn-warning" onclick="openOrderModal()" aria-label="Nouvelle commande">
                                <i class="fas fa-plus me-2"></i> Nouvelle commande
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table" id="orders-table" aria-label="Liste des commandes">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-chair me-2"></i>Table</th>
                                    <th><i class="fas fa-user me-2"></i>Client</th>
                                    <th><i class="fas fa-utensils me-2"></i>Articles</th>
                                    <th><i class="fas fa-coins me-2"></i>Total</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-clock me-2"></i>Heure</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.restaurantOrders.map(o => `
                                    <tr>
                                        <td><strong>${o.id}</strong></td>
                                        <td><i class="fas fa-chair me-1"></i>Table ${o.table}</td>
                                        <td>
                                            ${o.guest}<br>
                                            ${o.roomCharge ? `<small class="text-muted"><i class="fas fa-hotel me-1"></i>Ch. ${o.roomNumber}</small>` : ''}
                                        </td>
                                        <td>
                                            ${o.items.map(item => `<i class="fas fa-utensil-spoon me-1"></i>${item.qty}x ${item.name}`).join('<br>')}
                                        </td>
                                        <td><strong>${(o.total / 1000).toFixed(0)}k XOF</strong></td>
                                        <td><span class="badge ${o.status === 'paid' ? 'badge-success' : o.status === 'preparing' ? 'badge-warning' : 'badge-info'}"><i class="fas ${o.status === 'paid' ? 'fa-check-circle' : o.status === 'preparing' ? 'fa-fire' : 'fa-hourglass-half'} me-1"></i>${getOrderStatusLabel(o.status)}</span></td>
                                        <td><i class="far fa-clock me-1"></i>${o.time}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewOrder('${o.id}')" aria-label="Voir" data-tooltip="D√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            ${o.status !== 'paid' ? `
                                                <button class="btn btn-success btn-sm" onclick="markOrderReady('${o.id}')" aria-label="Marquer pr√™t" data-tooltip="Pr√™t">
                                                    <i class="fas fa-check" aria-hidden="true"></i>
                                                </button>
                                                <button class="btn btn-primary btn-sm" onclick="showOrderInvoice('${o.id}')" aria-label="Facture" data-tooltip="Facture">
                                                    <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                            <button class="btn btn-danger btn-sm" onclick="deleteOrder('${o.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                <i class="fas fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderRooms() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-door-open me-2" style="color: var(--primary);"></i>Gestion des chambres</h3>
                        <button class="btn btn-primary" onclick="openRoomModal()" aria-label="Nouvelle chambre">
                            <i class="fas fa-plus me-2"></i> Nouvelle chambre
                        </button>
                    </div>
                    <div class="room-grid mb-4">
                        ${appData.rooms.map(room => `
                            <button class="room-card ${room.status}" onclick="viewRoom(${room.number})" aria-label="Voir chambre ${room.number}" data-aos="zoom-in">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="room-number"><i class="fas fa-door-open me-2"></i>Ch. ${room.number}</span>
                                    <span class="badge ${room.status === 'available' ? 'badge-success' : room.status === 'occupied' ? 'badge-primary' : room.status === 'reserved' ? 'badge-warning' : 'badge-danger'}">
                                        <i class="fas ${room.status === 'available' ? 'fa-check-circle' : room.status === 'occupied' ? 'fa-bed' : room.status === 'reserved' ? 'fa-calendar-check' : 'fa-tools'} me-1"></i>
                                        ${room.status === 'available' ? 'Disponible' : room.status === 'occupied' ? 'Occup√©e' : room.status === 'reserved' ? 'R√©serv√©e' : 'Maintenance'}
                                    </span>
                                </div>
                                <div class="room-type"><i class="fas fa-tag me-1"></i>${room.type}</div>
                                <div class="room-price mt-2"><i class="fas fa-coins me-1"></i>${room.price.toLocaleString()} XOF/nuit</div>
                                ${room.guest ? `<small class="text-muted"><i class="fas fa-user me-1"></i>Client: ${room.guest}</small>` : ''}
                            </button>
                        `).join('')}
                    </div>

                    <div class="table-responsive">
                        <table class="table" aria-label="D√©tails des chambres">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>N¬∞ Chambre</th>
                                    <th><i class="fas fa-tag me-2"></i>Type</th>
                                    <th><i class="fas fa-coins me-2"></i>Prix/nuit</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-user me-2"></i>Client actuel</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.rooms.map(room => `
                                    <tr>
                                        <td><strong><i class="fas fa-door-open me-2"></i>${room.number}</strong></td>
                                        <td>${room.type}</td>
                                        <td>${room.price.toLocaleString()} XOF</td>
                                        <td><span class="badge ${room.status === 'available' ? 'badge-success' : room.status === 'occupied' ? 'badge-primary' : room.status === 'reserved' ? 'badge-warning' : 'badge-danger'}"><i class="fas ${room.status === 'available' ? 'fa-check-circle' : room.status === 'occupied' ? 'fa-bed' : room.status === 'reserved' ? 'fa-calendar-check' : 'fa-tools'} me-1"></i>${room.status}</span></td>
                                        <td>${room.guest || '-'}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewRoom(${room.number})" aria-label="Voir" data-tooltip="Voir d√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-warning btn-sm" onclick="editRoom(${room.number})" aria-label="Modifier" data-tooltip="Modifier">
                                                <i class="fas fa-edit" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-danger btn-sm" onclick="deleteRoom(${room.number})" aria-label="Supprimer" data-tooltip="Supprimer">
                                                <i class="fas fa-trash" aria-hidden="true"></i>
                                            </button>
                                            ${room.status === 'available' ? `
                                                <button class="btn btn-success btn-sm" onclick="quickReserve(${room.number})" aria-label="R√©server" data-tooltip="R√©server">
                                                    <i class="fas fa-check" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderGuests() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-users me-2" style="color: var(--primary);"></i>Fiches clients</h3>
                        <button class="btn btn-primary" onclick="openGuestModal()" aria-label="Nouveau client">
                            <i class="fas fa-user-plus me-2"></i> Nouveau client
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des clients">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-user me-2"></i>Nom</th>
                                    <th><i class="fas fa-address-card me-2"></i>Contact</th>
                                    <th><i class="fas fa-clock me-2"></i>S√©jours</th>
                                    <th><i class="fas fa-coins me-2"></i>Total d√©pens√©</th>
                                    <th><i class="fas fa-calendar me-2"></i>Dernier s√©jour</th>
                                    <th><i class="fas fa-heart me-2"></i>Pr√©f√©rences</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.guests.map(g => `
                                    <tr>
                                        <td><strong>${g.id}</strong></td>
                                        <td><i class="fas fa-user-circle me-1"></i>${g.name}</td>
                                        <td>
                                            <i class="fas fa-envelope me-1"></i>${g.email}<br>
                                            <small class="text-muted"><i class="fas fa-phone me-1"></i>${g.phone}</small>
                                        </td>
                                        <td><i class="fas fa-calendar-check me-1"></i>${g.stays} s√©jours</td>
                                        <td><strong><i class="fas fa-coins me-1"></i>${(g.totalSpent / 1000).toFixed(0)}k XOF</strong></td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(g.lastStay)}</td>
                                        <td><small><i class="fas fa-heart me-1" style="color: #dc3545;"></i>${g.preferences}</small></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewGuest('${g.id}')" aria-label="Voir" data-tooltip="D√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-warning btn-sm" onclick="editGuest('${g.id}')" aria-label="Modifier" data-tooltip="Modifier">
                                                <i class="fas fa-edit" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-primary btn-sm" onclick="generateGuestInvoice('${g.id}')" aria-label="Facture" data-tooltip="G√©n√©rer facture">
                                                <i class="fas fa-file-pdf" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderStock() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-boxes me-2" style="color: var(--primary);"></i>Gestion des stocks</h3>
                        <div>
                            <button class="btn btn-outline-primary me-2" onclick="exportData('stock')" aria-label="Exporter">
                                <i class="fas fa-download me-2"></i> Exporter
                            </button>
                            <button class="btn btn-primary" onclick="openStockModal()" aria-label="Nouvel article">
                                <i class="fas fa-plus me-2"></i> Nouvel article
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des stocks">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-tag me-2"></i>Article</th>
                                    <th><i class="fas fa-folder me-2"></i>Cat√©gorie</th>
                                    <th><i class="fas fa-weight me-2"></i>Quantit√©</th>
                                    <th><i class="fas fa-exclamation-triangle me-2"></i>Seuil</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-calendar-times me-2"></i>Expiration</th>
                                    <th><i class="fas fa-truck me-2"></i>Fournisseur</th>
                                    <th><i class="fas fa-coins me-2"></i>Prix unit.</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.stock.map(s => {
                                    const isLow = s.quantity <= s.threshold;
                                    const isExpiring = s.expiry && new Date(s.expiry) - new Date() < 7 * 24 * 60 * 60 * 1000;
                                    return `
                                    <tr>
                                        <td><strong>${s.id}</strong></td>
                                        <td><i class="fas fa-cube me-1"></i>${s.name}</td>
                                        <td><span class="badge badge-info"><i class="fas fa-folder me-1"></i>${s.category}</span></td>
                                        <td>${s.quantity} ${s.unit}</td>
                                        <td>${s.threshold} ${s.unit}</td>
                                        <td>
                                            ${isLow ? '<span class="badge badge-danger"><i class="fas fa-exclamation-circle me-1"></i>Stock faible</span>' : '<span class="badge badge-success"><i class="fas fa-check-circle me-1"></i>OK</span>'}
                                            ${isExpiring ? '<br><span class="badge badge-warning mt-1"><i class="fas fa-clock me-1"></i>Expire bient√¥t</span>' : ''}
                                        </td>
                                        <td>${s.expiry ? `<i class="far fa-calendar me-1"></i>${formatDate(s.expiry)}` : '-'}</td>
                                        <td><i class="fas fa-truck me-1"></i>${s.supplier}</td>
                                        <td>${s.price.toLocaleString()} XOF</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="editStock('${s.id}')" aria-label="Modifier" data-tooltip="Modifier">
                                                <i class="fas fa-edit" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-success btn-sm" onclick="orderStock('${s.id}')" aria-label="Commander" data-tooltip="Commander">
                                                <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-danger btn-sm" onclick="deleteStock('${s.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                <i class="fas fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `}).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderStaff() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-users-cog me-2" style="color: var(--primary);"></i>Gestion du personnel</h3>
                        <button class="btn btn-primary" onclick="openEmployeeModal()" aria-label="Nouvel employ√©">
                            <i class="fas fa-user-plus me-2"></i> Nouvel employ√©
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" aria-label="Liste du personnel">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-user me-2"></i>Nom</th>
                                    <th><i class="fas fa-briefcase me-2"></i>R√¥le</th>
                                    <th><i class="fas fa-building me-2"></i>D√©partement</th>
                                    <th><i class="fas fa-address-card me-2"></i>Contact</th>
                                    <th><i class="fas fa-clock me-2"></i>Planning</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.employees.map(e => `
                                    <tr>
                                        <td><strong>${e.id}</strong></td>
                                        <td><i class="fas fa-user-circle me-1"></i>${e.name}</td>
                                        <td><span class="badge badge-info"><i class="fas fa-briefcase me-1"></i>${e.role}</span></td>
                                        <td>${e.department === 'restaurant' ? 'üçΩÔ∏è Restaurant' : e.department === 'reception' ? 'üè® R√©ception' : 'üëî Direction'}</td>
                                        <td>
                                            <i class="fas fa-envelope me-1"></i>${e.email}<br>
                                            <small class="text-muted"><i class="fas fa-phone me-1"></i>${e.phone}</small>
                                        </td>
                                        <td><i class="far fa-clock me-1"></i>${e.schedule}</td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewEmployee('${e.id}')" aria-label="Voir" data-tooltip="D√©tails">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-warning btn-sm" onclick="editEmployee('${e.id}')" aria-label="Modifier" data-tooltip="Modifier">
                                                <i class="fas fa-edit" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-danger btn-sm" onclick="deleteEmployee('${e.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                <i class="fas fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderInvoices() {
            const allInvoices = [
                ...appData.bookings.map(b => ({
                    id: b.id,
                    type: 'H√¥tel',
                    client: b.guest,
                    date: b.checkout,
                    amount: b.total,
                    status: b.status === 'checked-out' ? 'pay√©' : 'en attente',
                    items: [`S√©jour du ${formatDate(b.checkin)} au ${formatDate(b.checkout)}`]
                })),
                ...appData.restaurantOrders.map(o => ({
                    id: o.id,
                    type: 'Restaurant',
                    client: o.guest,
                    date: o.date,
                    amount: o.total,
                    status: o.status === 'paid' ? 'pay√©' : 'en attente',
                    items: o.items.map(i => `${i.qty}x ${i.name}`)
                }))
            ].sort((a, b) => new Date(b.date) - new Date(a.date));

            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-file-invoice me-2" style="color: var(--primary);"></i>Factures</h3>
                        <div>
                            <button class="btn btn-outline-primary me-2" onclick="exportData('invoices')" aria-label="Exporter">
                                <i class="fas fa-download me-2"></i> Exporter
                            </button>
                            <button class="btn btn-primary" onclick="generateNewInvoice()" aria-label="Nouvelle facture">
                                <i class="fas fa-plus me-2"></i> Nouvelle facture
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des factures">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>N¬∞ Facture</th>
                                    <th><i class="fas fa-tag me-2"></i>Type</th>
                                    <th><i class="fas fa-user me-2"></i>Client</th>
                                    <th><i class="fas fa-calendar me-2"></i>Date</th>
                                    <th><i class="fas fa-coins me-2"></i>Montant</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${allInvoices.map(inv => `
                                    <tr>
                                        <td><strong>INV-${inv.id}</strong></td>
                                        <td><span class="badge ${inv.type === 'H√¥tel' ? 'badge-primary' : 'badge-warning'}"><i class="fas ${inv.type === 'H√¥tel' ? 'fa-hotel' : 'fa-utensils'} me-1"></i>${inv.type}</span></td>
                                        <td><i class="fas fa-user me-1"></i>${inv.client}</td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(inv.date)}</td>
                                        <td><strong>${(inv.amount / 1000).toFixed(0)}k XOF</strong></td>
                                        <td><span class="badge ${inv.status === 'pay√©' ? 'badge-success' : 'badge-warning'}"><i class="fas ${inv.status === 'pay√©' ? 'fa-check-circle' : 'fa-hourglass-half'} me-1"></i>${inv.status}</span></td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="viewInvoice('${inv.id}')" aria-label="Voir" data-tooltip="Voir facture">
                                                <i class="fas fa-eye" aria-hidden="true"></i>
                                            </button>
                                            <button class="btn btn-primary btn-sm" onclick="downloadInvoice('${inv.id}')" aria-label="T√©l√©charger" data-tooltip="T√©l√©charger PDF">
                                                <i class="fas fa-download" aria-hidden="true"></i>
                                            </button>
                                            ${inv.status !== 'pay√©' ? `
                                                <button class="btn btn-success btn-sm" onclick="markAsPaid('${inv.id}')" aria-label="Marquer pay√©" data-tooltip="Marquer comme pay√©">
                                                    <i class="fas fa-check" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderReports() {
            const totalRevenue = appData.stats.hotelRevenue + appData.stats.restaurantRevenue;
            const totalExpenses = appData.expenses.reduce((sum, e) => sum + e.amount, 0);
            const netProfit = totalRevenue - totalExpenses;

            return `
                <div class="stats-grid">
                    <div class="stat-card" data-aos="fade-up" data-aos-delay="100">
                        <div class="stat-header">
                            <div class="stat-icon success">
                                <i class="fas fa-chart-line" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(totalRevenue / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">Chiffre d'affaires total</div>
                        <small class="text-muted"><i class="fas fa-hotel me-1"></i>H√¥tel + Restaurant</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="200">
                        <div class="stat-header">
                            <div class="stat-icon danger">
                                <i class="fas fa-coins" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(totalExpenses / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">D√©penses totales</div>
                        <small class="text-muted"><i class="fas fa-file-invoice me-1"></i>Charges et achats</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="300">
                        <div class="stat-header">
                            <div class="stat-icon primary">
                                <i class="fas fa-wallet" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${(netProfit / 1000000).toFixed(1)}M</div>
                        <div class="stat-label">B√©n√©fice net</div>
                        <small class="text-muted"><i class="fas fa-percent me-1"></i>${((netProfit / totalRevenue) * 100).toFixed(1)}% de marge</small>
                    </div>

                    <div class="stat-card" data-aos="fade-up" data-aos-delay="400">
                        <div class="stat-header">
                            <div class="stat-icon info">
                                <i class="fas fa-percent" aria-hidden="true"></i>
                            </div>
                        </div>
                        <div class="stat-value">${appData.stats.occupancyRate}%</div>
                        <div class="stat-label">Taux d'occupation</div>
                        <small class="text-muted"><i class="fas fa-calendar me-1"></i>Moyenne p√©riode</small>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card" data-aos="fade-right">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-bar me-2" style="color: var(--primary);"></i>Revenus mensuels</h3>
                            <select class="form-select form-select-sm w-auto" onchange="updateMonthlyChart(this.value)">
                                <option value="2026">2026</option>
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        <canvas id="monthly-revenue-chart" style="height: 300px;" aria-label="Graphique des revenus mensuels" role="img"></canvas>
                    </div>

                    <div class="chart-card" data-aos="fade-left">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie me-2" style="color: var(--primary);"></i>R√©partition des d√©penses</h3>
                            <i class="fas fa-ellipsis-h text-muted"></i>
                        </div>
                        <canvas id="expenses-chart" style="height: 300px;" aria-label="Graphique des d√©penses" role="img"></canvas>
                    </div>
                </div>

                <div class="table-card mt-4" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-download me-2" style="color: var(--primary);"></i>Exporter les rapports</h3>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="exportReport('daily')">
                                <i class="fas fa-calendar-day me-2"></i>Rapport journalier
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="exportReport('weekly')">
                                <i class="fas fa-calendar-week me-2"></i>Rapport hebdomadaire
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="exportReport('monthly')">
                                <i class="fas fa-calendar-alt me-2"></i>Rapport mensuel
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-primary w-100" onclick="exportReport('yearly')">
                                <i class="fas fa-calendar me-2"></i>Rapport annuel
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderExpenses() {
            const totalPaid = appData.expenses.filter(e => e.paid).reduce((sum, e) => sum + e.amount, 0);
            const totalPending = appData.expenses.filter(e => !e.paid).reduce((sum, e) => sum + e.amount, 0);

            return `
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="stat-card" data-aos="fade-right">
                            <div class="stat-header">
                                <div class="stat-icon success">
                                    <i class="fas fa-check-circle" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="stat-value">${(totalPaid / 1000).toFixed(0)}k XOF</div>
                            <div class="stat-label">D√©penses pay√©es</div>
                            <small class="text-muted"><i class="fas fa-check-circle me-1" style="color: var(--success);"></i>Montant r√©gl√©</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="stat-card" data-aos="fade-left">
                            <div class="stat-header">
                                <div class="stat-icon warning">
                                    <i class="fas fa-clock" aria-hidden="true"></i>
                                </div>
                            </div>
                            <div class="stat-value">${(totalPending / 1000).toFixed(0)}k XOF</div>
                            <div class="stat-label">D√©penses en attente</div>
                            <small class="text-muted"><i class="fas fa-exclamation-triangle me-1" style="color: var(--warning);"></i>√Ä r√©gulariser</small>
                        </div>
                    </div>
                </div>

                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-coins me-2" style="color: var(--primary);"></i>Liste des d√©penses</h3>
                        <button class="btn btn-primary" onclick="openExpenseModal()" aria-label="Nouvelle d√©pense">
                            <i class="fas fa-plus me-2"></i> Nouvelle d√©pense
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="table" aria-label="Liste des d√©penses">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-hashtag me-2"></i>ID</th>
                                    <th><i class="fas fa-calendar me-2"></i>Date</th>
                                    <th><i class="fas fa-folder me-2"></i>Cat√©gorie</th>
                                    <th><i class="fas fa-pen me-2"></i>Description</th>
                                    <th><i class="fas fa-coins me-2"></i>Montant</th>
                                    <th><i class="fas fa-calendar-times me-2"></i>√âch√©ance</th>
                                    <th><i class="fas fa-info-circle me-2"></i>Statut</th>
                                    <th><i class="fas fa-cog me-2"></i>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${appData.expenses.map(e => `
                                    <tr>
                                        <td><strong>${e.id}</strong></td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(e.date)}</td>
                                        <td><span class="badge badge-info"><i class="fas ${e.category === '√©lectricit√©' ? 'fa-bolt' : e.category === 'eau' ? 'fa-water' : e.category === 'achats' ? 'fa-shopping-cart' : e.category === 'salaire' ? 'fa-money-bill' : 'fa-tools'} me-1"></i>${e.category}</span></td>
                                        <td>${e.description}</td>
                                        <td><strong>${(e.amount / 1000).toFixed(0)}k XOF</strong></td>
                                        <td><i class="far fa-calendar me-1"></i>${formatDate(e.dueDate)}</td>
                                        <td>
                                            <span class="badge ${e.paid ? 'badge-success' : 'badge-warning'}">
                                                <i class="fas ${e.paid ? 'fa-check-circle' : 'fa-hourglass-half'} me-1"></i>
                                                ${e.paid ? 'Pay√©e' : 'En attente'}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn btn-info btn-sm" onclick="editExpense('${e.id}')" aria-label="Modifier" data-tooltip="Modifier">
                                                <i class="fas fa-edit" aria-hidden="true"></i>
                                            </button>
                                            ${!e.paid ? `
                                                <button class="btn btn-success btn-sm" onclick="markExpensePaid('${e.id}')" aria-label="Marquer pay√©e" data-tooltip="Marquer comme pay√©e">
                                                    <i class="fas fa-check" aria-hidden="true"></i>
                                                </button>
                                            ` : ''}
                                            <button class="btn btn-danger btn-sm" onclick="deleteExpense('${e.id}')" aria-label="Supprimer" data-tooltip="Supprimer">
                                                <i class="fas fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderCalendar() {
            return `
                <div class="table-card" data-aos="fade-up">
                    <div class="table-header">
                        <h3><i class="fas fa-calendar-alt me-2" style="color: var(--primary);"></i>Calendrier des r√©servations</h3>
                    </div>
                    <div id="calendar" style="height: 600px;"></div>
                </div>
            `;
        }

        // ============================================
        // FONCTIONS DE GESTION
        // ============================================

        // R√©servations
        function openReservationModal() {
            updateRoomSelectors();
            document.getElementById('reservationForm').reset();
            new bootstrap.Modal(document.getElementById('reservationModal')).show();
        }

        function submitReservation() {
            const form = document.getElementById('reservationForm');
            const formData = {
                id: `BK${String(appData.bookings.length + 1).padStart(3, '0')}`,
                guest: document.getElementById('guestName').value,
                phone: document.getElementById('guestPhone').value,
                email: document.getElementById('guestEmail').value,
                roomNumber: document.getElementById('roomSelect').value,
                room: document.getElementById('roomSelect').selectedOptions[0].text.split(' - ')[1],
                checkin: document.getElementById('checkinDate').value,
                checkout: document.getElementById('checkoutDate').value,
                adults: parseInt(document.getElementById('adults').value),
                children: parseInt(document.getElementById('children').value),
                specialRequests: document.getElementById('specialRequests').value,
                status: 'confirmed',
                total: parseInt(document.getElementById('estimatedTotal').textContent.replace(/\s/g, '')),
                prepaid: 0
            };

            appData.bookings.push(formData);
            
            const room = appData.rooms.find(r => r.number == formData.roomNumber);
            if (room) {
                room.status = 'reserved';
                room.guest = formData.guest;
            }

            bootstrap.Modal.getInstance(document.getElementById('reservationModal')).hide();
            showNotification('R√©servation cr√©√©e avec succ√®s', 'success');
            loadModule('bookings');
            updateBadges();
        }

        function quickReserve(roomNumber) {
            openReservationModal();
            document.getElementById('roomSelect').value = roomNumber;
        }

        function checkIn(bookingId) {
            const booking = appData.bookings.find(b => b.id === bookingId);
            if (booking) {
                booking.status = 'checked-in';
                const room = appData.rooms.find(r => r.number == booking.roomNumber);
                if (room) {
                    room.status = 'occupied';
                    room.guest = booking.guest;
                }
                showNotification(`Check-in de ${booking.guest} effectu√©`, 'success');
                loadModule('bookings');
                updateBadges();
            }
        }

        function checkOut(bookingId) {
            const booking = appData.bookings.find(b => b.id === bookingId);
            if (booking) {
                booking.status = 'checked-out';
                const room = appData.rooms.find(r => r.number == booking.roomNumber);
                if (room) {
                    room.status = 'available';
                    room.guest = null;
                }
                showNotification(`Check-out de ${booking.guest} effectu√©`, 'success');
                loadModule('bookings');
                updateBadges();
            }
        }

        function viewBooking(bookingId) {
            const booking = appData.bookings.find(b => b.id === bookingId);
            if (booking) {
                showNotification(`Affichage des d√©tails de la r√©servation ${bookingId}`, 'info');
            }
        }

        function confirmBooking(bookingId) {
            const booking = appData.bookings.find(b => b.id === bookingId);
            if (booking) {
                booking.status = 'confirmed';
                showNotification(`R√©servation ${bookingId} confirm√©e`, 'success');
                loadModule('bookings');
                updateBadges();
            }
        }

        function editBooking(bookingId) {
            showNotification(`Modification de la r√©servation ${bookingId}`, 'info');
        }

        function deleteBooking(bookingId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette r√©servation ?')) {
                const index = appData.bookings.findIndex(b => b.id === bookingId);
                if (index !== -1) {
                    const booking = appData.bookings[index];
                    const room = appData.rooms.find(r => r.number == booking.roomNumber);
                    if (room) {
                        room.status = 'available';
                        room.guest = null;
                    }
                    appData.bookings.splice(index, 1);
                    showNotification('R√©servation supprim√©e', 'success');
                    loadModule('bookings');
                    updateBadges();
                }
            }
        }

        // Commandes
        function openOrderModal() {
            updateRoomSelectors();
            document.getElementById('orderForm').reset();
            document.getElementById('orderItems').innerHTML = `
                <div class="row mb-2 order-item">
                    <div class="col-md-6">
                        <select class="form-control item-select">
                            <option value="">S√©lectionner un article</option>
                            <option value="Thieboudienne" data-price="12500">ü•ò Thieboudienne - 12 500 XOF</option>
                            <option value="Yassa Poulet" data-price="11000">üçó Yassa Poulet - 11 000 XOF</option>
                            <option value="Maf√© d'agneau" data-price="12000">ü•© Maf√© d'agneau - 12 000 XOF</option>
                            <option value="Poulet DG" data-price="13800">üçõ Poulet DG - 13 800 XOF</option>
                            <option value="Pastels" data-price="8000">ü•ü Pastels - 8 000 XOF</option>
                            <option value="Filet de Capitaine" data-price="14500">üêü Filet de Capitaine - 14 500 XOF</option>
                            <option value="Jus de bissap" data-price="3500">üßÉ Jus de bissap - 3 500 XOF</option>
                            <option value="Jus de gingembre" data-price="3500">üßÉ Jus de gingembre - 3 500 XOF</option>
                            <option value="Jus de bouye" data-price="4000">üßÉ Jus de bouye - 4 000 XOF</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <input type="number" class="form-control item-qty" value="1" min="1">
                    </div>
                    <div class="col-md-2">
                        <span class="item-price-display">12 500</span> XOF
                    </div>
                    <div class="col-md-1">
                        <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                            <i class="fas fa-trash" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('orderTotal').textContent = '0';
            new bootstrap.Modal(document.getElementById('orderModal')).show();
        }

        function addOrderItem() {
            const container = document.getElementById('orderItems');
            const newItem = document.createElement('div');
            newItem.className = 'row mb-2 order-item';
            newItem.innerHTML = `
                <div class="col-md-6">
                    <select class="form-control item-select">
                        <option value="">S√©lectionner un article</option>
                        <option value="Thieboudienne" data-price="12500">ü•ò Thieboudienne - 12 500 XOF</option>
                        <option value="Yassa Poulet" data-price="11000">üçó Yassa Poulet - 11 000 XOF</option>
                        <option value="Maf√© d'agneau" data-price="12000">ü•© Maf√© d'agneau - 12 000 XOF</option>
                        <option value="Poulet DG" data-price="13800">üçõ Poulet DG - 13 800 XOF</option>
                        <option value="Pastels" data-price="8000">ü•ü Pastels - 8 000 XOF</option>
                        <option value="Filet de Capitaine" data-price="14500">üêü Filet de Capitaine - 14 500 XOF</option>
                        <option value="Jus de bissap" data-price="3500">üßÉ Jus de bissap - 3 500 XOF</option>
                        <option value="Jus de gingembre" data-price="3500">üßÉ Jus de gingembre - 3 500 XOF</option>
                        <option value="Jus de bouye" data-price="4000">üßÉ Jus de bouye - 4 000 XOF</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <input type="number" class="form-control item-qty" value="1" min="1">
                </div>
                <div class="col-md-2">
                    <span class="item-price-display">12 500</span> XOF
                </div>
                <div class="col-md-1">
                    <button type="button" class="btn btn-danger btn-sm remove-item" onclick="removeOrderItem(this)" aria-label="Supprimer l'article">
                        <i class="fas fa-trash" aria-hidden="true"></i>
                    </button>
                </div>
            `;
            container.appendChild(newItem);
        }

        function removeOrderItem(btn) {
            const container = document.getElementById('orderItems');
            if (container.children.length > 1) {
                btn.closest('.order-item').remove();
                calculateOrderTotal();
            } else {
                showNotification('Vous devez garder au moins un article', 'warning');
            }
        }

        function calculateOrderTotal() {
            let total = 0;
            document.querySelectorAll('.order-item').forEach(item => {
                const select = item.querySelector('.item-select');
                const qty = item.querySelector('.item-qty').value;
                const selectedOption = select.options[select.selectedIndex];
                if (selectedOption && selectedOption.dataset.price) {
                    const price = parseInt(selectedOption.dataset.price);
                    const itemTotal = price * qty;
                    total += itemTotal;
                    item.querySelector('.item-price-display').textContent = itemTotal.toLocaleString();
                }
            });
            document.getElementById('orderTotal').textContent = total.toLocaleString();
        }

        function submitOrder() {
            const items = [];
            let total = 0;
            document.querySelectorAll('.order-item').forEach(item => {
                const select = item.querySelector('.item-select');
                const qty = parseInt(item.querySelector('.item-qty').value);
                const selectedOption = select.options[select.selectedIndex];
                if (selectedOption && selectedOption.value) {
                    const price = parseInt(selectedOption.dataset.price);
                    items.push({
                        name: selectedOption.value,
                        qty: qty,
                        price: price
                    });
                    total += price * qty;
                }
            });

            if (items.length === 0) {
                showNotification('Ajoutez au moins un article', 'error');
                return;
            }

            const now = new Date();
            const timeStr = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            const dateStr = now.toISOString().split('T')[0];

            const orderData = {
                id: `R${String(appData.restaurantOrders.length + 1).padStart(3, '0')}`,
                table: document.getElementById('tableNumber').value,
                guest: document.getElementById('orderGuestName').value || 'Client',
                items: items,
                total: total,
                status: 'pending',
                roomCharge: document.getElementById('chargeToRoom').checked,
                roomNumber: document.getElementById('chargeToRoom').checked ? document.getElementById('chargeRoomSelect').value : null,
                roomId: null,
                time: timeStr,
                date: dateStr
            };

            appData.restaurantOrders.push(orderData);

            bootstrap.Modal.getInstance(document.getElementById('orderModal')).hide();
            showNotification('Commande enregistr√©e avec succ√®s', 'success');
            loadModule('orders');
            updateBadges();
        }

        function markOrderReady(orderId) {
            const order = appData.restaurantOrders.find(o => o.id === orderId);
            if (order) {
                order.status = order.status === 'pending' ? 'preparing' : 'paid';
                showNotification(`Commande ${orderId} marqu√©e comme ${order.status === 'paid' ? 'pay√©e' : 'en pr√©paration'}`, 'success');
                loadModule('orders');
                updateBadges();
            }
        }

        function viewOrder(orderId) {
            showNotification(`Affichage des d√©tails de la commande ${orderId}`, 'info');
        }

        function deleteOrder(orderId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette commande ?')) {
                const index = appData.restaurantOrders.findIndex(o => o.id === orderId);
                if (index !== -1) {
                    appData.restaurantOrders.splice(index, 1);
                    showNotification('Commande supprim√©e', 'success');
                    loadModule('orders');
                    updateBadges();
                }
            }
        }

        // Chambres
        function openRoomModal() {
            document.getElementById('roomForm').reset();
            new bootstrap.Modal(document.getElementById('roomModal')).show();
        }

        function submitRoom() {
            const roomData = {
                number: parseInt(document.getElementById('roomNumber').value),
                type: document.getElementById('roomType').value,
                price: parseInt(document.getElementById('roomPrice').value),
                status: document.getElementById('roomStatus').value
            };

            appData.rooms.push(roomData);
            bootstrap.Modal.getInstance(document.getElementById('roomModal')).hide();
            showNotification('Chambre ajout√©e avec succ√®s', 'success');
            loadModule('rooms');
        }

        function viewRoom(roomNumber) {
            showNotification(`Affichage des d√©tails de la chambre ${roomNumber}`, 'info');
        }

        function editRoom(roomNumber) {
            showNotification(`Modification de la chambre ${roomNumber}`, 'info');
        }

        function deleteRoom(roomNumber) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette chambre ?')) {
                const index = appData.rooms.findIndex(r => r.number === roomNumber);
                if (index !== -1) {
                    appData.rooms.splice(index, 1);
                    showNotification('Chambre supprim√©e', 'success');
                    loadModule('rooms');
                }
            }
        }

        // Clients
        function openGuestModal() {
            document.getElementById('guestForm').reset();
            new bootstrap.Modal(document.getElementById('guestModal')).show();
        }

        function submitGuest() {
            const guestData = {
                id: `G${String(appData.guests.length + 1).padStart(3, '0')}`,
                name: document.getElementById('newGuestName').value,
                email: document.getElementById('newGuestEmail').value,
                phone: document.getElementById('newGuestPhone').value,
                stays: 0,
                preferences: document.getElementById('newGuestPreferences').value,
                totalSpent: 0,
                lastStay: new Date().toISOString().split('T')[0]
            };

            appData.guests.push(guestData);
            bootstrap.Modal.getInstance(document.getElementById('guestModal')).hide();
            showNotification('Client ajout√© avec succ√®s', 'success');
            loadModule('guests');
        }

        function viewGuest(guestId) {
            showNotification(`Affichage des d√©tails du client ${guestId}`, 'info');
        }

        function editGuest(guestId) {
            showNotification(`Modification du client ${guestId}`, 'info');
        }

        function generateGuestInvoice(guestId) {
            showNotification(`G√©n√©ration d'une facture pour le client ${guestId}`, 'info');
        }

        // Stocks
        function openStockModal() {
            document.getElementById('stockForm').reset();
            new bootstrap.Modal(document.getElementById('stockModal')).show();
        }

        function submitStock() {
            const stockData = {
                id: `S${String(appData.stock.length + 1).padStart(3, '0')}`,
                name: document.getElementById('stockName').value,
                category: document.getElementById('stockCategory').value,
                quantity: parseFloat(document.getElementById('stockQuantity').value),
                unit: document.getElementById('stockUnit').value,
                threshold: parseFloat(document.getElementById('stockThreshold').value),
                expiry: document.getElementById('stockExpiry').value || null,
                supplier: document.getElementById('stockSupplier').value,
                price: parseFloat(document.getElementById('stockPrice').value)
            };

            appData.stock.push(stockData);
            bootstrap.Modal.getInstance(document.getElementById('stockModal')).hide();
            showNotification('Article ajout√© au stock', 'success');
            loadModule('stock');
        }

        function editStock(stockId) {
            showNotification(`Modification de l'article ${stockId}`, 'info');
        }

        function orderStock(stockId) {
            showNotification(`Commande pass√©e pour l'article ${stockId}`, 'success');
        }

        function deleteStock(stockId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet article ?')) {
                const index = appData.stock.findIndex(s => s.id === stockId);
                if (index !== -1) {
                    appData.stock.splice(index, 1);
                    showNotification('Article supprim√©', 'success');
                    loadModule('stock');
                }
            }
        }

        // Personnel
        function openEmployeeModal() {
            document.getElementById('employeeForm').reset();
            new bootstrap.Modal(document.getElementById('employeeModal')).show();
        }

        function submitEmployee() {
            const employeeData = {
                id: `E${String(appData.employees.length + 1).padStart(3, '0')}`,
                name: document.getElementById('employeeName').value,
                role: document.getElementById('employeeRole').value,
                department: document.getElementById('employeeDepartment').value,
                phone: document.getElementById('employeePhone').value,
                email: document.getElementById('employeeEmail').value,
                schedule: document.getElementById('employeeSchedule').value
            };

            appData.employees.push(employeeData);
            bootstrap.Modal.getInstance(document.getElementById('employeeModal')).hide();
            showNotification('Employ√© ajout√© avec succ√®s', 'success');
            loadModule('staff');
        }

        function viewEmployee(employeeId) {
            showNotification(`Affichage des d√©tails de l'employ√© ${employeeId}`, 'info');
        }

        function editEmployee(employeeId) {
            showNotification(`Modification de l'employ√© ${employeeId}`, 'info');
        }

        function deleteEmployee(employeeId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet employ√© ?')) {
                const index = appData.employees.findIndex(e => e.id === employeeId);
                if (index !== -1) {
                    appData.employees.splice(index, 1);
                    showNotification('Employ√© supprim√©', 'success');
                    loadModule('staff');
                }
            }
        }

        // D√©penses
        function openExpenseModal() {
            document.getElementById('expenseForm').reset();
            document.getElementById('expenseDate').value = new Date().toISOString().split('T')[0];
            new bootstrap.Modal(document.getElementById('expenseModal')).show();
        }

        function submitExpense() {
            const expenseData = {
                id: `EX${String(appData.expenses.length + 1).padStart(3, '0')}`,
                date: document.getElementById('expenseDate').value,
                category: document.getElementById('expenseCategory').value,
                amount: parseFloat(document.getElementById('expenseAmount').value),
                description: document.getElementById('expenseDescription').value,
                dueDate: document.getElementById('expenseDueDate').value,
                paid: document.getElementById('expensePaid').checked
            };

            appData.expenses.push(expenseData);
            bootstrap.Modal.getInstance(document.getElementById('expenseModal')).hide();
            showNotification('D√©pense enregistr√©e', 'success');
            loadModule('expenses');
        }

        function editExpense(expenseId) {
            showNotification(`Modification de la d√©pense ${expenseId}`, 'info');
        }

        function markExpensePaid(expenseId) {
            const expense = appData.expenses.find(e => e.id === expenseId);
            if (expense) {
                expense.paid = true;
                showNotification('D√©pense marqu√©e comme pay√©e', 'success');
                loadModule('expenses');
            }
        }

        function deleteExpense(expenseId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette d√©pense ?')) {
                const index = appData.expenses.findIndex(e => e.id === expenseId);
                if (index !== -1) {
                    appData.expenses.splice(index, 1);
                    showNotification('D√©pense supprim√©e', 'success');
                    loadModule('expenses');
                }
            }
        }

        // Factures
        function showInvoice(bookingId) {
            const booking = appData.bookings.find(b => b.id === bookingId);
            if (!booking) return;

            currentInvoice = {
                ...booking,
                number: `INV-${booking.id}`,
                date: new Date().toISOString().split('T')[0]
            };

            const invoiceHtml = `
                <div class="invoice-preview">
                    <div class="invoice-header">
                        <div>
                            <img src="images/logo1.png" alt="Lawmar" class="invoice-logo" onerror="this.src='https://via.placeholder.com/120x120/0d6efd/ffffff?text=LAW'">
                        </div>
                        <div class="invoice-title">FACTURE</div>
                        <div>
                            <h2><i class="fas fa-hotel me-2" style="color: var(--primary);"></i>Lawmar PMS</h2>
                            <p><i class="fas fa-map-marker-alt me-2"></i>Les R√©sidences du Lawmar<br><i class="fas fa-map-pin me-2"></i>Gandiol, S√©n√©gal<br><i class="fas fa-phone me-2"></i>T√©l: +221 33 123 45 67</p>
                        </div>
                    </div>

                    <div class="invoice-details">
                        <div class="row">
                            <div class="col-6">
                                <h4><i class="fas fa-user me-2"></i>Factur√© √†:</h4>
                                <p>
                                    <strong>${booking.guest}</strong><br>
                                    <i class="fas fa-envelope me-1"></i>${booking.email}<br>
                                    <i class="fas fa-phone me-1"></i>${booking.phone}
                                </p>
                            </div>
                            <div class="col-6 text-end">
                                <p>
                                    <strong><i class="fas fa-hashtag me-1"></i>N¬∞ Facture:</strong> INV-${booking.id}<br>
                                    <strong><i class="fas fa-calendar me-1"></i>Date:</strong> ${new Date().toLocaleDateString('fr-FR')}<br>
                                    <strong><i class="fas fa-calendar-times me-1"></i>√âch√©ance:</strong> ${new Date(new Date().setDate(new Date().getDate() + 15)).toLocaleDateString('fr-FR')}
                                </p>
                            </div>
                        </div>
                    </div>

                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-description me-2"></i>Description</th>
                                <th><i class="fas fa-hashtag me-2"></i>Quantit√©</th>
                                <th><i class="fas fa-coins me-2"></i>Prix unitaire</th>
                                <th><i class="fas fa-coins me-2"></i>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><i class="fas fa-hotel me-2"></i>S√©jour du ${formatDate(booking.checkin)} au ${formatDate(booking.checkout)}</td>
                                <td>${Math.ceil((new Date(booking.checkout) - new Date(booking.checkin)) / (1000*60*60*24))} nuits</td>
                                <td>${(booking.total / Math.ceil((new Date(booking.checkout) - new Date(booking.checkin)) / (1000*60*60*24))).toLocaleString()} XOF</td>
                                <td>${booking.total.toLocaleString()} XOF</td>
                            </tr>
                            ${booking.specialRequests ? `
                                <tr>
                                    <td colspan="4" class="text-muted"><i class="fas fa-comment me-2"></i>Note: ${booking.specialRequests}</td>
                                </tr>
                            ` : ''}
                        </tbody>
                    </table>

                    <div class="row">
                        <div class="col-6">
                            <p><strong><i class="fas fa-credit-card me-2"></i>Mode de paiement:</strong> Virement bancaire / Esp√®ces</p>
                            <p><strong><i class="fas fa-university me-2"></i>IBAN:</strong> SN123 4567 8901 2345 6789 0123</p>
                        </div>
                        <div class="col-6">
                            <div class="invoice-total">
                                <p>Sous-total: ${booking.total.toLocaleString()} XOF<br>
                                TVA (18%): ${(booking.total * 0.18).toLocaleString()} XOF<br>
                                <strong>Total TTC: ${(booking.total * 1.18).toLocaleString()} XOF</strong></p>
                                <p>Acompte vers√©: ${booking.prepaid.toLocaleString()} XOF<br>
                                <strong>Reste √† payer: ${(booking.total * 1.18 - booking.prepaid).toLocaleString()} XOF</strong></p>
                            </div>
                        </div>
                    </div>

                    <p class="text-muted mt-4"><i><i class="fas fa-heart me-2" style="color: #dc3545;"></i>Merci de votre confiance et √† bient√¥t aux R√©sidences du Lawmar!</i></p>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceHtml;
            new bootstrap.Modal(document.getElementById('invoiceModal')).show();
        }

        function showOrderInvoice(orderId) {
            const order = appData.restaurantOrders.find(o => o.id === orderId);
            if (!order) return;

            currentInvoice = {
                ...order,
                number: `INV-${order.id}`,
                date: new Date().toISOString().split('T')[0]
            };

            const invoiceHtml = `
                <div class="invoice-preview">
                    <div class="invoice-header">
                        <div>
                            <img src="images/logo1.png" alt="Lawmar" class="invoice-logo" onerror="this.src='https://via.placeholder.com/120x120/0d6efd/ffffff?text=LAW'">
                        </div>
                        <div class="invoice-title">FACTURE RESTAURANT</div>
                        <div>
                            <h2><i class="fas fa-utensils me-2" style="color: #ffc107;"></i>Lawmar Restaurant</h2>
                            <p><i class="fas fa-map-marker-alt me-2"></i>Les R√©sidences du Lawmar<br><i class="fas fa-map-pin me-2"></i>Gandiol, S√©n√©gal<br><i class="fas fa-phone me-2"></i>T√©l: +221 33 123 45 67</p>
                        </div>
                    </div>

                    <div class="invoice-details">
                        <div class="row">
                            <div class="col-6">
                                <h4><i class="fas fa-user me-2"></i>Factur√© √†:</h4>
                                <p>
                                    <strong>${order.guest}</strong><br>
                                    <i class="fas fa-chair me-1"></i>Table ${order.table}<br>
                                    ${order.roomCharge ? `<i class="fas fa-hotel me-1"></i>Chambre ${order.roomNumber}` : '<i class="fas fa-user me-1"></i>Client ext√©rieur'}
                                </p>
                            </div>
                            <div class="col-6 text-end">
                                <p>
                                    <strong><i class="fas fa-hashtag me-1"></i>N¬∞ Facture:</strong> INV-${order.id}<br>
                                    <strong><i class="fas fa-calendar me-1"></i>Date:</strong> ${formatDate(order.date)} √† ${order.time}
                                </p>
                            </div>
                        </div>
                    </div>

                    <table class="invoice-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-utensils me-2"></i>Description</th>
                                <th><i class="fas fa-hashtag me-2"></i>Quantit√©</th>
                                <th><i class="fas fa-coins me-2"></i>Prix unitaire</th>
                                <th><i class="fas fa-coins me-2"></i>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${order.items.map(item => `
                                <tr>
                                    <td><i class="fas fa-utensil-spoon me-2"></i>${item.name}</td>
                                    <td>${item.qty}</td>
                                    <td>${item.price.toLocaleString()} XOF</td>
                                    <td>${(item.price * item.qty).toLocaleString()} XOF</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div class="row">
                        <div class="col-6">
                            <p><strong><i class="fas fa-credit-card me-2"></i>Mode de paiement:</strong> ${order.roomCharge ? 'Imput√© √† la chambre' : 'Paiement direct'}</p>
                        </div>
                        <div class="col-6">
                            <div class="invoice-total">
                                <p>Sous-total: ${order.total.toLocaleString()} XOF<br>
                                TVA (18%): ${(order.total * 0.18).toLocaleString()} XOF<br>
                                <strong>Total TTC: ${(order.total * 1.18).toLocaleString()} XOF</strong></p>
                            </div>
                        </div>
                    </div>

                    <p class="text-muted mt-4"><i><i class="fas fa-utensils me-2" style="color: #ffc107;"></i>Bon app√©tit et merci de votre visite!</i></p>
                </div>
            `;

            document.getElementById('invoiceContent').innerHTML = invoiceHtml;
            new bootstrap.Modal(document.getElementById('invoiceModal')).show();
        }

        function downloadInvoicePDF() {
            if (!currentInvoice) return;

            const element = document.querySelector('.invoice-preview');
            html2canvas(element, {
                scale: 2,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save(`facture-${currentInvoice.number}.pdf`);

                showNotification('PDF g√©n√©r√© avec succ√®s', 'success');
            });
        }

        function generateNewInvoice() {
            showNotification('Cr√©ation d\'une nouvelle facture', 'info');
        }

        function viewInvoice(invoiceId) {
            if (invoiceId.startsWith('BK')) {
                showInvoice(invoiceId);
            } else {
                showOrderInvoice(invoiceId);
            }
        }

        function downloadInvoice(invoiceId) {
            if (invoiceId.startsWith('BK')) {
                showInvoice(invoiceId);
            } else {
                showOrderInvoice(invoiceId);
            }
            setTimeout(() => downloadInvoicePDF(), 500);
        }

        function markAsPaid(invoiceId) {
            if (invoiceId.startsWith('BK')) {
                const booking = appData.bookings.find(b => b.id === invoiceId);
                if (booking) booking.status = 'checked-out';
            } else {
                const order = appData.restaurantOrders.find(o => o.id === invoiceId);
                if (order) order.status = 'paid';
            }
            showNotification(`Facture ${invoiceId} marqu√©e comme pay√©e`, 'success');
            loadModule('invoices');
        }

        // Rapports
        function initReportsCharts() {
            if (document.getElementById('monthly-revenue-chart')) {
                new Chart(document.getElementById('monthly-revenue-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Ao√ª', 'Sep', 'Oct', 'Nov', 'D√©c'],
                        datasets: [
                            {
                                label: 'H√¥tel',
                                data: [12, 15, 18, 22, 25, 28, 30, 32, 28, 24, 20, 18],
                                backgroundColor: '#0d6efd',
                                borderRadius: 8,
                                barPercentage: 0.6
                            },
                            {
                                label: 'Restaurant',
                                data: [8, 10, 12, 15, 18, 20, 22, 24, 20, 18, 15, 12],
                                backgroundColor: '#ffc107',
                                borderRadius: 8,
                                barPercentage: 0.6
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.raw + 'M XOF';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + 'M';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            if (document.getElementById('expenses-chart')) {
                const categories = {};
                appData.expenses.forEach(e => {
                    categories[e.category] = (categories[e.category] || 0) + e.amount;
                });

                new Chart(document.getElementById('expenses-chart'), {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(categories).map(cat => {
                            const icons = {
                                '√©lectricit√©': '‚ö°',
                                'eau': 'üíß',
                                'achats': 'üõí',
                                'salaire': 'üí∞',
                                'maintenance': 'üîß'
                            };
                            return icons[cat] + ' ' + cat;
                        }),
                        datasets: [{
                            data: Object.values(categories),
                            backgroundColor: ['#dc3545', '#fd7e14', '#20c997', '#6f42c1', '#0dcaf0'],
                            borderWidth: 0,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '65%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const value = context.raw;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return context.label + ': ' + (value / 1000).toFixed(0) + 'k XOF (' + percentage + '%)';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateMonthlyChart(year) {
            showNotification(`Mise √† jour des donn√©es pour ${year}`, 'info');
        }

        function exportReport(type) {
            const reportNames = {
                daily: 'journalier',
                weekly: 'hebdomadaire',
                monthly: 'mensuel',
                yearly: 'annuel'
            };
            showNotification(`Export du rapport ${reportNames[type]} en cours...`, 'info');
        }

        // Export de donn√©es
        function exportData(type) {
            let data, filename;

            switch(type) {
                case 'bookings':
                    data = appData.bookings;
                    filename = 'reservations.json';
                    break;
                case 'orders':
                    data = appData.restaurantOrders;
                    filename = 'commandes.json';
                    break;
                case 'stock':
                    data = appData.stock;
                    filename = 'stock.json';
                    break;
                case 'invoices':
                    data = [...appData.bookings, ...appData.restaurantOrders];
                    filename = 'factures.json';
                    break;
                default:
                    return;
            }

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);

            showNotification(`Export de ${filename} r√©ussi`, 'success');
        }

        // ============================================
        // FONCTIONS UTILITAIRES
        // ============================================

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const d = new Date(dateStr);
            return d.toLocaleDateString('fr-FR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }

        function getStatusLabel(status) {
            const labels = {
                'confirmed': 'Confirm√©e',
                'checked-in': 'En cours',
                'checked-out': 'Termin√©e',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function getStatusIcon(status) {
            const icons = {
                'confirmed': 'fa-check-circle',
                'checked-in': 'fa-bed',
                'checked-out': 'fa-check-double',
                'pending': 'fa-hourglass-half'
            };
            return icons[status] || 'fa-info-circle';
        }

        function getStatusClass(status) {
            const classes = {
                'confirmed': 'badge-success',
                'checked-in': 'badge-primary',
                'checked-out': 'badge-secondary',
                'pending': 'badge-warning'
            };
            return classes[status] || 'badge-info';
        }

        function getOrderStatusLabel(status) {
            const labels = {
                'paid': 'Pay√©e',
                'preparing': 'En pr√©paration',
                'pending': 'En attente'
            };
            return labels[status] || status;
        }

        function showNotification(message, type = 'success') {
            const container = document.getElementById('notification-center');
            const notification = document.createElement('div');
            notification.className = `notification`;
            notification.style.borderLeftColor = type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107';
            notification.setAttribute('role', 'alert');
            notification.setAttribute('aria-live', 'assertive');

            const icon = type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : type === 'info' ? 'fa-info-circle' : 'fa-exclamation-triangle';
            const iconColor = type === 'success' ? '#198754' : type === 'error' ? '#dc3545' : type === 'info' ? '#0dcaf0' : '#ffc107';

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas ${icon}" style="color: ${iconColor}; font-size: 1.3rem;" aria-hidden="true"></i>
                    <span style="font-weight: 600;">${message}</span>
                </div>
            `;

            container.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // ============================================
        // FONCTIONS MOBILE
        // ============================================

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('menuToggle');
            
            sidebar.classList.toggle('show');
            
            if (sidebar.classList.contains('show')) {
                toggleBtn.innerHTML = '<i class="fas fa-times" aria-hidden="true"></i>';
                toggleBtn.setAttribute('aria-label', 'Fermer le menu');
            } else {
                toggleBtn.innerHTML = '<i class="fas fa-bars" aria-hidden="true"></i>';
                toggleBtn.setAttribute('aria-label', 'Ouvrir le menu');
            }
        }

        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('menuToggle');
            
            if (window.innerWidth <= 768 && 
                sidebar.classList.contains('show') && 
                !sidebar.contains(e.target) && 
                !toggleBtn.contains(e.target)) {
                toggleSidebar();
            }
        });

        // ============================================
        // INITIALISATION DES GRAPHIQUES
        // ============================================

        function initCharts() {
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            charts = {};

            if (document.getElementById('occupancy-chart')) {
                charts.occupancy = new Chart(document.getElementById('occupancy-chart'), {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
                        datasets: [{
                            label: 'Taux d\'occupation %',
                            data: [65, 70, 75, 80, 85, 90, 78],
                            borderColor: '#0d6efd',
                            backgroundColor: 'rgba(13, 110, 253, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#0d6efd',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        return context.raw + '%';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            if (document.getElementById('revenue-chart')) {
                charts.revenue = new Chart(document.getElementById('revenue-chart'), {
                    type: 'doughnut',
                    data: {
                        labels: ['üè® H√¥tel', 'üçΩÔ∏è Restaurant'],
                        datasets: [{
                            data: [appData.stats.hotelRevenue, appData.stats.restaurantRevenue],
                            backgroundColor: ['#0d6efd', '#ffc107'],
                            borderWidth: 0,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '65%',
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const value = context.raw;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return context.label + ': ' + (value / 1000).toFixed(0) + 'k XOF (' + percentage + '%)';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (calendarEl) {
                const calendar = new FullCalendar.Calendar(calendarEl, {
                    initialView: window.innerWidth <= 768 ? 'timeGridDay' : 'dayGridMonth',
                    locale: 'fr',
                    headerToolbar: {
                        left: 'prev,next today',
                        center: 'title',
                        right: window.innerWidth <= 768 ? 'dayGridMonth,timeGridDay' : 'dayGridMonth,timeGridWeek,timeGridDay'
                    },
                    buttonText: {
                        today: 'Aujourd\'hui',
                        month: 'Mois',
                        week: 'Semaine',
                        day: 'Jour'
                    },
                    events: appData.bookings.map(b => ({
                        title: `üè® ${b.guest} - ${b.room}`,
                        start: b.checkin,
                        end: b.checkout,
                        color: '#0d6efd',
                        textColor: '#fff',
                        description: `üìû ${b.phone}, üë• ${b.adults} adultes, ${b.children} enfants`
                    })),
                    eventClick: function(info) {
                        showNotification(info.event.title + ' - ' + info.event.extendedProps.description, 'info');
                    }
                });
                calendar.render();
            }
        }

        function initDataTable(tableId) {
            if ($(tableId).length && $.fn.DataTable) {
                if ($(tableId).hasClass('dataTable')) {
                    $(tableId).DataTable().destroy();
                }

                $(tableId).DataTable({
                    language: {
                        url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json'
                    },
                    pageLength: window.innerWidth <= 768 ? 5 : 10,
                    responsive: true,
                    order: [[0, 'desc']]
                });
            }
        }

        function loadDashboard() {
            loadModule('dashboard');
        }

        // ============================================
        // EXPOSITION DES FONCTIONS GLOBALES
        // ============================================

        window.logout = logout;
        window.loadModule = loadModule;
        window.toggleSidebar = toggleSidebar;
        window.openReservationModal = openReservationModal;
        window.openOrderModal = openOrderModal;
        window.openRoomModal = openRoomModal;
        window.openGuestModal = openGuestModal;
        window.openStockModal = openStockModal;
        window.openEmployeeModal = openEmployeeModal;
        window.openExpenseModal = openExpenseModal;
        window.quickReserve = quickReserve;
        window.checkIn = checkIn;
        window.checkOut = checkOut;
        window.showInvoice = showInvoice;
        window.showOrderInvoice = showOrderInvoice;
        window.downloadInvoicePDF = downloadInvoicePDF;
        window.deleteBooking = deleteBooking;
        window.deleteOrder = deleteOrder;
        window.markOrderReady = markOrderReady;
        window.addOrderItem = addOrderItem;
        window.removeOrderItem = removeOrderItem;
        window.viewBooking = viewBooking;
        window.viewOrder = viewOrder;
        window.viewRoom = viewRoom;
        window.viewGuest = viewGuest;
        window.editStock = editStock;
        window.editEmployee = editEmployee;
        window.editExpense = editExpense;
        window.orderStock = orderStock;
        window.markAsPaid = markAsPaid;
        window.generateNewInvoice = generateNewInvoice;
        window.exportData = exportData;
        window.generateGuestInvoice = generateGuestInvoice;
        window.confirmBooking = confirmBooking;
        window.editBooking = editBooking;
        window.editRoom = editRoom;
        window.deleteRoom = deleteRoom;
        window.editGuest = editGuest;
        window.deleteStock = deleteStock;
        window.viewEmployee = viewEmployee;
        window.deleteEmployee = deleteEmployee;
        window.markExpensePaid = markExpensePaid;
        window.deleteExpense = deleteExpense;
        window.viewInvoice = viewInvoice;
        window.downloadInvoice = downloadInvoice;
        window.exportReport = exportReport;
        window.updateMonthlyChart = updateMonthlyChart;
    </script>
</body>
</html>